----------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\jamel\Dropbox\Latex\PROJECTS\22-11-cur-persistence\data\seasonal_adjustm
> ent\comparison\ms-ar-july-2023.log
  log type:  text
 opened on:  28 Jul 2023, 09:02:03

. 
. cls

. clear

. 
. global Docs = "C:\Users\jamel\Dropbox\Latex\"

. global Proj = "PROJECTS\22-11-cur-persistence\"

. global Data = "data\seasonal_adjustment\comparison"

. global Fig = "Figures\"

.  
. cd "${Docs}"
C:\Users\jamel\Dropbox\Latex

. cd "${Proj}"
C:\Users\jamel\Dropbox\Latex\PROJECTS\22-11-cur-persistence

. cd "${Data}"
C:\Users\jamel\Dropbox\Latex\PROJECTS\22-11-cur-persistence\data\seasonal_adjustment\compariso
> n

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. xtset cn_2 date3

Panel variable: cn_2 (strongly balanced)
 Time variable: date3, 1955q1 to 2022q3
         Delta: 1 quarter

. xtdescribe

    cn_2:  1, 2, ..., 70                                     n =         70
   date3:  1955q1, 1955q2, ..., 2022q3                       T =        271
           Delta(date3) = 1 quarter
           Span(date3)  = 271 periods
           (cn_2*date3 uniquely identifies each observation)

Distribution of T_i:   min      5%     25%       50%       75%     95%     max
                       271     271     271       271       271     271     271

     Freq.  Percent    Cum. |  Pattern*
 ---------------------------+-----------------------------------------------------------------
> -------------------------------------------------------------------------
       70    100.00  100.00 |  222222222222222222222222222222222222222222222222222222222222222
> 2222222222222222222222222222222222222222222222222222222222222222222222221
 ---------------------------+-----------------------------------------------------------------
> -------------------------------------------------------------------------
       70    100.00         |  XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
> XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
 ---------------------------------------------------------------------------------------------
> -------------------------------------------------------------------------
 *Each column represents 2 periods.


. 
. by cn_2: sum cab

----------------------------------------------------------------------------------------------
-> cn_2 = Argentina

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        150   -.6078205    3.878614  -13.38655   13.85122

----------------------------------------------------------------------------------------------
-> cn_2 = Armenia

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        107   -11.02849    9.249777  -52.75925   .9400901

----------------------------------------------------------------------------------------------
-> cn_2 = Australia

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        252   -2.983295    2.241218   -7.26835   3.705593

----------------------------------------------------------------------------------------------
-> cn_2 = Austria

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        210    .0660981    2.341376  -6.288283   6.402232

----------------------------------------------------------------------------------------------
-> cn_2 = Belarus

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |         97   -4.901785    4.807597  -17.76861   9.210577

----------------------------------------------------------------------------------------------
-> cn_2 = Belgium

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        110    1.951606    2.995754  -7.088193   7.502803

----------------------------------------------------------------------------------------------
-> cn_2 = Bolivia

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        140   -2.064846    6.853589  -17.94041   14.12889

----------------------------------------------------------------------------------------------
-> cn_2 = Brazil

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        178    -1.95753    2.094717      -6.24   2.001944

----------------------------------------------------------------------------------------------
-> cn_2 = Bulgaria

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        105   -3.880078    7.980825  -32.39564    10.7096

----------------------------------------------------------------------------------------------
-> cn_2 = Cambodia

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        112   -8.147835    8.525422  -58.27456   5.417135

----------------------------------------------------------------------------------------------
-> cn_2 = Canada

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        246   -1.754121     1.95477  -5.195778   3.715028

----------------------------------------------------------------------------------------------
-> cn_2 = Chile

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        127   -2.143469    3.464862  -11.19444   7.422786

----------------------------------------------------------------------------------------------
-> cn_2 = China

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        126    2.839954    2.731499  -2.372153    11.2019

----------------------------------------------------------------------------------------------
-> cn_2 = Colombia

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        106   -3.062838     2.05715  -6.940429   1.225659

----------------------------------------------------------------------------------------------
-> cn_2 = Costa Rica

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |         94   -3.985442    1.953668  -12.27956   .4081037

----------------------------------------------------------------------------------------------
-> cn_2 = Croatia

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        102   -3.631801    4.534263  -14.15987   5.279214

----------------------------------------------------------------------------------------------
-> cn_2 = Czech Republic

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        118    -2.02416    2.844142     -7.993    7.40625

----------------------------------------------------------------------------------------------
-> cn_2 = Denmark

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        182    2.190407    4.400263  -6.154988   12.50385

----------------------------------------------------------------------------------------------
-> cn_2 = El Salvador

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |         85   -3.951619     2.61082  -10.04252   1.284742

----------------------------------------------------------------------------------------------
-> cn_2 = Estonia

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        118   -4.236461    6.212399  -17.81588   6.571407

----------------------------------------------------------------------------------------------
-> cn_2 = Finland

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        190    .5270883    3.615715  -7.258003   9.136583

----------------------------------------------------------------------------------------------
-> cn_2 = France

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        190    .0794602    1.202926  -3.404226   4.552705

----------------------------------------------------------------------------------------------
-> cn_2 = Georgia

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |         93   -10.08831    4.661387   -28.0946   -3.76288

----------------------------------------------------------------------------------------------
-> cn_2 = Germany

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        206    2.814292    3.396065  -2.785133   9.211325

----------------------------------------------------------------------------------------------
-> cn_2 = Greece

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        186   -4.881866    3.895302   -16.8124   2.645845

----------------------------------------------------------------------------------------------
-> cn_2 = Guatemala

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        173    -3.54826    2.943483  -13.07206   5.747397

----------------------------------------------------------------------------------------------
-> cn_2 = Hong Kong

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |         85    6.904084    4.723173  -1.649624   19.85701

----------------------------------------------------------------------------------------------
-> cn_2 = Hungary

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        131   -3.295594    4.901771  -17.73606   5.338348

----------------------------------------------------------------------------------------------
-> cn_2 = Iceland

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        186    -3.24825    7.222097  -33.13135   10.70536

----------------------------------------------------------------------------------------------
-> cn_2 = India

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        250     -1.3005    1.625867  -6.188247   9.091169

----------------------------------------------------------------------------------------------
-> cn_2 = Indonesia

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        167   -.8322572    3.180296  -13.37924   8.162918

----------------------------------------------------------------------------------------------
-> cn_2 = Ireland

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        130   -.4951115    10.05889  -56.27405   20.50381

----------------------------------------------------------------------------------------------
-> cn_2 = Israel

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        202   -1.394773    5.638851  -16.82679   16.25676

----------------------------------------------------------------------------------------------
-> cn_2 = Italy

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        210    .0516365    2.064856  -5.166698   5.039061

----------------------------------------------------------------------------------------------
-> cn_2 = Japan

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        183    2.446899    1.334135  -1.827029   4.755695

----------------------------------------------------------------------------------------------
-> cn_2 = Kazakhstan

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        101   -1.653429     5.11587    -12.418    11.8581

----------------------------------------------------------------------------------------------
-> cn_2 = Kyrgyz Republic

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        116   -9.063511    9.795974  -34.82779     16.061

----------------------------------------------------------------------------------------------
-> cn_2 = Latvia

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        117   -3.706694    8.137109  -25.02648   24.63643

----------------------------------------------------------------------------------------------
-> cn_2 = Lithuania

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        118   -4.129931    5.855308  -18.69465    10.3122

----------------------------------------------------------------------------------------------
-> cn_2 = Luxembourg

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        110    6.603996    9.024192  -27.20301    45.0281

----------------------------------------------------------------------------------------------
-> cn_2 = Malaysia

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |         85     8.55026    4.918217   1.652997   17.98938

----------------------------------------------------------------------------------------------
-> cn_2 = Mauritius

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |         81   -4.454104    4.918062  -16.17501   6.930718

----------------------------------------------------------------------------------------------
-> cn_2 = Mexico

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        174   -1.618256    2.262654  -8.640676   5.966011

----------------------------------------------------------------------------------------------
-> cn_2 = Moldova

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        101   -8.563665    5.881909  -23.11097   9.945051

----------------------------------------------------------------------------------------------
-> cn_2 = Netherlands

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        182    4.816302    3.243078   -8.06867   14.41207

----------------------------------------------------------------------------------------------
-> cn_2 = New Zealand

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        170   -4.357337    3.005031  -16.02223   .7023869

----------------------------------------------------------------------------------------------
-> cn_2 = Norway

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        190    5.261065    7.752018  -16.70594   22.07531

----------------------------------------------------------------------------------------------
-> cn_2 = Paraguay

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |         84    .9375261    3.500282  -5.603785   12.43375

----------------------------------------------------------------------------------------------
-> cn_2 = Peru

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        165    -3.45944     3.41849  -11.37961   6.348907

----------------------------------------------------------------------------------------------
-> cn_2 = Philippines

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        165   -.8408482    3.884993  -11.83403   9.148789

----------------------------------------------------------------------------------------------
-> cn_2 = Poland

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        150   -2.788492    3.330353  -8.719572   17.70736

----------------------------------------------------------------------------------------------
-> cn_2 = Portugal

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        182   -4.327326     5.27964  -21.40975   4.681777

----------------------------------------------------------------------------------------------
-> cn_2 = Romania

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        117   -5.551053     3.85978  -21.53296   2.620551

----------------------------------------------------------------------------------------------
-> cn_2 = Russia

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        111    5.647507    4.450402  -2.448698    19.5391

----------------------------------------------------------------------------------------------
-> cn_2 = Slovak Republic

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        118   -3.905134    4.338388   -12.9266   11.87387

----------------------------------------------------------------------------------------------
-> cn_2 = Slovenia

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        110    .7498264    3.837869   -11.3602   10.66322

----------------------------------------------------------------------------------------------
-> cn_2 = South Africa

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        250   -1.018106    3.289988  -10.52473   11.31886

----------------------------------------------------------------------------------------------
-> cn_2 = South Korea

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        186    .9590566    4.479944  -13.01703   15.64192

----------------------------------------------------------------------------------------------
-> cn_2 = Spain

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        190   -1.849746    3.121163  -10.10367   3.639705

----------------------------------------------------------------------------------------------
-> cn_2 = Sri Lanka

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        177   -4.438782     4.13442  -17.26997   4.739591

----------------------------------------------------------------------------------------------
-> cn_2 = Sweden

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        190    2.267924    3.476043  -5.505932   9.482767

----------------------------------------------------------------------------------------------
-> cn_2 = Switzerland

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        202    5.739325    3.716584  -6.306072   14.87489

----------------------------------------------------------------------------------------------
-> cn_2 = Taiwan

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        156    7.706419    4.840854  -5.187582   22.56203

----------------------------------------------------------------------------------------------
-> cn_2 = Thailand

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        176   -.3246909    6.241798   -12.5609   13.43172

----------------------------------------------------------------------------------------------
-> cn_2 = Turkey

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        142    -2.51952    2.936618  -9.431008   6.447635

----------------------------------------------------------------------------------------------
-> cn_2 = United Kingdom

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        270   -1.411854    2.001637  -7.182861   3.805609

----------------------------------------------------------------------------------------------
-> cn_2 = United States

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        250   -1.659639    1.844588  -6.299612   1.214152

----------------------------------------------------------------------------------------------
-> cn_2 = Uruguay

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |         85   -1.308577     2.00974  -7.570538   3.543638

----------------------------------------------------------------------------------------------
-> cn_2 = Venezuela

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |         84    6.033795    6.938226  -7.250016    20.1815

----------------------------------------------------------------------------------------------
-> cn_2 = Vietnam

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         cab |        104   -.9855274    5.719719  -29.62582   8.759515


. 
. // MS AR for the current account (ARG)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==1
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -292.95217  (not concave)
Iteration 1:  Log pseudolikelihood = -290.97484  (not concave)
Iteration 2:  Log pseudolikelihood = -290.94365  (not concave)
Iteration 3:  Log pseudolikelihood =  -289.5303  (not concave)
Iteration 4:  Log pseudolikelihood = -289.36055  (not concave)
Iteration 5:  Log pseudolikelihood =  -289.0924  (not concave)
Iteration 6:  Log pseudolikelihood = -288.76216  (not concave)
Iteration 7:  Log pseudolikelihood = -288.46487  (not concave)
Iteration 8:  Log pseudolikelihood = -288.06637  (not concave)
Iteration 9:  Log pseudolikelihood =  -287.3641  (not concave)
Iteration 10: Log pseudolikelihood = -286.43793  
Iteration 11: Log pseudolikelihood = -284.83051  
Iteration 12: Log pseudolikelihood =   -283.495  
Iteration 13: Log pseudolikelihood = -282.97459  
Iteration 14: Log pseudolikelihood = -282.95946  
Iteration 15: Log pseudolikelihood = -282.95944  

Markov-switching autoregression

Sample: 1985q2 thru 2022q2                              Number of obs =    149
Number of states = 2                                    AIC           = 3.9055
Unconditional probabilities: transition                 HQIC          = 3.9710
                                                        SBIC          = 4.0668
Log likelihood = -282.95944

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8424693   .0514778    16.37   0.000     .7415747    .9433639
             |
       _cons |  -1.821947   .9612607    -1.90   0.058    -3.705984    .0620891
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .7107637   .2543793     2.79   0.005     .2121894    1.209338
             |
       _cons |  -5.723784   1.130932    -5.06   0.000    -7.940369   -3.507198
-------------+----------------------------------------------------------------
      sigma1 |   1.086793   .2219251                      .7283328    1.621675
-------------+----------------------------------------------------------------
      sigma2 |   7.862853   3.505377                      3.281722    18.83903
-------------+----------------------------------------------------------------
         p11 |   .9487641    .040133                      .7859321    .9894065
-------------+----------------------------------------------------------------
         p21 |    .459192    .200805                      .1482447    .8055333
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) varswitch constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -293.62328  (not concave)
Iteration 1:  Log pseudolikelihood = -291.53302  
Iteration 2:  Log pseudolikelihood =  -290.1591  
Iteration 3:  Log pseudolikelihood = -289.88601  
Iteration 4:  Log pseudolikelihood = -289.88441  
Iteration 5:  Log pseudolikelihood = -289.88441  

Markov-switching autoregression

Sample: 1985q2 thru 2022q2                              Number of obs =    149
Number of states = 2                                    AIC           = 3.9850
Unconditional probabilities: transition                 HQIC          = 4.0424
                                                        SBIC          = 4.1262
Log likelihood = -289.88441

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   1.186313   1.544867     0.77   0.443    -1.841571    4.214197
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .3931469   .4022148     0.98   0.328    -.3951797    1.181473
             |
       _cons |   1.558354    1.33236     1.17   0.242    -1.053024    4.169732
-------------+----------------------------------------------------------------
      sigma1 |   .8889908   .2479805                       .514586    1.535807
-------------+----------------------------------------------------------------
      sigma2 |   4.855819   1.902182                      2.253301    10.46419
-------------+----------------------------------------------------------------
         p11 |   .8805909   .0532215                      .7322386    .9521233
-------------+----------------------------------------------------------------
         p21 |   .3783932   .3200998                      .0405552    .8976096
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  7
                  e(N) =  149
             e(N_gaps) =  0
                 e(ll) =  -289.8844087252339
                  e(k) =  7
             e(states) =  2
               e(k_eq) =  6
              e(k_aux) =  4
                e(aic) =  3.985025620472939
               e(sbic) =  4.126150614711987
               e(hqic) =  4.042362372637268
               e(tmin) =  101
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) varswitch constraint.."
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1985q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(varswitch) : "varswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 8
                  e(V) :  8 x 8
                e(Cns) :  1 x 9
           e(initvals) :  1 x 8
            e(uncprob) :  1 x 2
       e(V_modelbased) :  8 x 8

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    2.28
         Prob > chi2 =    0.1314

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .0656777

. 
. ereturn list

scalars:
               e(rank) =  7
                  e(N) =  149
             e(N_gaps) =  0
                 e(ll) =  -289.8844087252339
                  e(k) =  7
             e(states) =  2
               e(k_eq) =  6
              e(k_aux) =  4
                e(aic) =  3.985025620472939
               e(sbic) =  4.126150614711987
               e(hqic) =  4.042362372637268
               e(tmin) =  101
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) varswitch constraint.."
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1985q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(varswitch) : "varswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 8
                  e(V) :  8 x 8
                e(Cns) :  1 x 9
           e(initvals) :  1 x 8
            e(uncprob) :  1 x 2
       e(V_modelbased) :  8 x 8

functions:
             e(sample)   

. 
. estat transition

Number of obs = 149         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .8805909   .0532215      .7322386    .9521233
-----------------------------+------------------------------------------------
                         p12 |   .1194091   .0532215      .0478767    .2677614
-----------------------------+------------------------------------------------
                         p21 |   .3783932   .3200998      .0405552    .8976096
-----------------------------+------------------------------------------------
                         p22 |   .6216068   .3200998      .1023904    .9594448
------------------------------------------------------------------------------

. estat duration

Number of obs = 149         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |    8.37457   3.732607      3.734668    20.88697
-----------------------------+------------------------------------------------
                      State2 |   2.642754   2.235624       1.11407    24.65773
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_1.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_ARG.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (ARM)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==2
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -331.28325  (not concave)
Iteration 1:  Log pseudolikelihood = -312.34425  (not concave)
Iteration 2:  Log pseudolikelihood =  -305.9794  
Iteration 3:  Log pseudolikelihood = -305.22247  
Iteration 4:  Log pseudolikelihood = -305.04101  
Iteration 5:  Log pseudolikelihood = -305.02638  
Iteration 6:  Log pseudolikelihood = -305.02634  
Iteration 7:  Log pseudolikelihood = -305.02634  

Markov-switching autoregression

Sample: 1994q2 thru 2020q3                              Number of obs =    106
Number of states = 2                                    AIC           = 5.8873
Unconditional probabilities: transition                 HQIC          = 5.9586
                                                        SBIC          = 6.0632
Log likelihood = -305.02634

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   1.000991   .0069745   143.52   0.000     .9873212    1.014661
             |
       _cons |  -47.46918   8.584507    -5.53   0.000     -64.2945   -30.64386
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |  -.1531328   1.020846    -0.15   0.881    -2.153954    1.847688
             |
       _cons |  -17.56828   2.292742    -7.66   0.000    -22.06197   -13.07459
-------------+----------------------------------------------------------------
       sigma |   3.747079   .3903606                      3.055041    4.595881
-------------+----------------------------------------------------------------
         p11 |   .9801858   .0185714                      .8836218    .9969069
-------------+----------------------------------------------------------------
         p21 |   .2290435   .2641168                      .0155923    .8478483
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -331.29924  (not concave)
Iteration 1:  Log pseudolikelihood = -312.30304  (not concave)
Iteration 2:  Log pseudolikelihood = -305.98365  
Iteration 3:  Log pseudolikelihood = -305.22493  
Iteration 4:  Log pseudolikelihood = -305.04464  
Iteration 5:  Log pseudolikelihood =  -305.0313  
Iteration 6:  Log pseudolikelihood = -305.03126  
Iteration 7:  Log pseudolikelihood = -305.03126  

Markov-switching autoregression

Sample: 1994q2 thru 2020q3                              Number of obs =    106
Number of states = 2                                    AIC           = 5.8685
Unconditional probabilities: transition                 HQIC          = 5.9296
                                                        SBIC          = 6.0193
Log likelihood = -305.03126

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   -47.4523   8.559082    -5.54   0.000    -64.22779   -30.67681
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   -.153444   1.022288    -0.15   0.881    -2.157092    1.850204
             |
       _cons |   -17.5667   2.294693    -7.66   0.000    -22.06421   -13.06918
-------------+----------------------------------------------------------------
       sigma |   3.747253   .3900059                      3.055778    4.595198
-------------+----------------------------------------------------------------
         p11 |   .9801858    .018574                      .8835949    .9969078
-------------+----------------------------------------------------------------
         p21 |   .2290435   .2643473                      .0155531     .848178
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  106
             e(N_gaps) =  0
                 e(ll) =  -305.0312574105494
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  5.868514290765083
               e(sbic) =  6.019274994205389
               e(hqic) =  5.929618424234016
               e(tmin) =  137
               e(tmax) =  242
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2020q3"
              e(tmins) : "1994q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    1.27
         Prob > chi2 =    0.2592

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .12959746

. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  106
             e(N_gaps) =  0
                 e(ll) =  -305.0312574105494
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  5.868514290765083
               e(sbic) =  6.019274994205389
               e(hqic) =  5.929618424234016
               e(tmin) =  137
               e(tmax) =  242
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2020q3"
              e(tmins) : "1994q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 106         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9801858    .018574      .8835949    .9969078
-----------------------------+------------------------------------------------
                         p12 |   .0198142    .018574      .0030922    .1164051
-----------------------------+------------------------------------------------
                         p21 |   .2290435   .2643473      .0155531     .848178
-----------------------------+------------------------------------------------
                         p22 |   .7709565   .2643473       .151822    .9844469
------------------------------------------------------------------------------

. estat duration

Number of obs = 106         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   50.46875   47.30961      8.590691    323.3892
-----------------------------+------------------------------------------------
                      State2 |   4.365983   5.038938      1.178998    64.29599
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_2.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_ARM.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (AUS)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==3
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -344.69809  (not concave)
Iteration 1:  Log pseudolikelihood = -344.33099  (not concave)
Iteration 2:  Log pseudolikelihood = -343.24256  (not concave)
Iteration 3:  Log pseudolikelihood = -342.48894  (not concave)
Iteration 4:  Log pseudolikelihood =  -342.1091  
Iteration 5:  Log pseudolikelihood = -341.76895  
Iteration 6:  Log pseudolikelihood = -341.55608  
Iteration 7:  Log pseudolikelihood = -341.37846  
Iteration 8:  Log pseudolikelihood = -341.36677  
Iteration 9:  Log pseudolikelihood = -341.36528  
Iteration 10: Log pseudolikelihood = -341.36527  

Markov-switching autoregression

Sample: 1959q4 thru 2022q2                              Number of obs =    251
Number of states = 2                                    AIC           = 2.7758
Unconditional probabilities: transition                 HQIC          = 2.8154
                                                        SBIC          = 2.8741
Log likelihood = -341.36527

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   1.039721   .2775046     3.75   0.000     .4958218     1.58362
             |
       _cons |  -5.706384   1.956991    -2.92   0.004    -9.542015   -1.870753
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |    .931909   .0468754    19.88   0.000     .8400349    1.023783
             |
       _cons |   -3.12863   1.488319    -2.10   0.036    -6.045681   -.2115787
-------------+----------------------------------------------------------------
       sigma |   .8238243   .0441801                      .7416283    .9151303
-------------+----------------------------------------------------------------
         p11 |   .6933995   .0785475                      .5229635    .8234942
-------------+----------------------------------------------------------------
         p21 |    .027401   .0122556                      .0113096    .0648844
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) varswitch constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -345.29585  (not concave)
Iteration 1:  Log pseudolikelihood = -341.71761  
Iteration 2:  Log pseudolikelihood = -339.72905  
Iteration 3:  Log pseudolikelihood = -339.17001  
Iteration 4:  Log pseudolikelihood = -339.15001  
Iteration 5:  Log pseudolikelihood = -339.08915  
Iteration 6:  Log pseudolikelihood = -339.08833  
Iteration 7:  Log pseudolikelihood = -339.08833  

Markov-switching autoregression

Sample: 1959q4 thru 2022q2                              Number of obs =    251
Number of states = 2                                    AIC           = 2.7577
Unconditional probabilities: transition                 HQIC          = 2.7972
                                                        SBIC          = 2.8560
Log likelihood = -339.08833

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -1.752777   1.267511    -1.38   0.167    -4.237052    .7314985
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .8149439   .1119986     7.28   0.000     .5954307    1.034457
             |
       _cons |  -1.703548   1.384715    -1.23   0.219    -4.417539    1.010443
-------------+----------------------------------------------------------------
      sigma1 |   .7358558   .0764368                      .6003084    .9020092
-------------+----------------------------------------------------------------
      sigma2 |   1.301449   .2409107                      .9054439    1.870651
-------------+----------------------------------------------------------------
         p11 |   .9645308   .0198854                      .8969454    .9883671
-------------+----------------------------------------------------------------
         p21 |   .0595471   .0692685                      .0055749    .4169531
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  7
                  e(N) =  251
             e(N_gaps) =  0
                 e(ll) =  -339.0883345510838
                  e(k) =  7
             e(states) =  2
               e(k_eq) =  6
              e(k_aux) =  4
                e(aic) =  2.757675972518596
               e(sbic) =  2.855995377195578
               e(hqic) =  2.797242160310141
               e(tmin) =  -1
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) varswitch constraint.."
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1959q4"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(varswitch) : "varswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 8
                  e(V) :  8 x 8
                e(Cns) :  1 x 9
           e(initvals) :  1 x 8
            e(uncprob) :  1 x 2
       e(V_modelbased) :  8 x 8

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    2.73
         Prob > chi2 =    0.0985

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .04923596

. 
. ereturn list

scalars:
               e(rank) =  7
                  e(N) =  251
             e(N_gaps) =  0
                 e(ll) =  -339.0883345510838
                  e(k) =  7
             e(states) =  2
               e(k_eq) =  6
              e(k_aux) =  4
                e(aic) =  2.757675972518596
               e(sbic) =  2.855995377195578
               e(hqic) =  2.797242160310141
               e(tmin) =  -1
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) varswitch constraint.."
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1959q4"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(varswitch) : "varswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 8
                  e(V) :  8 x 8
                e(Cns) :  1 x 9
           e(initvals) :  1 x 8
            e(uncprob) :  1 x 2
       e(V_modelbased) :  8 x 8

functions:
             e(sample)   

. 
. estat transition

Number of obs = 251         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9645308   .0198854      .8969454    .9883671
-----------------------------+------------------------------------------------
                         p12 |   .0354692   .0198854      .0116329    .1030546
-----------------------------+------------------------------------------------
                         p21 |   .0595471   .0692685      .0055749    .4169531
-----------------------------+------------------------------------------------
                         p22 |   .9404529   .0692685      .5830469    .9944251
------------------------------------------------------------------------------

. estat duration

Number of obs = 251         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   28.19348   15.80639       9.70359    85.96328
-----------------------------+------------------------------------------------
                      State2 |   16.79344   19.53507      2.398352    179.3762
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_3.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_AUS.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (AUT)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==4
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State2]L1.ar=1 

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -324.95262  (not concave)
Iteration 1:  Log pseudolikelihood = -321.94761  (not concave)
Iteration 2:  Log pseudolikelihood = -319.68864  (not concave)
Iteration 3:  Log pseudolikelihood = -318.57787  (not concave)
Iteration 4:  Log pseudolikelihood =  -318.2418  
Iteration 5:  Log pseudolikelihood = -318.10707  
Iteration 6:  Log pseudolikelihood = -318.02824  
Iteration 7:  Log pseudolikelihood = -318.02778  
Iteration 8:  Log pseudolikelihood = -318.02778  

Markov-switching autoregression

Sample: 1970q2 thru 2022q2                              Number of obs =    209
Number of states = 2                                    AIC           = 3.1103
Unconditional probabilities: transition                 HQIC          = 3.1556
                                                        SBIC          = 3.2223
Log likelihood = -318.02778

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3616053   .1227479     2.95   0.003     .1210238    .6021867
             |
       _cons |   1.981546   .3519028     5.63   0.000     1.291829    2.671263
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9809972   .0426826    22.98   0.000     .8973408    1.064654
             |
       _cons |   .9855648   .9006038     1.09   0.274    -.7795863    2.750716
-------------+----------------------------------------------------------------
       sigma |   .9908028   .0755632                      .8532389    1.150546
-------------+----------------------------------------------------------------
         p11 |   .9213968   .0651604                      .6677667    .9855834
-------------+----------------------------------------------------------------
         p21 |   .0368912   .0249481                      .0095804     .131704
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -325.37548  (not concave)
Iteration 1:  Log pseudolikelihood = -322.32074  (not concave)
Iteration 2:  Log pseudolikelihood = -319.53668  
Iteration 3:  Log pseudolikelihood = -319.22694  
Iteration 4:  Log pseudolikelihood =  -318.6316  
Iteration 5:  Log pseudolikelihood = -318.17988  
Iteration 6:  Log pseudolikelihood = -318.17065  
Iteration 7:  Log pseudolikelihood = -318.17065  

Markov-switching autoregression

Sample: 1970q2 thru 2022q2                              Number of obs =    209
Number of states = 2                                    AIC           = 3.1021
Unconditional probabilities: transition                 HQIC          = 3.1409
                                                        SBIC          = 3.1981
Log likelihood = -318.17065

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3616956   .1020064     3.55   0.000     .1617667    .5616246
             |
       _cons |   1.983448   .3136513     6.32   0.000     1.368703    2.598193
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   1.140048   .7507623     1.52   0.129     -.331419    2.611515
-------------+----------------------------------------------------------------
       sigma |   .9905172   .0734713                      .8564942    1.145512
-------------+----------------------------------------------------------------
         p11 |   .9233622   .0641365                      .6709626    .9861472
-------------+----------------------------------------------------------------
         p21 |   .0374379   .0254588                      .0096454    .1344412
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  209
             e(N_gaps) =  0
                 e(ll) =  -318.1706495798816
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  3.102111479233317
               e(sbic) =  3.198063658715561
               e(hqic) =  3.140905508896277
               e(tmin) =  41
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1970q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   39.16
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 1.956e-10

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  209
             e(N_gaps) =  0
                 e(ll) =  -318.1706495798816
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  3.102111479233317
               e(sbic) =  3.198063658715561
               e(hqic) =  3.140905508896277
               e(tmin) =  41
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1970q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 209         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9233622   .0641365      .6709626    .9861472
-----------------------------+------------------------------------------------
                         p12 |   .0766378   .0641365      .0138528    .3290374
-----------------------------+------------------------------------------------
                         p21 |   .0374379   .0254588      .0096454    .1344412
-----------------------------+------------------------------------------------
                         p22 |   .9625621   .0254588      .8655588    .9903546
------------------------------------------------------------------------------

. estat duration

Number of obs = 209         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   13.04839    10.9199      3.039168    72.18765
-----------------------------+------------------------------------------------
                      State2 |    26.7109   18.16412      7.438197    103.6763
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_4.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_AUT.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (BLR)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==5
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -260.22118  
Iteration 1:  Log pseudolikelihood =  -259.5871  
Iteration 2:  Log pseudolikelihood = -259.53139  
Iteration 3:  Log pseudolikelihood = -259.53123  
Iteration 4:  Log pseudolikelihood = -259.53123  

Markov-switching autoregression

Sample: 1996q2 thru 2020q1                              Number of obs =     96
Number of states = 2                                    AIC           = 5.5527
Unconditional probabilities: transition                 HQIC          = 5.6283
                                                        SBIC          = 5.7397
Log likelihood = -259.53123

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8208855   .1177533     6.97   0.000     .5900932    1.051678
             |
       _cons |  -8.971078   1.829586    -4.90   0.000      -12.557   -5.385155
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |    .249694   .1910248     1.31   0.191    -.1247077    .6240957
             |
       _cons |  -2.115862   .6532305    -3.24   0.001    -3.396171   -.8355541
-------------+----------------------------------------------------------------
       sigma |   2.868613   .4311338                      2.136692    3.851253
-------------+----------------------------------------------------------------
         p11 |   .8664725   .0752768                      .6444903    .9587247
-------------+----------------------------------------------------------------
         p21 |   .0996798   .0453498                      .0394979    .2296362
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -260.97813  
Iteration 1:  Log pseudolikelihood = -260.67406  
Iteration 2:  Log pseudolikelihood = -260.59838  
Iteration 3:  Log pseudolikelihood = -260.59805  
Iteration 4:  Log pseudolikelihood = -260.59805  

Markov-switching autoregression

Sample: 1996q2 thru 2020q1                              Number of obs =     96
Number of states = 2                                    AIC           = 5.5541
Unconditional probabilities: transition                 HQIC          = 5.6189
                                                        SBIC          = 5.7144
Log likelihood = -260.59805

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -8.348185   2.238792    -3.73   0.000    -12.73614   -3.960233
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .2402328   .1824586     1.32   0.188    -.1173795    .5978451
             |
       _cons |  -2.139956   .6690953    -3.20   0.001    -3.451359   -.8285535
-------------+----------------------------------------------------------------
       sigma |   2.897512   .4123131                        2.1923    3.829573
-------------+----------------------------------------------------------------
         p11 |   .8613056   .0819338                      .6181918    .9597079
-------------+----------------------------------------------------------------
         p21 |   .1182996   .0540855                      .0463119     .270453
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  96
             e(N_gaps) =  0
                 e(ll) =  -260.5980450487519
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  5.554125938515664
               e(sbic) =  5.714397700482404
               e(hqic) =  5.618910403508921
               e(tmin) =  145
               e(tmax) =  240
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2020q1"
              e(tmins) : "1996q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   17.34
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .00001563

. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  96
             e(N_gaps) =  0
                 e(ll) =  -260.5980450487519
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  5.554125938515664
               e(sbic) =  5.714397700482404
               e(hqic) =  5.618910403508921
               e(tmin) =  145
               e(tmax) =  240
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2020q1"
              e(tmins) : "1996q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 96          
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .8613056   .0819338      .6181918    .9597079
-----------------------------+------------------------------------------------
                         p12 |   .1386944   .0819338      .0402921    .3818082
-----------------------------+------------------------------------------------
                         p21 |   .1182996   .0540855      .0463119     .270453
-----------------------------+------------------------------------------------
                         p22 |   .8817004   .0540855       .729547    .9536881
------------------------------------------------------------------------------

. estat duration

Number of obs = 96          
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   7.210098   4.259371      2.619116    24.81875
-----------------------------+------------------------------------------------
                      State2 |   8.453116   3.864688      3.697501    21.59274
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_5.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_BLR.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (BEL)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==6
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -230.24552  
Iteration 1:  Log pseudolikelihood = -229.69566  
Iteration 2:  Log pseudolikelihood = -229.64461  
Iteration 3:  Log pseudolikelihood = -229.64436  
Iteration 4:  Log pseudolikelihood = -229.64436  

Markov-switching autoregression

Sample: 1995q2 thru 2022q2                              Number of obs =    109
Number of states = 2                                    AIC           = 4.3421
Unconditional probabilities: transition                 HQIC          = 4.4122
                                                        SBIC          = 4.5149
Log likelihood = -229.64436

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9068476   .0432433    20.97   0.000     .8220923    .9916028
             |
       _cons |  -.4400244   .4834851    -0.91   0.363    -1.387638    .5075891
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   -.875229   .1472151    -5.95   0.000    -1.163765   -.5866928
             |
       _cons |   2.138553   .5123828     4.17   0.000     1.134302    3.142805
-------------+----------------------------------------------------------------
       sigma |   1.579044   .1757123                      1.269622    1.963875
-------------+----------------------------------------------------------------
         p11 |   .9203857    .032752                      .8280055     .965231
-------------+----------------------------------------------------------------
         p21 |   .5231143   .2269946                      .1556584     .867144
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -232.11652  
Iteration 1:  Log pseudolikelihood = -231.90213  
Iteration 2:  Log pseudolikelihood = -231.84531  
Iteration 3:  Log pseudolikelihood =  -231.8446  
Iteration 4:  Log pseudolikelihood =  -231.8446  

Markov-switching autoregression

Sample: 1995q2 thru 2022q2                              Number of obs =    109
Number of states = 2                                    AIC           = 4.3641
Unconditional probabilities: transition                 HQIC          = 4.4242
                                                        SBIC          = 4.5123
Log likelihood = -231.8446

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -.5318638    .503335    -1.06   0.291    -1.518382    .4546546
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |  -.8236033   .2285426    -3.60   0.000    -1.271539   -.3756681
             |
       _cons |   2.138436   .5206295     4.11   0.000     1.118021    3.158851
-------------+----------------------------------------------------------------
       sigma |   1.603487   .1728046                      1.298175    1.980605
-------------+----------------------------------------------------------------
         p11 |   .9165993   .0325779                      .8266048    .9620309
-------------+----------------------------------------------------------------
         p21 |   .5078552   .2121121                      .1635681    .8448494
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  109
             e(N_gaps) =  0
                 e(ll) =  -231.8445978526422
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  4.364121061516371
               e(sbic) =  4.512268651363847
               e(hqic) =  4.424200320536528
               e(tmin) =  141
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1995q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   63.67
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = 7.360e-16

. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  109
             e(N_gaps) =  0
                 e(ll) =  -231.8445978526422
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  4.364121061516371
               e(sbic) =  4.512268651363847
               e(hqic) =  4.424200320536528
               e(tmin) =  141
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1995q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 109         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9165993   .0325779      .8266048    .9620309
-----------------------------+------------------------------------------------
                         p12 |   .0834007   .0325779      .0379691    .1733952
-----------------------------+------------------------------------------------
                         p21 |   .5078552   .2121121      .1635681    .8448494
-----------------------------+------------------------------------------------
                         p22 |   .4921448   .2121121      .1551506    .8364319
------------------------------------------------------------------------------

. estat duration

Number of obs = 109         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   11.99031   4.683638      5.767174     26.3372
-----------------------------+------------------------------------------------
                      State2 |   1.969065   .8224048      1.183643     6.11366
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_6.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_BEL.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (BOL)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==7
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -328.57346  (not concave)
Iteration 1:  Log pseudolikelihood = -326.57672  
Iteration 2:  Log pseudolikelihood = -325.84607  
Iteration 3:  Log pseudolikelihood = -325.26123  
Iteration 4:  Log pseudolikelihood = -324.74373  
Iteration 5:  Log pseudolikelihood = -324.73534  
Iteration 6:  Log pseudolikelihood = -324.73533  

Markov-switching autoregression

Sample: 1985q2 thru 2019q4                              Number of obs =    139
Number of states = 2                                    AIC           = 4.7732
Unconditional probabilities: transition                 HQIC          = 4.8332
                                                        SBIC          = 4.9209
Log likelihood = -324.73533

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8849478   .1845762     4.79   0.000     .5231852     1.24671
             |
       _cons |  -2.451137   10.58704    -0.23   0.817    -23.20135    18.29908
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9873248   .0538207    18.34   0.000     .8818382    1.092811
             |
       _cons |  -8.780443   14.47114    -0.61   0.544    -37.14335    19.58246
-------------+----------------------------------------------------------------
       sigma |   1.977127   .3611701                      1.382108     2.82831
-------------+----------------------------------------------------------------
         p11 |   .8172663   .4441492                      .0129826    .9993429
-------------+----------------------------------------------------------------
         p21 |   .0671597   .0510735                      .0143581    .2624367
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -329.61654  (not concave)
Iteration 1:  Log pseudolikelihood = -327.93292  (not concave)
Iteration 2:  Log pseudolikelihood = -325.64972  (not concave)
Iteration 3:  Log pseudolikelihood =  -325.4837  (not concave)
Iteration 4:  Log pseudolikelihood = -325.45049  (not concave)
Iteration 5:  Log pseudolikelihood = -325.42529  (not concave)
Iteration 6:  Log pseudolikelihood = -325.39978  (not concave)
Iteration 7:  Log pseudolikelihood = -325.21227  
Iteration 8:  Log pseudolikelihood =  -325.0396  
Iteration 9:  Log pseudolikelihood = -324.89595  
Iteration 10: Log pseudolikelihood = -324.70888  
Iteration 11: Log pseudolikelihood = -324.70201  
Iteration 12: Log pseudolikelihood =   -324.702  

Markov-switching autoregression

Sample: 1985q2 thru 2019q4                              Number of obs =    139
Number of states = 2                                    AIC           = 4.7583
Unconditional probabilities: transition                 HQIC          = 4.8098
                                                        SBIC          = 4.8850
Log likelihood = -324.702

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8329092    .133968     6.22   0.000     .5703367    1.095482
             |
       _cons |  -3.964512   2.199822    -1.80   0.072    -8.276084    .3470609
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -11.85503   6.241107    -1.90   0.057    -24.08737    .3773186
-------------+----------------------------------------------------------------
       sigma |   2.073651   .3642011                      1.469728    2.925733
-------------+----------------------------------------------------------------
         p11 |   .9078475   .1132455                      .4096432    .9929012
-------------+----------------------------------------------------------------
         p21 |   .0442534   .0679695                      .0019808    .5192818
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  139
             e(N_gaps) =  0
                 e(ll) =  -324.7020033648304
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  4.758302206688207
               e(sbic) =  4.884970146247805
               e(hqic) =  4.809776687382339
               e(tmin) =  101
               e(tmax) =  239
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2019q4"
              e(tmins) : "1985q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    1.56
         Prob > chi2 =    0.2123

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .106154

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  139
             e(N_gaps) =  0
                 e(ll) =  -324.7020033648304
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  4.758302206688207
               e(sbic) =  4.884970146247805
               e(hqic) =  4.809776687382339
               e(tmin) =  101
               e(tmax) =  239
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2019q4"
              e(tmins) : "1985q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 139         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9078475   .1132455      .4096432    .9929012
-----------------------------+------------------------------------------------
                         p12 |   .0921525   .1132455      .0070988    .5903568
-----------------------------+------------------------------------------------
                         p21 |   .0442534   .0679695      .0019808    .5192818
-----------------------------+------------------------------------------------
                         p22 |   .9557466   .0679695      .4807182    .9980192
------------------------------------------------------------------------------

. estat duration

Number of obs = 139         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   10.85158   13.33542      1.693891    140.8686
-----------------------------+------------------------------------------------
                      State2 |   22.59712   34.70728      1.925737    504.8536
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_7.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_BOL.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (BRA)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==8
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -198.1448  (not concave)
Iteration 1:  Log pseudolikelihood = -197.68886  
Iteration 2:  Log pseudolikelihood = -197.30291  
Iteration 3:  Log pseudolikelihood = -197.03575  
Iteration 4:  Log pseudolikelihood = -197.03384  
Iteration 5:  Log pseudolikelihood = -197.03384  

Markov-switching autoregression

Sample: 1978q2 thru 2022q2                              Number of obs =    177
Number of states = 2                                    AIC           = 2.3055
Unconditional probabilities: transition                 HQIC          = 2.3564
                                                        SBIC          = 2.4311
Log likelihood = -197.03384

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .5589306    .138755     4.03   0.000     .2869759    .8308854
             |
       _cons |  -3.451506   .1927188   -17.91   0.000    -3.829228   -3.073784
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9631897   .0255623    37.68   0.000     .9130886    1.013291
             |
       _cons |  -1.224797   .4226518    -2.90   0.004    -2.053179   -.3964147
-------------+----------------------------------------------------------------
       sigma |   .6019869   .0350583                      .5370504     .674775
-------------+----------------------------------------------------------------
         p11 |   .8989048   .0401538                      .7890301    .9548317
-------------+----------------------------------------------------------------
         p21 |   .0442907   .0240478                      .0149915     .123663
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -198.43329  (not concave)
Iteration 1:  Log pseudolikelihood = -198.35649  
Iteration 2:  Log pseudolikelihood = -197.80687  
Iteration 3:  Log pseudolikelihood = -197.79697  
Iteration 4:  Log pseudolikelihood = -197.79694  
Iteration 5:  Log pseudolikelihood = -197.79694  

Markov-switching autoregression

Sample: 1978q2 thru 2022q2                              Number of obs =    177
Number of states = 2                                    AIC           = 2.3028
Unconditional probabilities: transition                 HQIC          = 2.3465
                                                        SBIC          = 2.4105
Log likelihood = -197.79694

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |    .551005   .1412405     3.90   0.000     .2741788    .8278312
             |
       _cons |  -3.437851   .2017429   -17.04   0.000     -3.83326   -3.042442
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -1.316235   .5202708    -2.53   0.011    -2.335947   -.2965228
-------------+----------------------------------------------------------------
       sigma |   .5961839   .0438196                      .5161985     .688563
-------------+----------------------------------------------------------------
         p11 |   .8892517   .0545146                      .7307038    .9596139
-------------+----------------------------------------------------------------
         p21 |   .0516073   .0356362                      .0128922    .1848162
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  177
             e(N_gaps) =  0
                 e(ll) =  -197.7969419486982
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  2.302790304505064
               e(sbic) =  2.410456397134686
               e(hqic) =  2.346455489930209
               e(tmin) =  73
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1978q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   10.11
         Prob > chi2 =    0.0015

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .00073907

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  177
             e(N_gaps) =  0
                 e(ll) =  -197.7969419486982
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  2.302790304505064
               e(sbic) =  2.410456397134686
               e(hqic) =  2.346455489930209
               e(tmin) =  73
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1978q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 177         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .8892517   .0545146      .7307038    .9596139
-----------------------------+------------------------------------------------
                         p12 |   .1107483   .0545146      .0403861    .2692962
-----------------------------+------------------------------------------------
                         p21 |   .0516073   .0356362      .0128922    .1848162
-----------------------------+------------------------------------------------
                         p22 |   .9483927   .0356362      .8151838    .9871078
------------------------------------------------------------------------------

. estat duration

Number of obs = 177         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   9.029484   4.444664      3.713383    24.76098
-----------------------------+------------------------------------------------
                      State2 |   19.37709   13.38039      5.410783    77.56635
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_8.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_BRA.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (BLG)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==9
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State1]L1.ar=1 // State 1 Non-stationary

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -268.8007  
Iteration 1:  Log pseudolikelihood = -267.97752  
Iteration 2:  Log pseudolikelihood = -267.68388  
Iteration 3:  Log pseudolikelihood = -267.61295  
Iteration 4:  Log pseudolikelihood =  -267.5946  
Iteration 5:  Log pseudolikelihood = -267.58955  
Iteration 6:  Log pseudolikelihood = -267.58826  
Iteration 7:  Log pseudolikelihood = -267.58798  
Iteration 8:  Log pseudolikelihood = -267.58792  
Iteration 9:  Log pseudolikelihood = -267.58791  
Iteration 10: Log pseudolikelihood = -267.58791  
Iteration 11: Log pseudolikelihood = -267.58791  
Iteration 12: Log pseudolikelihood = -267.58791  (backed up)

Markov-switching autoregression

Sample: 1994q2 thru 2020q1                              Number of obs =    104
Number of states = 2                                    AIC           = 5.2805
Unconditional probabilities: transition                 HQIC          = 5.3526
                                                        SBIC          = 5.4585
Log likelihood = -267.58791

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   1.072163   .0495842    21.62   0.000     .9749796    1.169346
             |
       _cons |  -1.008835   1.294196    -0.78   0.436    -3.545412    1.527742
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |     .40062    .156635     2.56   0.011     .0936209    .7076191
             |
       _cons |    -.43364   .9366306    -0.46   0.643    -2.269402    1.402122
-------------+----------------------------------------------------------------
       sigma |   2.793112    .342411                      2.196537    3.551716
-------------+----------------------------------------------------------------
         p11 |   .7200564   .1105259                      .4675636    .8828201
-------------+----------------------------------------------------------------
         p21 |          1   3.94e-07                       .385431           1
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -270.81508  
Iteration 1:  Log pseudolikelihood =  -270.1458  
Iteration 2:  Log pseudolikelihood =  -269.1295  
Iteration 3:  Log pseudolikelihood = -269.07689  
Iteration 4:  Log pseudolikelihood =  -269.0642  
Iteration 5:  Log pseudolikelihood =  -269.0616  
Iteration 6:  Log pseudolikelihood = -269.06118  
Iteration 7:  Log pseudolikelihood = -269.06108  
Iteration 8:  Log pseudolikelihood = -269.06105  
Iteration 9:  Log pseudolikelihood = -269.06105  

Markov-switching autoregression

Sample: 1994q2 thru 2020q1                              Number of obs =    104
Number of states = 2                                    AIC           = 5.2896
Unconditional probabilities: transition                 HQIC          = 5.3514
                                                        SBIC          = 5.4422
Log likelihood = -269.06105

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -1.214052   1.334323    -0.91   0.363    -3.829278    1.401174
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .4013272   .1594965     2.52   0.012     .0887199    .7139346
             |
       _cons |  -.4740836   .9920704    -0.48   0.633    -2.418506    1.470339
-------------+----------------------------------------------------------------
       sigma |   2.869513    .337924                      2.278073    3.614504
-------------+----------------------------------------------------------------
         p11 |   .7518247   .1076703                      .4943382    .9037309
-------------+----------------------------------------------------------------
         p21 |   .9999999   3.55e-07                      .9999481           1
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   14.09
         Prob > chi2 =    0.0002

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .00008719

. 
. *ereturn list
. 
. estat transition

Number of obs = 104         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .7518247   .1076703      .4943382    .9037309
-----------------------------+------------------------------------------------
                         p12 |   .2481753   .1076703      .0962691    .5056618
-----------------------------+------------------------------------------------
                         p21 |   .9999999   3.55e-07      .9999481           1
-----------------------------+------------------------------------------------
                         p22 |   1.14e-07   3.55e-07      2.50e-10    .0000519
------------------------------------------------------------------------------

. estat duration

Number of obs = 104         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   4.029411   1.748151      1.977606    10.38755
-----------------------------+------------------------------------------------
                      State2 |          1   3.55e-07             1    1.000052
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_9.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_BGR.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (KHM)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==10
(18,699 observations deleted)

. keep if date3<=tq(2019q4)
(11 observations deleted)

. 
. tsset date3

Time variable: date3, 1955q1 to 2019q4
        Delta: 1 quarter

. 
. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -225.49411  (not concave)
Iteration 1:  Log pseudolikelihood = -223.45331  (not concave)
Iteration 2:  Log pseudolikelihood = -222.40185  (not concave)
Iteration 3:  Log pseudolikelihood = -221.85004  
Iteration 4:  Log pseudolikelihood = -221.67912  
Iteration 5:  Log pseudolikelihood = -221.65191  
Iteration 6:  Log pseudolikelihood = -221.65168  
Iteration 7:  Log pseudolikelihood = -221.65168  

Markov-switching autoregression

Sample: 1994q2 thru 2019q4                              Number of obs =    103
Number of states = 2                                    AIC           = 4.4398
Unconditional probabilities: transition                 HQIC          = 4.5124
                                                        SBIC          = 4.6189
Log likelihood = -221.65168

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9706083   .4126142     2.35   0.019     .1618992    1.779317
             |
       _cons |  -11.54782    1.63148    -7.08   0.000    -14.74546   -8.350173
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .6617179   .0845553     7.83   0.000     .4959926    .8274433
             |
       _cons |  -5.824851   .5491721   -10.61   0.000    -6.901209   -4.748494
-------------+----------------------------------------------------------------
       sigma |   1.689671   .1399325                       1.43651    1.987447
-------------+----------------------------------------------------------------
         p11 |   .8016961   .1617942                      .3548618    .9674408
-------------+----------------------------------------------------------------
         p21 |   .0491213   .0416729                      .0089088    .2289186
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -225.48457  (not concave)
Iteration 1:  Log pseudolikelihood =  -223.4447  (not concave)
Iteration 2:  Log pseudolikelihood = -222.30397  
Iteration 3:  Log pseudolikelihood = -221.80892  
Iteration 4:  Log pseudolikelihood =  -221.6601  
Iteration 5:  Log pseudolikelihood = -221.65857  
Iteration 6:  Log pseudolikelihood = -221.65857  

Markov-switching autoregression

Sample: 1994q2 thru 2019q4                              Number of obs =    103
Number of states = 2                                    AIC           = 4.4206
Unconditional probabilities: transition                 HQIC          = 4.4827
                                                        SBIC          = 4.5740
Log likelihood = -221.65857

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -11.47484   .8215517   -13.97   0.000    -13.08505   -9.864628
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .6605923     .08481     7.79   0.000     .4943677    .8268168
             |
       _cons |   -5.83109   .5474852   -10.65   0.000    -6.904142   -4.758039
-------------+----------------------------------------------------------------
       sigma |   1.686275   .1258924                      1.456733    1.951986
-------------+----------------------------------------------------------------
         p11 |   .7969213   .1251008                      .4630942    .9469603
-------------+----------------------------------------------------------------
         p21 |   .0507322   .0324961                      .0140406    .1670616
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  103
             e(N_gaps) =  0
                 e(ll) =  -221.6585677387608
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  4.420554713373996
               e(sbic) =  4.574034071911645
               e(hqic) =  4.482719108705099
               e(tmin) =  137
               e(tmax) =  239
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2019q4"
              e(tmins) : "1994q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   16.02
         Prob > chi2 =    0.0001

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .00003141

. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  103
             e(N_gaps) =  0
                 e(ll) =  -221.6585677387608
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  4.420554713373996
               e(sbic) =  4.574034071911645
               e(hqic) =  4.482719108705099
               e(tmin) =  137
               e(tmax) =  239
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2019q4"
              e(tmins) : "1994q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 103         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .7969213   .1251008      .4630942    .9469603
-----------------------------+------------------------------------------------
                         p12 |   .2030787   .1251008      .0530397    .5369058
-----------------------------+------------------------------------------------
                         p21 |   .0507322   .0324961      .0140406    .1670616
-----------------------------+------------------------------------------------
                         p22 |   .9492678   .0324961      .8329384    .9859594
------------------------------------------------------------------------------

. estat duration

Number of obs = 103         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |     4.9242   3.033411      1.862524    18.85381
-----------------------------+------------------------------------------------
                      State2 |   19.71133   12.62592      5.985817    71.22201
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_10.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_KHM.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (CAN)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==11
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -292.43824  (not concave)
Iteration 1:  Log pseudolikelihood = -292.03959  (not concave)
Iteration 2:  Log pseudolikelihood = -291.63876  (not concave)
Iteration 3:  Log pseudolikelihood = -289.63107  (not concave)
Iteration 4:  Log pseudolikelihood = -285.63115  
Iteration 5:  Log pseudolikelihood = -283.00139  
Iteration 6:  Log pseudolikelihood = -282.44925  
Iteration 7:  Log pseudolikelihood = -282.44156  
Iteration 8:  Log pseudolikelihood = -282.44156  

Markov-switching autoregression

Sample: 1961q2 thru 2022q2                              Number of obs =    245
Number of states = 2                                    AIC           = 2.3628
Unconditional probabilities: transition                 HQIC          = 2.4031
                                                        SBIC          = 2.4628
Log likelihood = -282.44156

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .4637499   .0843582     5.50   0.000      .298411    .6290889
             |
       _cons |    -3.0947   .1937511   -15.97   0.000    -3.474445   -2.714955
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9391964    .028392    33.08   0.000     .8835491    .9948437
             |
       _cons |  -.9372803   .5366669    -1.75   0.081    -1.989128    .1145674
-------------+----------------------------------------------------------------
       sigma |   .7127816   .0325024                      .6518417    .7794186
-------------+----------------------------------------------------------------
         p11 |   .9586401    .025818                      .8661057    .9881024
-------------+----------------------------------------------------------------
         p21 |   .0133679   .0132012                      .0019015    .0878887
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -292.62077  (not concave)
Iteration 1:  Log pseudolikelihood = -292.40201  (not concave)
Iteration 2:  Log pseudolikelihood = -292.27704  (not concave)
Iteration 3:  Log pseudolikelihood = -292.00744  (not concave)
Iteration 4:  Log pseudolikelihood = -291.73011  (not concave)
Iteration 5:  Log pseudolikelihood = -291.55741  
Iteration 6:  Log pseudolikelihood = -291.32126  (not concave)
Iteration 7:  Log pseudolikelihood =   -286.637  
Iteration 8:  Log pseudolikelihood =  -285.2718  
Iteration 9:  Log pseudolikelihood = -284.98278  
Iteration 10: Log pseudolikelihood = -284.98023  
Iteration 11: Log pseudolikelihood = -284.98023  

Markov-switching autoregression

Sample: 1961q2 thru 2022q2                              Number of obs =    245
Number of states = 2                                    AIC           = 2.3753
Unconditional probabilities: transition                 HQIC          = 2.4099
                                                        SBIC          = 2.4611
Log likelihood = -284.98023

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .4657244   .0858506     5.42   0.000     .2974603    .6339885
             |
       _cons |  -3.096495   .2530133   -12.24   0.000    -3.592392   -2.600598
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -1.005627   .9886795    -1.02   0.309    -2.943403    .9321494
-------------+----------------------------------------------------------------
       sigma |   .7173466   .0368617                      .6486181    .7933576
-------------+----------------------------------------------------------------
         p11 |   .9577715    .023734                      .8777582    .9862335
-------------+----------------------------------------------------------------
         p21 |   .0154579   .0210136                      .0010475    .1903364
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  245
             e(N_gaps) =  0
                 e(ll) =  -284.9802264243449
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  2.375348787137509
               e(sbic) =  2.461093886171258
               e(hqic) =  2.40987826460506
               e(tmin) =  5
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1961q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   38.73
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 2.434e-10

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  245
             e(N_gaps) =  0
                 e(ll) =  -284.9802264243449
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  2.375348787137509
               e(sbic) =  2.461093886171258
               e(hqic) =  2.40987826460506
               e(tmin) =  5
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1961q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 245         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9577715    .023734      .8777582    .9862335
-----------------------------+------------------------------------------------
                         p12 |   .0422285    .023734      .0137665    .1222418
-----------------------------+------------------------------------------------
                         p21 |   .0154579   .0210136      .0010475    .1903364
-----------------------------+------------------------------------------------
                         p22 |   .9845421   .0210136      .8096636    .9989525
------------------------------------------------------------------------------

. estat duration

Number of obs = 245         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   23.68069   13.30946      8.180505    72.64034
-----------------------------+------------------------------------------------
                      State2 |   64.69197   87.94308      5.253856    954.6445
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_11.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_CAN.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (CHL)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==12
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -271.53672  (not concave)
Iteration 1:  Log pseudolikelihood = -268.85773  (not concave)
Iteration 2:  Log pseudolikelihood = -266.87128  
Iteration 3:  Log pseudolikelihood = -266.47047  
Iteration 4:  Log pseudolikelihood = -266.39008  
Iteration 5:  Log pseudolikelihood = -266.38992  
Iteration 6:  Log pseudolikelihood = -266.38992  

Markov-switching autoregression

Sample: 1991q2 thru 2022q3                              Number of obs =    126
Number of states = 2                                    AIC           = 4.3395
Unconditional probabilities: transition                 HQIC          = 4.4035
                                                        SBIC          = 4.4971
Log likelihood = -266.38992

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9211916   .0534181    17.24   0.000      .816494    1.025889
             |
       _cons |  -2.782778   .5860792    -4.75   0.000    -3.931472   -1.634083
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |  -.4019559   .1154393    -3.48   0.000    -.6282127    -.175699
             |
       _cons |  -1.324524    .489332    -2.71   0.007    -2.283597   -.3654512
-------------+----------------------------------------------------------------
       sigma |   1.703461   .1495037                      1.434256    2.023195
-------------+----------------------------------------------------------------
         p11 |   .9107464   .0382647                      .8022094    .9625076
-------------+----------------------------------------------------------------
         p21 |   .6851178   .2591554                      .1712083    .9581885
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -271.97533  (not concave)
Iteration 1:  Log pseudolikelihood = -270.06308  (not concave)
Iteration 2:  Log pseudolikelihood = -269.69847  
Iteration 3:  Log pseudolikelihood =  -268.0843  
Iteration 4:  Log pseudolikelihood = -267.65004  
Iteration 5:  Log pseudolikelihood = -267.64084  
Iteration 6:  Log pseudolikelihood = -267.64083  

Markov-switching autoregression

Sample: 1991q2 thru 2022q3                              Number of obs =    126
Number of states = 2                                    AIC           = 4.3435
Unconditional probabilities: transition                 HQIC          = 4.3984
                                                        SBIC          = 4.4786
Log likelihood = -267.64083

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -2.716033   .6156913    -4.41   0.000    -3.922766   -1.509301
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   -.355755   .1382799    -2.57   0.010    -.6267785   -.0847314
             |
       _cons |  -1.218855   .4326066    -2.82   0.005    -2.066749    -.370962
-------------+----------------------------------------------------------------
       sigma |   1.690256   .1416364                      1.434252    1.991956
-------------+----------------------------------------------------------------
         p11 |   .9008648   .0385935                      .7957416    .9549486
-------------+----------------------------------------------------------------
         p21 |   .6142246    .245976                      .1722884    .9241212
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  126
             e(N_gaps) =  0
                 e(ll) =  -267.6408284867175
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  4.343505214074881
               e(sbic) =  4.478566257263046
               e(hqic) =  4.398376283071817
               e(tmin) =  125
               e(tmax) =  250
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q3"
              e(tmins) : "1991q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   96.13
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = 5.388e-23

. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  126
             e(N_gaps) =  0
                 e(ll) =  -267.6408284867175
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  4.343505214074881
               e(sbic) =  4.478566257263046
               e(hqic) =  4.398376283071817
               e(tmin) =  125
               e(tmax) =  250
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q3"
              e(tmins) : "1991q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 126         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9008648   .0385935      .7957416    .9549486
-----------------------------+------------------------------------------------
                         p12 |   .0991352   .0385935      .0450514    .2042584
-----------------------------+------------------------------------------------
                         p21 |   .6142246    .245976      .1722884    .9241212
-----------------------------+------------------------------------------------
                         p22 |   .3857754    .245976      .0758788    .8277116
------------------------------------------------------------------------------

. estat duration

Number of obs = 126         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   10.08724   3.926975      4.895759    22.19687
-----------------------------+------------------------------------------------
                      State2 |   1.628069   .6519862      1.082109    5.804223
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_12.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_CHL.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (CHN)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==13
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -210.99348  (not concave)
Iteration 1:  Log pseudolikelihood = -208.37524  
Iteration 2:  Log pseudolikelihood = -208.08954  
Iteration 3:  Log pseudolikelihood = -207.98706  
Iteration 4:  Log pseudolikelihood = -207.98593  
Iteration 5:  Log pseudolikelihood = -207.98593  

Markov-switching autoregression

Sample: 1991q2 thru 2022q2                              Number of obs =    125
Number of states = 2                                    AIC           = 3.4398
Unconditional probabilities: transition                 HQIC          = 3.5041
                                                        SBIC          = 3.5982
Log likelihood = -207.98593

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3513111   .1562092     2.25   0.025     .0451467    .6574754
             |
       _cons |   2.045075   .2904291     7.04   0.000     1.475844    2.614305
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9856735   .0509435    19.35   0.000      .885826    1.085521
             |
       _cons |   3.186312   1.147312     2.78   0.005     .9376223    5.435002
-------------+----------------------------------------------------------------
       sigma |   1.134251   .1112654                       .935858    1.374703
-------------+----------------------------------------------------------------
         p11 |   .9165006   .0665741                      .6661167    .9837099
-------------+----------------------------------------------------------------
         p21 |   .1250398   .0613253                      .0454696    .3000799
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -211.0612  (not concave)
Iteration 1:  Log pseudolikelihood = -208.39626  
Iteration 2:  Log pseudolikelihood = -208.13742  
Iteration 3:  Log pseudolikelihood = -208.03315  
Iteration 4:  Log pseudolikelihood = -208.03183  
Iteration 5:  Log pseudolikelihood = -208.03183  

Markov-switching autoregression

Sample: 1991q2 thru 2022q2                              Number of obs =    125
Number of states = 2                                    AIC           = 3.4245
Unconditional probabilities: transition                 HQIC          = 3.4797
                                                        SBIC          = 3.5603
Log likelihood = -208.03183

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3528169   .1688501     2.09   0.037     .0218768     .683757
             |
       _cons |   2.049449    .291264     7.04   0.000     1.478582    2.620316
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   3.230714   1.099975     2.94   0.003     1.074803    5.386626
-------------+----------------------------------------------------------------
       sigma |   1.130851   .1123406                      .9307766    1.373932
-------------+----------------------------------------------------------------
         p11 |   .9177814    .070047                      .6440937    .9856843
-------------+----------------------------------------------------------------
         p21 |   .1265655   .0631469                      .0451635    .3074441
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  125
             e(N_gaps) =  0
                 e(ll) =  -208.0318337165647
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  3.424509339465035
               e(sbic) =  3.560268398855546
               e(hqic) =  3.479661078728576
               e(tmin) =  125
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1991q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   14.69
         Prob > chi2 =    0.0001

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .00006332

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  125
             e(N_gaps) =  0
                 e(ll) =  -208.0318337165647
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  3.424509339465035
               e(sbic) =  3.560268398855546
               e(hqic) =  3.479661078728576
               e(tmin) =  125
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1991q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 125         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9177814    .070047      .6440937    .9856843
-----------------------------+------------------------------------------------
                         p12 |   .0822186    .070047      .0143157    .3559063
-----------------------------+------------------------------------------------
                         p21 |   .1265655   .0631469      .0451635    .3074441
-----------------------------+------------------------------------------------
                         p22 |   .8734345   .0631469      .6925559    .9548365
------------------------------------------------------------------------------

. estat duration

Number of obs = 125         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |    12.1627   10.36214      2.809728    69.85335
-----------------------------+------------------------------------------------
                      State2 |   7.901044   3.942038      3.252623    22.14176
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_13.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_CHN.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (COL)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==14
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -147.00333  (not concave)
Iteration 1:  Log pseudolikelihood = -145.09779  (not concave)
Iteration 2:  Log pseudolikelihood = -144.30445  
Iteration 3:  Log pseudolikelihood =  -143.9281  
Iteration 4:  Log pseudolikelihood =  -143.8506  
Iteration 5:  Log pseudolikelihood = -143.84201  
Iteration 6:  Log pseudolikelihood = -143.83994  
Iteration 7:  Log pseudolikelihood = -143.83946  
Iteration 8:  Log pseudolikelihood = -143.83935  
Iteration 9:  Log pseudolikelihood = -143.83934  
Iteration 10: Log pseudolikelihood = -143.83933  

Markov-switching autoregression

Sample: 1996q2 thru 2022q2                              Number of obs =    105
Number of states = 2                                    AIC           = 2.8731
Unconditional probabilities: transition                 HQIC          = 2.9448
                                                        SBIC          = 3.0501
Log likelihood = -143.83933

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |    .962038   .0639741    15.04   0.000     .8366511    1.087425
             |
       _cons |   -1.87494   1.903106    -0.99   0.325     -5.60496     1.85508
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |    .059728   .2594028     0.23   0.818    -.4486922    .5681481
             |
       _cons |  -1.977858   .7290131    -2.71   0.007    -3.406697   -.5490183
-------------+----------------------------------------------------------------
       sigma |   .8808723   .0860801                      .7273313    1.066826
-------------+----------------------------------------------------------------
         p11 |    .951805   .0879482                      .3154802    .9988197
-------------+----------------------------------------------------------------
         p21 |   .9999999   3.98e-07                       .999656           1
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) varswitch constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -144.54276  
Iteration 1:  Log pseudolikelihood = -143.38182  
Iteration 2:  Log pseudolikelihood = -143.08715  
Iteration 3:  Log pseudolikelihood =  -143.0403  
Iteration 4:  Log pseudolikelihood = -143.00809  
Iteration 5:  Log pseudolikelihood = -143.00784  
Iteration 6:  Log pseudolikelihood = -143.00784  

Markov-switching autoregression

Sample: 1996q2 thru 2022q2                              Number of obs =    105
Number of states = 2                                    AIC           = 2.8573
Unconditional probabilities: transition                 HQIC          = 2.9290
                                                        SBIC          = 3.0342
Log likelihood = -143.00784

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -5.267132   1.484825    -3.55   0.000    -8.177335   -2.356929
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |    .873769   .0475365    18.38   0.000     .7805992    .9669389
             |
       _cons |  -2.739952   .8059993    -3.40   0.001    -4.319681   -1.160222
-------------+----------------------------------------------------------------
      sigma1 |   .5122535   .0908409                      .3618565    .7251593
-------------+----------------------------------------------------------------
      sigma2 |   .9357742   .0699601                      .8082277    1.083449
-------------+----------------------------------------------------------------
         p11 |   .9608427    .099862                      .1190008    .9997757
-------------+----------------------------------------------------------------
         p21 |   .0182329   .0309714                      .0006249    .3554904
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  7
                  e(N) =  105
             e(N_gaps) =  0
                 e(ll) =  -143.0078432434076
                  e(k) =  7
             e(states) =  2
               e(k_eq) =  6
              e(k_aux) =  4
                e(aic) =  2.857292252255383
               e(sbic) =  3.034222942265884
               e(hqic) =  2.92898805829866
               e(tmin) =  145
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) varswitch constraint.."
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1996q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(varswitch) : "varswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 8
                  e(V) :  8 x 8
                e(Cns) :  1 x 9
           e(initvals) :  1 x 8
            e(uncprob) :  1 x 2
       e(V_modelbased) :  8 x 8

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    7.05
         Prob > chi2 =    0.0079

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .00396011

. 
. ereturn list

scalars:
               e(rank) =  7
                  e(N) =  105
             e(N_gaps) =  0
                 e(ll) =  -143.0078432434076
                  e(k) =  7
             e(states) =  2
               e(k_eq) =  6
              e(k_aux) =  4
                e(aic) =  2.857292252255383
               e(sbic) =  3.034222942265884
               e(hqic) =  2.92898805829866
               e(tmin) =  145
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) varswitch constraint.."
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1996q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(varswitch) : "varswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 8
                  e(V) :  8 x 8
                e(Cns) :  1 x 9
           e(initvals) :  1 x 8
            e(uncprob) :  1 x 2
       e(V_modelbased) :  8 x 8

functions:
             e(sample)   

. 
. estat transition

Number of obs = 105         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9608427    .099862      .1190008    .9997757
-----------------------------+------------------------------------------------
                         p12 |   .0391573    .099862      .0002243    .8809992
-----------------------------+------------------------------------------------
                         p21 |   .0182329   .0309714      .0006249    .3554904
-----------------------------+------------------------------------------------
                         p22 |   .9817671   .0309714      .6445096    .9993751
------------------------------------------------------------------------------

. estat duration

Number of obs = 105         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   25.53799   65.12889      1.135075    4458.625
-----------------------------+------------------------------------------------
                      State2 |   54.84605   93.16466      2.813016    1600.213
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_14.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_COL.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (CRI)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==15
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -175.28959  (not concave)
Iteration 1:  Log pseudolikelihood = -174.78472  (not concave)
Iteration 2:  Log pseudolikelihood = -171.02669  
Iteration 3:  Log pseudolikelihood =   -169.707  (not concave)
Iteration 4:  Log pseudolikelihood =  -169.6595  
Iteration 5:  Log pseudolikelihood =  -169.6413  
Iteration 6:  Log pseudolikelihood = -169.62715  
Iteration 7:  Log pseudolikelihood =  -169.6269  
Iteration 8:  Log pseudolikelihood = -169.62686  
Iteration 9:  Log pseudolikelihood = -169.62685  

Markov-switching autoregression

Sample: 1999q2 thru 2022q2                              Number of obs =     93
Number of states = 2                                    AIC           = 3.7984
Unconditional probabilities: transition                 HQIC          = 3.8754
                                                        SBIC          = 3.9891
Log likelihood = -169.62685

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   2.237456    1.78686     1.25   0.211    -1.264726    5.739638
             |
       _cons |  -5.119908   4.521266    -1.13   0.257    -13.98143     3.74161
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |    .530431   .0816293     6.50   0.000     .3704404    .6904215
             |
       _cons |   -3.72123    .390749    -9.52   0.000    -4.487084   -2.955376
-------------+----------------------------------------------------------------
       sigma |   1.404032   .1427711                      1.150327    1.713692
-------------+----------------------------------------------------------------
         p11 |   6.12e-07   7.42e-07                      5.68e-08    6.59e-06
-------------+----------------------------------------------------------------
         p21 |   .0429708   .1033973                      .0003251    .8611109
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) varswitch constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -177.33188  (not concave)
Iteration 1:  Log pseudolikelihood = -175.23275  (not concave)
Iteration 2:  Log pseudolikelihood = -175.08951  (not concave)
Iteration 3:  Log pseudolikelihood = -174.45251  
Iteration 4:  Log pseudolikelihood = -174.33405  (not concave)
Iteration 5:  Log pseudolikelihood = -174.08135  (not concave)
Iteration 6:  Log pseudolikelihood = -173.90834  
Iteration 7:  Log pseudolikelihood = -173.72815  (not concave)
Iteration 8:  Log pseudolikelihood = -173.61618  
Iteration 9:  Log pseudolikelihood = -173.59727  
Iteration 10: Log pseudolikelihood = -173.59529  
Iteration 11: Log pseudolikelihood = -173.59528  

Markov-switching autoregression

Sample: 1999q2 thru 2022q2                              Number of obs =     93
Number of states = 2                                    AIC           = 3.8838
Unconditional probabilities: transition                 HQIC          = 3.9607
                                                        SBIC          = 4.0744
Log likelihood = -173.59528

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -2.965831   .4240141    -6.99   0.000    -3.796884   -2.134779
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .5601577   .0815711     6.87   0.000     .4002812    .7200341
             |
       _cons |  -4.051132   .4017132   -10.08   0.000    -4.838476   -3.263789
-------------+----------------------------------------------------------------
      sigma1 |   .1974243   .1876928                      .0306307    1.272461
-------------+----------------------------------------------------------------
      sigma2 |   1.603869   .1954769                      1.263066     2.03663
-------------+----------------------------------------------------------------
         p11 |   .0578459   .1692289                      .0001396    .9642763
-------------+----------------------------------------------------------------
         p21 |   .0862134   .0757047                      .0141442    .3828819
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  7
                  e(N) =  93
             e(N_gaps) =  0
                 e(ll) =  -173.5952798766202
                  e(k) =  7
             e(states) =  2
               e(k_eq) =  6
              e(k_aux) =  4
                e(aic) =  3.883769459712263
               e(sbic) =  4.07439522801412
               e(hqic) =  3.960738691996589
               e(tmin) =  157
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) varswitch constraint.."
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1999q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(varswitch) : "varswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 8
                  e(V) :  8 x 8
                e(Cns) :  1 x 9
           e(initvals) :  1 x 8
            e(uncprob) :  1 x 2
       e(V_modelbased) :  8 x 8

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   29.08
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = 3.481e-08

. 
. ereturn list

scalars:
               e(rank) =  7
                  e(N) =  93
             e(N_gaps) =  0
                 e(ll) =  -173.5952798766202
                  e(k) =  7
             e(states) =  2
               e(k_eq) =  6
              e(k_aux) =  4
                e(aic) =  3.883769459712263
               e(sbic) =  4.07439522801412
               e(hqic) =  3.960738691996589
               e(tmin) =  157
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) varswitch constraint.."
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1999q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(varswitch) : "varswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 8
                  e(V) :  8 x 8
                e(Cns) :  1 x 9
           e(initvals) :  1 x 8
            e(uncprob) :  1 x 2
       e(V_modelbased) :  8 x 8

functions:
             e(sample)   

. 
. estat transition

Number of obs = 93          
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .0578459   .1692289      .0001396    .9642763
-----------------------------+------------------------------------------------
                         p12 |   .9421541   .1692289      .0357237    .9998604
-----------------------------+------------------------------------------------
                         p21 |   .0862134   .0757047      .0141442    .3828819
-----------------------------+------------------------------------------------
                         p22 |   .9137866   .0757047      .6171181    .9858558
------------------------------------------------------------------------------

. estat duration

Number of obs = 93          
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   1.061397   .1906473       1.00014    27.99262
-----------------------------+------------------------------------------------
                      State2 |   11.59912   10.18528      2.611772    70.70058
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_15.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_CRI.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (HRV)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==16
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State1]L1.ar=1 // State 1 Non-stationary

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -217.67669  (not concave)
Iteration 1:  Log pseudolikelihood = -214.79798  (not concave)
Iteration 2:  Log pseudolikelihood = -210.40686  
Iteration 3:  Log pseudolikelihood = -208.99443  
Iteration 4:  Log pseudolikelihood = -208.64159  
Iteration 5:  Log pseudolikelihood = -208.62709  
Iteration 6:  Log pseudolikelihood = -208.62448  
Iteration 7:  Log pseudolikelihood =  -208.6239  
Iteration 8:  Log pseudolikelihood = -208.62375  
Iteration 9:  Log pseudolikelihood = -208.62373  
Iteration 10: Log pseudolikelihood = -208.62372  

Markov-switching autoregression

Sample: 1995q1 thru 2020q1                              Number of obs =    101
Number of states = 2                                    AIC           = 4.2698
Unconditional probabilities: transition                 HQIC          = 4.3432
                                                        SBIC          = 4.4510
Log likelihood = -208.62372

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   1.377123   .1159288    11.88   0.000     1.149906    1.604339
             |
       _cons |  -.8087007    3.84698    -0.21   0.833    -8.348643    6.731242
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9089721   .0484138    18.78   0.000     .8140828    1.003861
             |
       _cons |   .8635079   3.219937     0.27   0.789    -5.447453    7.174469
-------------+----------------------------------------------------------------
       sigma |   1.511394   .1617623                      1.225391    1.864148
-------------+----------------------------------------------------------------
         p11 |   1.71e-07   8.05e-08                      6.80e-08    4.30e-07
-------------+----------------------------------------------------------------
         p21 |   .1612312   .0651055                      .0696119    .3305885
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -217.65145  (not concave)
Iteration 1:  Log pseudolikelihood = -214.37421  (not concave)
Iteration 2:  Log pseudolikelihood = -213.27527  
Iteration 3:  Log pseudolikelihood = -212.47471  
Iteration 4:  Log pseudolikelihood = -212.28912  
Iteration 5:  Log pseudolikelihood = -212.28824  
Iteration 6:  Log pseudolikelihood = -212.28824  

Markov-switching autoregression

Sample: 1995q1 thru 2020q1                              Number of obs =    101
Number of states = 2                                    AIC           = 4.3225
Unconditional probabilities: transition                 HQIC          = 4.3854
                                                        SBIC          = 4.4779
Log likelihood = -212.28824

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -5.776848   2.455062    -2.35   0.019    -10.58868   -.9650149
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9242895    .035446    26.08   0.000     .8548166    .9937624
             |
       _cons |  -1.673971   2.284648    -0.73   0.464    -6.151799    2.803857
-------------+----------------------------------------------------------------
       sigma |    1.65781   .1148692                      1.447289    1.898953
-------------+----------------------------------------------------------------
         p11 |   .2087684   .1741356                      .0323411    .6756409
-------------+----------------------------------------------------------------
         p21 |   .0562135   .0427451                      .0121298    .2241567
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  101
             e(N_gaps) =  0
                 e(ll) =  -212.2882372609373
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  4.322539351701729
               e(sbic) =  4.477893045771506
               e(hqic) =  4.385430993100418
               e(tmin) =  140
               e(tmax) =  240
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2020q1"
              e(tmins) : "1995q1"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    4.56
         Prob > chi2 =    0.0327

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .0163422

. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  101
             e(N_gaps) =  0
                 e(ll) =  -212.2882372609373
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  4.322539351701729
               e(sbic) =  4.477893045771506
               e(hqic) =  4.385430993100418
               e(tmin) =  140
               e(tmax) =  240
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2020q1"
              e(tmins) : "1995q1"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 101         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .2087684   .1741356      .0323411    .6756409
-----------------------------+------------------------------------------------
                         p12 |   .7912316   .1741356      .3243591    .9676589
-----------------------------+------------------------------------------------
                         p21 |   .0562135   .0427451      .0121298    .2241567
-----------------------------+------------------------------------------------
                         p22 |   .9437865   .0427451      .7758433    .9878702
------------------------------------------------------------------------------

. estat duration

Number of obs = 101         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   1.263852   .2781508      1.033422    3.083003
-----------------------------+------------------------------------------------
                      State2 |   17.78934   13.52713      4.461166    82.44129
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_16.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_HRV.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (CZE)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==17
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -248.33463  
Iteration 1:  Log pseudolikelihood =  -245.4188  
Iteration 2:  Log pseudolikelihood = -244.84447  
Iteration 3:  Log pseudolikelihood = -244.83482  
Iteration 4:  Log pseudolikelihood = -244.83482  

Markov-switching autoregression

Sample: 1993q2 thru 2022q2                              Number of obs =    117
Number of states = 2                                    AIC           = 4.3049
Unconditional probabilities: transition                 HQIC          = 4.3720
                                                        SBIC          = 4.4701
Log likelihood = -244.83482

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |    .543572   .0954231     5.70   0.000     .3565462    .7305977
             |
       _cons |  -3.271038   .4597705    -7.11   0.000    -4.172172   -2.369905
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |  -.2690522   .1714909    -1.57   0.117    -.6051682    .0670637
             |
       _cons |   .9086212   .2720212     3.34   0.001     .3754695    1.441773
-------------+----------------------------------------------------------------
       sigma |   1.827273   .1646603                      1.531438    2.180255
-------------+----------------------------------------------------------------
         p11 |   .9894168   .0093403                      .9421094    .9981415
-------------+----------------------------------------------------------------
         p21 |      .0396   .0225153                      .0127569    .1162741
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) // constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -248.33463  
Iteration 1:  Log pseudolikelihood =  -245.4188  
Iteration 2:  Log pseudolikelihood = -244.84447  
Iteration 3:  Log pseudolikelihood = -244.83482  
Iteration 4:  Log pseudolikelihood = -244.83482  

Markov-switching autoregression

Sample: 1993q2 thru 2022q2                              Number of obs =    117
Number of states = 2                                    AIC           = 4.3049
Unconditional probabilities: transition                 HQIC          = 4.3720
                                                        SBIC          = 4.4701
Log likelihood = -244.83482

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |    .543572   .0954231     5.70   0.000     .3565462    .7305977
             |
       _cons |  -3.271038   .4597705    -7.11   0.000    -4.172172   -2.369905
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |  -.2690522   .1714909    -1.57   0.117    -.6051682    .0670637
             |
       _cons |   .9086212   .2720212     3.34   0.001     .3754695    1.441773
-------------+----------------------------------------------------------------
       sigma |   1.827273   .1646603                      1.531438    2.180255
-------------+----------------------------------------------------------------
         p11 |   .9894168   .0093403                      .9421094    .9981415
-------------+----------------------------------------------------------------
         p21 |      .0396   .0225153                      .0127569    .1162741
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  7
                  e(N) =  117
             e(N_gaps) =  0
                 e(ll) =  -244.8348193515842
                  e(k) =  7
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  4.304868706864688
               e(sbic) =  4.470126976467972
               e(hqic) =  4.371961525853107
               e(tmin) =  133
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1993q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   22.88
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 8.626e-07

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   54.76
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = 6.803e-14

. 
. ereturn list

scalars:
               e(rank) =  7
                  e(N) =  117
             e(N_gaps) =  0
                 e(ll) =  -244.8348193515842
                  e(k) =  7
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  4.304868706864688
               e(sbic) =  4.470126976467972
               e(hqic) =  4.371961525853107
               e(tmin) =  133
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1993q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 117         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9894168   .0093403      .9421094    .9981415
-----------------------------+------------------------------------------------
                         p12 |   .0105832   .0093403      .0018585    .0578906
-----------------------------+------------------------------------------------
                         p21 |      .0396   .0225153      .0127569    .1162741
-----------------------------+------------------------------------------------
                         p22 |      .9604   .0225153      .8837259    .9872431
------------------------------------------------------------------------------

. estat duration

Number of obs = 117         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   94.48952    83.3924      17.27397    538.0719
-----------------------------+------------------------------------------------
                      State2 |   25.25251   14.35779       8.60037    78.38891
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_17.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_CZE.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==18
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -292.3574  (not concave)
Iteration 1:  Log pseudolikelihood = -290.85619  (not concave)
Iteration 2:  Log pseudolikelihood = -288.97511  (not concave)
Iteration 3:  Log pseudolikelihood = -285.31642  (not concave)
Iteration 4:  Log pseudolikelihood = -283.67626  (not concave)
Iteration 5:  Log pseudolikelihood = -282.03636  (not concave)
Iteration 6:  Log pseudolikelihood = -278.40465  
Iteration 7:  Log pseudolikelihood = -276.77845  
Iteration 8:  Log pseudolikelihood =  -276.0626  
Iteration 9:  Log pseudolikelihood = -275.97617  
Iteration 10: Log pseudolikelihood = -275.96242  
Iteration 11: Log pseudolikelihood = -275.96218  
Iteration 12: Log pseudolikelihood = -275.96218  

Markov-switching autoregression

Sample: 1977q2 thru 2022q2                              Number of obs =    181
Number of states = 2                                    AIC           = 3.1267
Unconditional probabilities: transition                 HQIC          = 3.1768
                                                        SBIC          = 3.2504
Log likelihood = -275.96218

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   1.000558   .0074578   134.16   0.000     .9859406    1.015175
             |
       _cons |   11.64177    6.29884     1.85   0.065    -.7037297    23.98727
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9299047   .0390245    23.83   0.000     .8534182    1.006391
             |
       _cons |   9.366392    6.11331     1.53   0.125    -2.615475    21.34826
-------------+----------------------------------------------------------------
       sigma |   .8043413   .0457164                      .7195493    .8991252
-------------+----------------------------------------------------------------
         p11 |   .8789906    .041206                      .7727001    .9394708
-------------+----------------------------------------------------------------
         p21 |   .6443034   .1161518                      .4014896    .8302564
------------------------------------------------------------------------------

. 
. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. *mswitch ar cab, arswitch ar(1) vce(robust)
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -289.59847  
Iteration 1:  Log pseudolikelihood = -286.96176  
Iteration 2:  Log pseudolikelihood = -286.89076  
Iteration 3:  Log pseudolikelihood = -286.88937  
Iteration 4:  Log pseudolikelihood = -286.88935  

Markov-switching autoregression

Sample: 1977q2 thru 2022q2                              Number of obs =    181
Number of states = 2                                    AIC           = 3.2474
Unconditional probabilities: transition                 HQIC          = 3.2975
                                                        SBIC          = 3.3711
Log likelihood = -286.88935

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   4.657275   4.832158     0.96   0.335    -4.813581    14.12813
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9235093   .0404361    22.84   0.000      .844256    1.002763
             |
       _cons |   6.235859   2.018944     3.09   0.002     2.278801    10.19292
-------------+----------------------------------------------------------------
      sigma1 |   .8873978   .1036778                      .7057802    1.115751
-------------+----------------------------------------------------------------
      sigma2 |   1.392734   .1125395                       1.18874    1.631734
-------------+----------------------------------------------------------------
         p11 |   .9910158   .0177976                      .6868397    .9998198
-------------+----------------------------------------------------------------
         p21 |   .0077674   .0140627                       .000219    .2186099
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  7
                  e(N) =  181
             e(N_gaps) =  0
                 e(ll) =  -286.8893520744725
                  e(k) =  7
             e(states) =  2
               e(k_eq) =  6
              e(k_aux) =  4
                e(aic) =  3.247396155519033
               e(sbic) =  3.371094935733734
               e(hqic) =  3.297546286563497
               e(tmin) =  69
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1) varswi.."
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1977q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(varswitch) : "varswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 8
                  e(V) :  8 x 8
                e(Cns) :  1 x 9
           e(initvals) :  1 x 8
            e(uncprob) :  1 x 2
       e(V_modelbased) :  8 x 8

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    3.58
         Prob > chi2 =    0.0585

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .02926913

. 
. ereturn list

scalars:
               e(rank) =  7
                  e(N) =  181
             e(N_gaps) =  0
                 e(ll) =  -286.8893520744725
                  e(k) =  7
             e(states) =  2
               e(k_eq) =  6
              e(k_aux) =  4
                e(aic) =  3.247396155519033
               e(sbic) =  3.371094935733734
               e(hqic) =  3.297546286563497
               e(tmin) =  69
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1) varswi.."
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1977q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(varswitch) : "varswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 8
                  e(V) :  8 x 8
                e(Cns) :  1 x 9
           e(initvals) :  1 x 8
            e(uncprob) :  1 x 2
       e(V_modelbased) :  8 x 8

functions:
             e(sample)   

. 
. estat transition

Number of obs = 181         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9910158   .0177976      .6868397    .9998198
-----------------------------+------------------------------------------------
                         p12 |   .0089842   .0177976      .0001802    .3131603
-----------------------------+------------------------------------------------
                         p21 |   .0077674   .0140627       .000219    .2186099
-----------------------------+------------------------------------------------
                         p22 |   .9922326   .0140627      .7813901     .999781
------------------------------------------------------------------------------

. estat duration

Number of obs = 181         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   111.3071    220.499      3.193253    5548.765
-----------------------------+------------------------------------------------
                      State2 |   128.7432   233.0859      4.574358    4566.387
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_18.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_DNK.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (SLV)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==19
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -182.0953  
Iteration 1:  Log pseudolikelihood = -181.51705  
Iteration 2:  Log pseudolikelihood = -181.46637  
Iteration 3:  Log pseudolikelihood = -181.46629  
Iteration 4:  Log pseudolikelihood = -181.46629  

Markov-switching autoregression

Sample: 1999q2 thru 2020q1                              Number of obs =     84
Number of states = 2                                    AIC           = 4.4873
Unconditional probabilities: transition                 HQIC          = 4.5687
                                                        SBIC          = 4.6899
Log likelihood = -181.46629

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3021161   .1556667     1.94   0.052    -.0029849    .6072171
             |
       _cons |   -5.80479   .4168817   -13.92   0.000    -6.621863   -4.987717
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .1222307    .160386     0.76   0.446    -.1921201    .4365816
             |
       _cons |  -2.127901   .3346468    -6.36   0.000    -2.783796   -1.472005
-------------+----------------------------------------------------------------
       sigma |   1.802236   .1329532                      1.559615      2.0826
-------------+----------------------------------------------------------------
         p11 |   .9323977   .0353141                      .8214259    .9763901
-------------+----------------------------------------------------------------
         p21 |   .0508121   .0424217                       .009458    .2308436
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) 

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -182.0953  
Iteration 1:  Log pseudolikelihood = -181.51705  
Iteration 2:  Log pseudolikelihood = -181.46637  
Iteration 3:  Log pseudolikelihood = -181.46629  
Iteration 4:  Log pseudolikelihood = -181.46629  

Markov-switching autoregression

Sample: 1999q2 thru 2020q1                              Number of obs =     84
Number of states = 2                                    AIC           = 4.4873
Unconditional probabilities: transition                 HQIC          = 4.5687
                                                        SBIC          = 4.6899
Log likelihood = -181.46629

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3021161   .1556667     1.94   0.052    -.0029849    .6072171
             |
       _cons |   -5.80479   .4168817   -13.92   0.000    -6.621863   -4.987717
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .1222307    .160386     0.76   0.446    -.1921201    .4365816
             |
       _cons |  -2.127901   .3346468    -6.36   0.000    -2.783796   -1.472005
-------------+----------------------------------------------------------------
       sigma |   1.802236   .1329532                      1.559615      2.0826
-------------+----------------------------------------------------------------
         p11 |   .9323977   .0353141                      .8214259    .9763901
-------------+----------------------------------------------------------------
         p21 |   .0508121   .0424217                       .009458    .2308436
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  7
                  e(N) =  84
             e(N_gaps) =  0
                 e(ll) =  -181.4662886569914
                  e(k) =  7
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  4.487292587071224
               e(sbic) =  4.6898606536415
               e(hqic) =  4.568723244743346
               e(tmin) =  157
               e(tmax) =  240
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2020q1"
              e(tmins) : "1999q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   20.10
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 3.677e-06

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   29.95
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = 2.214e-08

. 
. ereturn list

scalars:
               e(rank) =  7
                  e(N) =  84
             e(N_gaps) =  0
                 e(ll) =  -181.4662886569914
                  e(k) =  7
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  4.487292587071224
               e(sbic) =  4.6898606536415
               e(hqic) =  4.568723244743346
               e(tmin) =  157
               e(tmax) =  240
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2020q1"
              e(tmins) : "1999q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 84          
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9323977   .0353141      .8214259    .9763901
-----------------------------+------------------------------------------------
                         p12 |   .0676023   .0353141      .0236099    .1785741
-----------------------------+------------------------------------------------
                         p21 |   .0508121   .0424217       .009458    .2308436
-----------------------------+------------------------------------------------
                         p22 |   .9491879   .0424217      .7691564     .990542
------------------------------------------------------------------------------

. estat duration

Number of obs = 84          
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |    14.7924   7.727258      5.599916    42.35515
-----------------------------+------------------------------------------------
                      State2 |   19.68036   16.43062      4.331937    105.7306
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_19.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_SLV.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (EST)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==20
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -294.01394  
Iteration 1:  Log pseudolikelihood = -293.76269  
Iteration 2:  Log pseudolikelihood = -293.75884  
Iteration 3:  Log pseudolikelihood = -293.75884  

Markov-switching autoregression

Sample: 1993q2 thru 2022q2                              Number of obs =    117
Number of states = 2                                    AIC           = 5.1412
Unconditional probabilities: transition                 HQIC          = 5.2083
                                                        SBIC          = 5.3064
Log likelihood = -293.75884

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |  -.1024286    .074555    -1.37   0.169    -.2485538    .0436966
             |
       _cons |  -6.616371   .9015709    -7.34   0.000    -8.383417   -4.849324
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9702942   .0460328    21.08   0.000     .8800715    1.060517
             |
       _cons |  -.4264562   1.251668    -0.34   0.733     -2.87968    2.026768
-------------+----------------------------------------------------------------
       sigma |   2.476817   .2367261                      2.053709    2.987095
-------------+----------------------------------------------------------------
         p11 |   .7146487   .0859354                      .5230166    .8511955
-------------+----------------------------------------------------------------
         p21 |   .0424233   .0232645                      .0142149    .1198064
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -294.54953  
Iteration 1:  Log pseudolikelihood =  -294.1434  
Iteration 2:  Log pseudolikelihood = -294.06107  
Iteration 3:  Log pseudolikelihood = -294.06064  
Iteration 4:  Log pseudolikelihood = -294.06064  

Markov-switching autoregression

Sample: 1993q2 thru 2022q2                              Number of obs =    117
Number of states = 2                                    AIC           = 5.1292
Unconditional probabilities: transition                 HQIC          = 5.1867
                                                        SBIC          = 5.2709
Log likelihood = -294.06064

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   -.101072   .0755254    -1.34   0.181    -.2490991    .0469551
             |
       _cons |  -6.521693   .8306789    -7.85   0.000    -8.149794   -4.893593
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -.1084673   .7807629    -0.14   0.890    -1.638734      1.4218
-------------+----------------------------------------------------------------
       sigma |   2.455785   .2125111                      2.072678    2.909706
-------------+----------------------------------------------------------------
         p11 |   .7137886   .0823513                      .5309086     .846046
-------------+----------------------------------------------------------------
         p21 |    .044802   .0224901                      .0164687     .116126
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  117
             e(N_gaps) =  0
                 e(ll) =  -294.0606415439643
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  5.129241735794262
               e(sbic) =  5.270891681168505
               e(hqic) =  5.186749866355764
               e(tmin) =  133
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1993q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =  212.54
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 1.915e-48

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  117
             e(N_gaps) =  0
                 e(ll) =  -294.0606415439643
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  5.129241735794262
               e(sbic) =  5.270891681168505
               e(hqic) =  5.186749866355764
               e(tmin) =  133
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1993q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 117         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .7137886   .0823513      .5309086     .846046
-----------------------------+------------------------------------------------
                         p12 |   .2862114   .0823513       .153954    .4690914
-----------------------------+------------------------------------------------
                         p21 |    .044802   .0224901      .0164687     .116126
-----------------------------+------------------------------------------------
                         p22 |    .955198   .0224901       .883874    .9835313
------------------------------------------------------------------------------

. estat duration

Number of obs = 117         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   3.493921   1.005302      2.131781    6.495447
-----------------------------+------------------------------------------------
                      State2 |   22.32041   11.20458      8.611339    60.72141
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_20.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_EST.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (FIN)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==21
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -338.7091  
Iteration 1:  Log pseudolikelihood = -338.47998  
Iteration 2:  Log pseudolikelihood = -338.47366  
Iteration 3:  Log pseudolikelihood = -338.47366  

Markov-switching autoregression

Sample: 1975q2 thru 2022q2                              Number of obs =    189
Number of states = 2                                    AIC           = 3.6558
Unconditional probabilities: transition                 HQIC          = 3.7044
                                                        SBIC          = 3.7759
Log likelihood = -338.47366

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .6721602   .0628523    10.69   0.000      .548972    .7953484
             |
       _cons |  -.9904691   .7423878    -1.33   0.182    -2.445523    .4645843
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9611947    .027057    35.52   0.000     .9081638    1.014225
             |
       _cons |   1.778183   1.125191     1.58   0.114    -.4271518    3.983517
-------------+----------------------------------------------------------------
       sigma |   1.153988     .06813                      1.027892    1.295553
-------------+----------------------------------------------------------------
         p11 |   .4609934   .2032617                      .1468349    .8095295
-------------+----------------------------------------------------------------
         p21 |    .085706   .0451308                      .0294249    .2247126
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -339.51551  
Iteration 1:  Log pseudolikelihood = -339.43062  
Iteration 2:  Log pseudolikelihood = -339.42983  
Iteration 3:  Log pseudolikelihood = -339.42983  

Markov-switching autoregression

Sample: 1975q2 thru 2022q2                              Number of obs =    189
Number of states = 2                                    AIC           = 3.6553
Unconditional probabilities: transition                 HQIC          = 3.6970
                                                        SBIC          = 3.7583
Log likelihood = -339.42983

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .6667972   .0720032     9.26   0.000     .5256735    .8079208
             |
       _cons |  -.9643273   .7608065    -1.27   0.205    -2.455481    .5268261
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   1.642817   1.223639     1.34   0.179    -.7554705    4.041105
-------------+----------------------------------------------------------------
       sigma |   1.137579   .0712033                      1.006244    1.286056
-------------+----------------------------------------------------------------
         p11 |   .4766805   .2441625                      .1179781    .8611681
-------------+----------------------------------------------------------------
         p21 |   .1050612    .057038                      .0345163    .2782363
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  189
             e(N_gaps) =  0
                 e(ll) =  -339.4298316795441
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  3.65534213417507
               e(sbic) =  3.758254737827757
               e(hqic) =  3.697034505133046
               e(tmin) =  61
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1975q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   21.41
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 1.850e-06

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  189
             e(N_gaps) =  0
                 e(ll) =  -339.4298316795441
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  3.65534213417507
               e(sbic) =  3.758254737827757
               e(hqic) =  3.697034505133046
               e(tmin) =  61
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1975q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 189         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .4766805   .2441625      .1179781    .8611681
-----------------------------+------------------------------------------------
                         p12 |   .5233195   .2441625      .1388319    .8820219
-----------------------------+------------------------------------------------
                         p21 |   .1050612    .057038      .0345163    .2782363
-----------------------------+------------------------------------------------
                         p22 |   .8949388    .057038      .7217637    .9654837
------------------------------------------------------------------------------

. estat duration

Number of obs = 189         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   1.910878   .8915488      1.133759    7.202956
-----------------------------+------------------------------------------------
                      State2 |   9.518265    5.16749      3.594067    28.97184
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_21.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_FIN.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account (FRA)
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==22
(18,699 observations deleted)

. *keep if date3>=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. 
. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -198.81901  (not concave)
Iteration 1:  Log pseudolikelihood =  -198.6084  (not concave)
Iteration 2:  Log pseudolikelihood =  -198.0677  (not concave)
Iteration 3:  Log pseudolikelihood = -197.16904  (not concave)
Iteration 4:  Log pseudolikelihood = -196.91882  (not concave)
Iteration 5:  Log pseudolikelihood = -194.17413  (not concave)
Iteration 6:  Log pseudolikelihood = -192.63593  
Iteration 7:  Log pseudolikelihood = -192.27181  
Iteration 8:  Log pseudolikelihood = -192.26466  
Iteration 9:  Log pseudolikelihood = -192.26466  

Markov-switching autoregression

Sample: 1975q2 thru 2022q2                              Number of obs =    189
Number of states = 2                                    AIC           = 2.1086
Unconditional probabilities: transition                 HQIC          = 2.1573
                                                        SBIC          = 2.2287
Log likelihood = -192.26466

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3311527   .0732533     4.52   0.000     .1875789    .4747265
             |
       _cons |  -.5708455   .1495745    -3.82   0.000    -.8640061   -.2776848
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .8776603   .0594819    14.76   0.000     .7610779    .9942427
             |
       _cons |   .2735178   .9619595     0.28   0.776    -1.611888    2.158924
-------------+----------------------------------------------------------------
       sigma |    .655752   .0519417                       .561457    .7658835
-------------+----------------------------------------------------------------
         p11 |   .9909604    .024418                      .3439906    .9999564
-------------+----------------------------------------------------------------
         p21 |   .0055449   .0077144                      .0003592    .0796367
------------------------------------------------------------------------------

. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -198.72707  (not concave)
Iteration 1:  Log pseudolikelihood = -198.54671  (not concave)
Iteration 2:  Log pseudolikelihood = -197.92119  
Iteration 3:  Log pseudolikelihood = -197.07449  (backed up)
Iteration 4:  Log pseudolikelihood = -196.81917  (not concave)
Iteration 5:  Log pseudolikelihood = -196.49457  (not concave)
Iteration 6:  Log pseudolikelihood = -195.77819  
Iteration 7:  Log pseudolikelihood = -195.51938  
Iteration 8:  Log pseudolikelihood = -195.48659  
Iteration 9:  Log pseudolikelihood = -195.48629  
Iteration 10: Log pseudolikelihood = -195.48629  

Markov-switching autoregression

Sample: 1975q2 thru 2022q2                              Number of obs =    189
Number of states = 2                                    AIC           = 2.1321
Unconditional probabilities: transition                 HQIC          = 2.1738
                                                        SBIC          = 2.2350
Log likelihood = -195.48629

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3533679   .2013277     1.76   0.079    -.0412271    .7479629
             |
       _cons |  -.5596089   .1854309    -3.02   0.003    -.9230467   -.1961711
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -.6328974   2.139144    -0.30   0.767    -4.825543    3.559749
-------------+----------------------------------------------------------------
       sigma |    .667432   .0508308                      .5748845    .7748782
-------------+----------------------------------------------------------------
         p11 |   .9892968   .0210397                      .6529388    .9997798
-------------+----------------------------------------------------------------
         p21 |   .0069482   .0144167                      .0001165    .2958477
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  189
             e(N_gaps) =  0
                 e(ll) =  -195.4862946177778
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  2.132130101775426
               e(sbic) =  2.235042705428113
               e(hqic) =  2.173822472733403
               e(tmin) =  61
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1975q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   10.32
         Prob > chi2 =    0.0013

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .00065944

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. ereturn list

scalars:
               e(rank) =  6
                  e(N) =  189
             e(N_gaps) =  0
                 e(ll) =  -195.4862946177778
                  e(k) =  6
             e(states) =  2
               e(k_eq) =  5
              e(k_aux) =  3
                e(aic) =  2.132130101775426
               e(sbic) =  2.235042705428113
               e(hqic) =  2.173822472733403
               e(tmin) =  61
               e(tmax) =  249
             e(emiter) =  10

macros:
       e(marginsnotok) : "_ALL"
         e(switchvars) : "L1.ar"
                 e(ar) : "1"
              e(model) : "ar"
            e(cmdline) : "mswitch ar cab , arswitch ar(1) vce(robust) constraint(1)"
                e(cmd) : "mswitch"
              e(tmaxs) : "2022q2"
              e(tmins) : "1975q2"
              e(tsfmt) : "%tq"
            e(timevar) : "date3"
                 e(p0) : "transition"
           e(arswitch) : "arswitch"
          e(estat_cmd) : "mswitch_estat"
            e(predict) : "mswitch_p"
            e(eqnames) : "State1 State1 State2 State2"
            e(vcetype) : "Robust"
                e(vce) : "robust"
          e(technique) : "nr"
             e(depvar) : "cab"
              e(title) : "Markov-switching autoregression"
         e(properties) : "b V"

matrices:
                  e(b) :  1 x 7
                  e(V) :  7 x 7
                e(Cns) :  1 x 8
           e(initvals) :  1 x 7
            e(uncprob) :  1 x 2
       e(V_modelbased) :  7 x 7

functions:
             e(sample)   

. 
. estat transition

Number of obs = 189         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9892968   .0210397      .6529388    .9997798
-----------------------------+------------------------------------------------
                         p12 |   .0107032   .0210397      .0002202    .3470612
-----------------------------+------------------------------------------------
                         p21 |   .0069482   .0144167      .0001165    .2958477
-----------------------------+------------------------------------------------
                         p22 |   .9930518   .0144167      .7041523    .9998835
------------------------------------------------------------------------------

. estat duration

Number of obs = 189         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   93.43018   183.6599      2.881336    4542.102
-----------------------------+------------------------------------------------
                      State2 |   143.9224   298.6224      3.380117    8583.274
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_22.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_FRA.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==23
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -218.93055  (not concave)
Iteration 1:  Log pseudolikelihood = -217.26498  (not concave)
Iteration 2:  Log pseudolikelihood = -216.48338  (not concave)
Iteration 3:  Log pseudolikelihood = -215.04416  (not concave)
Iteration 4:  Log pseudolikelihood = -211.19444  
Iteration 5:  Log pseudolikelihood = -209.53969  (not concave)
Iteration 6:  Log pseudolikelihood = -208.47228  
Iteration 7:  Log pseudolikelihood =  -207.7446  
Iteration 8:  Log pseudolikelihood =  -207.5093  
Iteration 9:  Log pseudolikelihood = -207.50349  
Iteration 10: Log pseudolikelihood = -207.50225  
Iteration 11: Log pseudolikelihood = -207.50197  
Iteration 12: Log pseudolikelihood =  -207.5019  
Iteration 13: Log pseudolikelihood = -207.50189  

Markov-switching autoregression

Sample: 1997q2 thru 2020q1                              Number of obs =     92
Number of states = 2                                    AIC           = 4.6631
Unconditional probabilities: transition                 HQIC          = 4.7405
                                                        SBIC          = 4.8550
Log likelihood = -207.50189

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   3.753007   .2387632    15.72   0.000     3.285039    4.220974
             |
       _cons |   -5.15475   1.923541    -2.68   0.007    -8.924822   -1.384678
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .7494941     .04943    15.16   0.000     .6526131    .8463752
             |
       _cons |  -9.219782   .6899002   -13.36   0.000    -10.57196   -7.867602
-------------+----------------------------------------------------------------
       sigma |   2.109103   .2173173                      1.723423    2.581093
-------------+----------------------------------------------------------------
         p11 |   1.02e-06   8.71e-07                      1.90e-07    5.45e-06
-------------+----------------------------------------------------------------
         p21 |    .031804    .029261                      .0050751    .1746013
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -218.95691  (not concave)
Iteration 1:  Log pseudolikelihood = -217.46269  
Iteration 2:  Log pseudolikelihood = -215.68561  (backed up)
Iteration 3:  Log pseudolikelihood = -214.32479  
Iteration 4:  Log pseudolikelihood = -214.11107  
Iteration 5:  Log pseudolikelihood = -214.10908  
Iteration 6:  Log pseudolikelihood = -214.10908  

Markov-switching autoregression

Sample: 1997q2 thru 2020q1                              Number of obs =     92
Number of states = 2                                    AIC           = 4.7850
Unconditional probabilities: transition                 HQIC          = 4.8514
                                                        SBIC          = 4.9494
Log likelihood = -214.10908

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -19.35077   3.285422    -5.89   0.000    -25.79008   -12.91146
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .7708029   .0646651    11.92   0.000     .6440616    .8975442
             |
       _cons |  -9.519245   1.031838    -9.23   0.000    -11.54161    -7.49688
-------------+----------------------------------------------------------------
       sigma |   2.300495   .1655399                      1.997884    2.648942
-------------+----------------------------------------------------------------
         p11 |   .7967802   .1502996                      .3886486    .9602879
-------------+----------------------------------------------------------------
         p21 |   .0110385     .01076                      .0016145    .0715297
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   12.56
         Prob > chi2 =    0.0004

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .00019678

. 
. *ereturn list
. 
. estat transition

Number of obs = 92          
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .7967802   .1502996      .3886486    .9602879
-----------------------------+------------------------------------------------
                         p12 |   .2032198   .1502996      .0397121    .6113514
-----------------------------+------------------------------------------------
                         p21 |   .0110385     .01076      .0016145    .0715297
-----------------------------+------------------------------------------------
                         p22 |   .9889615     .01076      .9284703    .9983855
------------------------------------------------------------------------------

. estat duration

Number of obs = 92          
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |    4.92078   3.639365       1.63572    25.18125
-----------------------------+------------------------------------------------
                      State2 |   90.59187   88.30623      13.98021      619.38
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_23.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_GEO.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==24
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -246.08689  (not concave)
Iteration 1:  Log pseudolikelihood = -243.69863  (not concave)
Iteration 2:  Log pseudolikelihood = -241.91487  
Iteration 3:  Log pseudolikelihood = -241.82191  
Iteration 4:  Log pseudolikelihood = -241.19386  
Iteration 5:  Log pseudolikelihood = -241.12987  
Iteration 6:  Log pseudolikelihood = -241.12853  
Iteration 7:  Log pseudolikelihood = -241.12853  

Markov-switching autoregression

Sample: 1971q2 thru 2022q2                              Number of obs =    205
Number of states = 2                                    AIC           = 2.4208
Unconditional probabilities: transition                 HQIC          = 2.4667
                                                        SBIC          = 2.5342
Log likelihood = -241.12853

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9822744   .0331503    29.63   0.000     .9173011    1.047248
             |
       _cons |    1.90846   5.453753     0.35   0.726      -8.7807    12.59762
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9100218   .1341629     6.78   0.000     .6470673    1.172976
             |
       _cons |   4.104431    4.10306     1.00   0.317    -3.937419    12.14628
-------------+----------------------------------------------------------------
       sigma |   .6929478   .0997806                      .5225553    .9189011
-------------+----------------------------------------------------------------
         p11 |   .9774654   .0355107                      .6479704    .9990227
-------------+----------------------------------------------------------------
         p21 |   .1663825    .381565                       .000908    .9776957
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -246.9557  (not concave)
Iteration 1:  Log pseudolikelihood = -244.68057  (not concave)
Iteration 2:  Log pseudolikelihood = -242.79597  
Iteration 3:  Log pseudolikelihood = -242.61882  (not concave)
Iteration 4:  Log pseudolikelihood = -241.61984  
Iteration 5:  Log pseudolikelihood = -241.56077  
Iteration 6:  Log pseudolikelihood = -241.55763  
Iteration 7:  Log pseudolikelihood =  -241.5576  

Markov-switching autoregression

Sample: 1971q2 thru 2022q2                              Number of obs =    205
Number of states = 2                                    AIC           = 2.4152
Unconditional probabilities: transition                 HQIC          = 2.4545
                                                        SBIC          = 2.5125
Log likelihood = -241.5576

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   .1094197    4.88541     0.02   0.982    -9.465809    9.684648
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9227399   .1276913     7.23   0.000     .6724696     1.17301
             |
       _cons |   2.430864   4.766252     0.51   0.610    -6.910818    11.77255
-------------+----------------------------------------------------------------
       sigma |   .6977957   .0751475                      .5650152    .8617801
-------------+----------------------------------------------------------------
         p11 |   .9786878   .0260566                      .7987452    .9981215
-------------+----------------------------------------------------------------
         p21 |   .1527406   .2874728                      .0023125    .9334286
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    0.37
         Prob > chi2 =    0.5451

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .27257145

. 
. *ereturn list
. 
. estat transition

Number of obs = 205         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9786878   .0260566      .7987452    .9981215
-----------------------------+------------------------------------------------
                         p12 |   .0213122   .0260566      .0018785    .2012548
-----------------------------+------------------------------------------------
                         p21 |   .1527406   .2874728      .0023125    .9334286
-----------------------------+------------------------------------------------
                         p22 |   .8472594   .2874728      .0665714    .9976875
------------------------------------------------------------------------------

. estat duration

Number of obs = 205         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   46.92152   57.36696      4.968827    532.3374
-----------------------------+------------------------------------------------
                      State2 |   6.547046   12.32218      1.071319    432.4363
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_24.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_DEU.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==25
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -373.29228  
Iteration 1:  Log pseudolikelihood = -373.24058  
Iteration 2:  Log pseudolikelihood =  -373.2403  
Iteration 3:  Log pseudolikelihood =  -373.2403  

Markov-switching autoregression

Sample: 1976q2 thru 2022q2                              Number of obs =    185
Number of states = 2                                    AIC           = 4.1107
Unconditional probabilities: transition                 HQIC          = 4.1601
                                                        SBIC          = 4.2326
Log likelihood = -373.2403

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9729335    .041298    23.56   0.000     .8919909    1.053876
             |
       _cons |  -3.778901   .8061513    -4.69   0.000    -5.358928   -2.198873
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .3163834   .1109366     2.85   0.004     .0989517    .5338151
             |
       _cons |  -2.046527   .6284741    -3.26   0.001    -3.278314   -.8147409
-------------+----------------------------------------------------------------
       sigma |    1.61447   .0995682                      1.430654    1.821905
-------------+----------------------------------------------------------------
         p11 |   .9392171   .0340342                      .8276798      .98028
-------------+----------------------------------------------------------------
         p21 |   .0772811   .0568926                      .0172321    .2857434
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -373.60232  
Iteration 1:  Log pseudolikelihood = -373.53344  
Iteration 2:  Log pseudolikelihood = -373.53318  
Iteration 3:  Log pseudolikelihood = -373.53318  

Markov-switching autoregression

Sample: 1976q2 thru 2022q2                              Number of obs =    185
Number of states = 2                                    AIC           = 4.1031
Unconditional probabilities: transition                 HQIC          = 4.1454
                                                        SBIC          = 4.2075
Log likelihood = -373.53318

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -3.637492   .8241329    -4.41   0.000    -5.252763   -2.022221
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .3197065    .109231     2.93   0.003     .1056176    .5337954
             |
       _cons |  -2.069759   .6397718    -3.24   0.001    -3.323688   -.8158288
-------------+----------------------------------------------------------------
       sigma |   1.615325   .0982955                      1.433715     1.81994
-------------+----------------------------------------------------------------
         p11 |   .9367736   .0350341                      .8229399    .9792663
-------------+----------------------------------------------------------------
         p21 |   .0747615    .054178                      .0171096    .2727649
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   38.79
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = 2.362e-10

. 
. *ereturn list
. 
. estat transition

Number of obs = 185         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9367736   .0350341      .8229399    .9792663
-----------------------------+------------------------------------------------
                         p12 |   .0632264   .0350341      .0207337    .1770601
-----------------------------+------------------------------------------------
                         p21 |   .0747615    .054178      .0171096    .2727649
-----------------------------+------------------------------------------------
                         p22 |   .9252385    .054178      .7272351    .9828904
------------------------------------------------------------------------------

. estat duration

Number of obs = 185         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   15.81617   8.763815      5.647799    48.23072
-----------------------------+------------------------------------------------
                      State2 |   13.37587   9.693201       3.66616    58.44676
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_25.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_GRC.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==26
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -366.87847  
Iteration 1:  Log pseudolikelihood = -363.45231  
Iteration 2:  Log pseudolikelihood = -362.13465  
Iteration 3:  Log pseudolikelihood = -361.92733  
Iteration 4:  Log pseudolikelihood = -361.92678  
Iteration 5:  Log pseudolikelihood = -361.92678  

Markov-switching autoregression

Sample: 1977q2 thru 2020q1                              Number of obs =    172
Number of states = 2                                    AIC           = 4.2898
Unconditional probabilities: transition                 HQIC          = 4.3418
                                                        SBIC          = 4.4179
Log likelihood = -361.92678

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .4527226   .0693604     6.53   0.000     .3167787    .5886664
             |
       _cons |  -4.710756   .3673367   -12.82   0.000    -5.430723   -3.990789
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9313716   .0610613    15.25   0.000     .8116936     1.05105
             |
       _cons |   1.960347   1.966221     1.00   0.319    -1.893375    5.814069
-------------+----------------------------------------------------------------
       sigma |   1.809329   .1553753                      1.529048    2.140987
-------------+----------------------------------------------------------------
         p11 |   .9842822   .0145725                      .9081254    .9974858
-------------+----------------------------------------------------------------
         p21 |   .0337935   .0259928                      .0072941    .1427243
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -367.91869  
Iteration 1:  Log pseudolikelihood =  -363.9469  
Iteration 2:  Log pseudolikelihood = -362.41943  
Iteration 3:  Log pseudolikelihood = -362.40823  
Iteration 4:  Log pseudolikelihood = -362.40822  

Markov-switching autoregression

Sample: 1977q2 thru 2020q1                              Number of obs =    172
Number of states = 2                                    AIC           = 4.2838
Unconditional probabilities: transition                 HQIC          = 4.3284
                                                        SBIC          = 4.3936
Log likelihood = -362.40822

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |    .453416   .0710279     6.38   0.000      .314204    .5926281
             |
       _cons |  -4.685536   .3469247   -13.51   0.000    -5.365496   -4.005576
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   2.211107   1.650366     1.34   0.180     -1.02355    5.445765
-------------+----------------------------------------------------------------
       sigma |   1.811856    .156457                      1.529752    2.145984
-------------+----------------------------------------------------------------
         p11 |   .9842119   .0138387                      .9158354    .9972077
-------------+----------------------------------------------------------------
         p21 |   .0343036   .0262285                      .0074696    .1435911
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   59.22
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 7.056e-15

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 172         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9842119   .0138387      .9158354    .9972077
-----------------------------+------------------------------------------------
                         p12 |   .0157881   .0138387      .0027923    .0841646
-----------------------------+------------------------------------------------
                         p21 |   .0343036   .0262285      .0074696    .1435911
-----------------------------+------------------------------------------------
                         p22 |   .9656964   .0262285      .8564089    .9925304
------------------------------------------------------------------------------

. estat duration

Number of obs = 172         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |    63.3389   55.51837      11.88148    358.1332
-----------------------------+------------------------------------------------
                      State2 |   29.15147   22.28922      6.964219    133.8767
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_26.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_GTM.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==27
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -204.80786  
Iteration 1:  Log pseudolikelihood = -204.71434  
Iteration 2:  Log pseudolikelihood = -204.08311  
Iteration 3:  Log pseudolikelihood =  -204.0318  
Iteration 4:  Log pseudolikelihood = -204.02988  
Iteration 5:  Log pseudolikelihood = -204.02956  
Iteration 6:  Log pseudolikelihood = -204.02952  
Iteration 7:  Log pseudolikelihood = -204.02951  

Markov-switching autoregression

Sample: 1999q2 thru 2020q1                              Number of obs =     84
Number of states = 2                                    AIC           = 5.0245
Unconditional probabilities: transition                 HQIC          = 5.1059
                                                        SBIC          = 5.2271
Log likelihood = -204.02951

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .0464066   .2733653     0.17   0.865    -.4893795    .5821927
             |
       _cons |   4.255047    1.24818     3.41   0.001     1.808659    6.701436
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9022934   .0799174    11.29   0.000     .7456582    1.058928
             |
       _cons |   7.255498   2.043177     3.55   0.000     3.250944    11.26005
-------------+----------------------------------------------------------------
       sigma |   2.496082   .1896297                      2.150761    2.896846
-------------+----------------------------------------------------------------
         p11 |   1.53e-06   2.42e-06                      6.92e-08     .000034
-------------+----------------------------------------------------------------
         p21 |   .0683418   .0679946                      .0089644     .372994
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -205.48658  (not concave)
Iteration 1:  Log pseudolikelihood = -205.15888  
Iteration 2:  Log pseudolikelihood = -204.96976  
Iteration 3:  Log pseudolikelihood = -204.96622  
Iteration 4:  Log pseudolikelihood = -204.96609  
Iteration 5:  Log pseudolikelihood = -204.96608  

Markov-switching autoregression

Sample: 1999q2 thru 2020q1                              Number of obs =     84
Number of states = 2                                    AIC           = 5.0230
Unconditional probabilities: transition                 HQIC          = 5.0928
                                                        SBIC          = 5.1966
Log likelihood = -204.96608

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .1290059   .3003904     0.43   0.668    -.4597485    .7177603
             |
       _cons |   3.968636   1.011766     3.92   0.000     1.985611     5.95166
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   6.283679   1.566716     4.01   0.000     3.212973    9.354386
-------------+----------------------------------------------------------------
       sigma |   2.487848   .1880839                      2.145221    2.885197
-------------+----------------------------------------------------------------
         p11 |   3.90e-06   .0000107                      1.83e-08    .0008329
-------------+----------------------------------------------------------------
         p21 |   .1104258   .1137008                      .0126796     .545426
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    8.41
         Prob > chi2 =    0.0037

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .00186855

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 84          
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   3.90e-06   .0000107      1.83e-08    .0008329
-----------------------------+------------------------------------------------
                         p12 |   .9999961   .0000107      .9991671           1
-----------------------------+------------------------------------------------
                         p21 |   .1104258   .1137008      .0126796     .545426
-----------------------------+------------------------------------------------
                         p22 |   .8895742   .1137008       .454574    .9873204
------------------------------------------------------------------------------

. estat duration

Number of obs = 84          
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   1.000004   .0000107             1    1.000834
-----------------------------+------------------------------------------------
                      State2 |   9.055851   9.324428      1.833429     78.8671
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_27.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_HKG.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==28
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) varswitch vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -294.40535  
Iteration 1:  Log pseudolikelihood =  -294.3275  
Iteration 2:  Log pseudolikelihood = -294.32722  
Iteration 3:  Log pseudolikelihood = -294.32722  

Markov-switching autoregression

Sample: 1990q1 thru 2022q2                              Number of obs =    130
Number of states = 2                                    AIC           = 4.6512
Unconditional probabilities: transition                 HQIC          = 4.7229
                                                        SBIC          = 4.8277
Log likelihood = -294.32722

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .6229593   .1463849     4.26   0.000     .3360501    .9098685
             |
       _cons |  -6.889768   .5877009   -11.72   0.000    -8.041641   -5.737896
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .5371047   .2348954     2.29   0.022     .0767182    .9974911
             |
       _cons |   .8621921   .7141417     1.21   0.227    -.5374999    2.261884
-------------+----------------------------------------------------------------
      sigma1 |   2.048256   .3777795                      1.426885    2.940218
-------------+----------------------------------------------------------------
      sigma2 |    1.91415   .1368688                      1.663841    2.202115
-------------+----------------------------------------------------------------
         p11 |   .9616752   .0200463                      .8962781     .986462
-------------+----------------------------------------------------------------
         p21 |   .0442765   .0295123                      .0116706    .1538022
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -294.40535  
Iteration 1:  Log pseudolikelihood =  -294.3275  
Iteration 2:  Log pseudolikelihood = -294.32722  
Iteration 3:  Log pseudolikelihood = -294.32722  

Markov-switching autoregression

Sample: 1990q1 thru 2022q2                              Number of obs =    130
Number of states = 2                                    AIC           = 4.6512
Unconditional probabilities: transition                 HQIC          = 4.7229
                                                        SBIC          = 4.8277
Log likelihood = -294.32722

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .6229593   .1463849     4.26   0.000     .3360501    .9098685
             |
       _cons |  -6.889768   .5877009   -11.72   0.000    -8.041641   -5.737896
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .5371047   .2348954     2.29   0.022     .0767182    .9974911
             |
       _cons |   .8621921   .7141417     1.21   0.227    -.5374999    2.261884
-------------+----------------------------------------------------------------
      sigma1 |   2.048256   .3777795                      1.426885    2.940218
-------------+----------------------------------------------------------------
      sigma2 |    1.91415   .1368688                      1.663841    2.202115
-------------+----------------------------------------------------------------
         p11 |   .9616752   .0200463                      .8962781     .986462
-------------+----------------------------------------------------------------
         p21 |   .0442765   .0295123                      .0116706    .1538022
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    6.63
         Prob > chi2 =    0.0100

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .00500217

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    3.88
         Prob > chi2 =    0.0488

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .02438226

. 
. *ereturn list
. 
. estat transition

Number of obs = 130         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9616752   .0200463      .8962781     .986462
-----------------------------+------------------------------------------------
                         p12 |   .0383248   .0200463       .013538    .1037219
-----------------------------+------------------------------------------------
                         p21 |   .0442765   .0295123      .0116706    .1538022
-----------------------------+------------------------------------------------
                         p22 |   .9557235   .0295123      .8461978    .9883294
------------------------------------------------------------------------------

. estat duration

Number of obs = 130         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   26.09277   13.64819      9.641166    73.86599
-----------------------------+------------------------------------------------
                      State2 |   22.58537    15.0542      6.501858    85.68558
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_28.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_HUN.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==29
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -532.96331  (not concave)
Iteration 1:  Log pseudolikelihood = -532.64047  (not concave)
Iteration 2:  Log pseudolikelihood = -532.49632  (not concave)
Iteration 3:  Log pseudolikelihood = -531.37719  (not concave)
Iteration 4:  Log pseudolikelihood = -531.07366  
Iteration 5:  Log pseudolikelihood = -530.95484  (not concave)
Iteration 6:  Log pseudolikelihood = -530.04368  
Iteration 7:  Log pseudolikelihood =  -529.5582  
Iteration 8:  Log pseudolikelihood = -529.54827  
Iteration 9:  Log pseudolikelihood = -529.54826  

Markov-switching autoregression

Sample: 1976q2 thru 2022q2                              Number of obs =    185
Number of states = 2                                    AIC           = 5.8113
Unconditional probabilities: transition                 HQIC          = 5.8678
                                                        SBIC          = 5.9506
Log likelihood = -529.54826

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3849851   .4998082     0.77   0.441     -.594621    1.364591
             |
       _cons |  -15.08145   7.706151    -1.96   0.050    -30.18523    .0223234
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .6788892   .0784526     8.65   0.000     .5251249    .8326535
             |
       _cons |  -1.772978   .9788943    -1.81   0.070    -3.691576    .1456194
-------------+----------------------------------------------------------------
      sigma1 |   7.754716   1.398085                      5.446333    11.04149
-------------+----------------------------------------------------------------
      sigma2 |   3.721262   .2463856                      3.268376    4.236903
-------------+----------------------------------------------------------------
         p11 |   .9411068   .0672694                      .5968868    .9942349
-------------+----------------------------------------------------------------
         p21 |   .0083141   .0058555                      .0020798    .0326249
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -532.96331  (not concave)
Iteration 1:  Log pseudolikelihood = -532.64047  (not concave)
Iteration 2:  Log pseudolikelihood = -532.49632  (not concave)
Iteration 3:  Log pseudolikelihood = -531.37719  (not concave)
Iteration 4:  Log pseudolikelihood = -531.07366  
Iteration 5:  Log pseudolikelihood = -530.95484  (not concave)
Iteration 6:  Log pseudolikelihood = -530.04368  
Iteration 7:  Log pseudolikelihood =  -529.5582  
Iteration 8:  Log pseudolikelihood = -529.54827  
Iteration 9:  Log pseudolikelihood = -529.54826  

Markov-switching autoregression

Sample: 1976q2 thru 2022q2                              Number of obs =    185
Number of states = 2                                    AIC           = 5.8113
Unconditional probabilities: transition                 HQIC          = 5.8678
                                                        SBIC          = 5.9506
Log likelihood = -529.54826

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3849851   .4998082     0.77   0.441     -.594621    1.364591
             |
       _cons |  -15.08145   7.706151    -1.96   0.050    -30.18523    .0223234
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .6788892   .0784526     8.65   0.000     .5251249    .8326535
             |
       _cons |  -1.772978   .9788943    -1.81   0.070    -3.691576    .1456194
-------------+----------------------------------------------------------------
      sigma1 |   7.754716   1.398085                      5.446333    11.04149
-------------+----------------------------------------------------------------
      sigma2 |   3.721262   .2463856                      3.268376    4.236903
-------------+----------------------------------------------------------------
         p11 |   .9411068   .0672694                      .5968868    .9942349
-------------+----------------------------------------------------------------
         p21 |   .0083141   .0058555                      .0020798    .0326249
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    1.51
         Prob > chi2 =    0.2185

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .10925462

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   16.75
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .00002129

. 
. *ereturn list
. 
. estat transition

Number of obs = 185         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9411068   .0672694      .5968868    .9942349
-----------------------------+------------------------------------------------
                         p12 |   .0588932   .0672694      .0057651    .4031132
-----------------------------+------------------------------------------------
                         p21 |   .0083141   .0058555      .0020798    .0326249
-----------------------------+------------------------------------------------
                         p22 |   .9916859   .0058555      .9673751    .9979202
------------------------------------------------------------------------------

. estat duration

Number of obs = 185         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   16.97988   19.39488      2.480692    173.4576
-----------------------------+------------------------------------------------
                      State2 |   120.2783   84.71046       30.6514    480.8193
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_29.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_ISL.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==30
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -372.68942  (not concave)
Iteration 1:  Log pseudolikelihood = -372.52594  
Iteration 2:  Log pseudolikelihood = -372.32167  
Iteration 3:  Log pseudolikelihood = -372.26996  
Iteration 4:  Log pseudolikelihood = -372.26094  
Iteration 5:  Log pseudolikelihood = -372.26091  

Markov-switching autoregression

Sample: 1960q2 thru 2022q2                              Number of obs =    249
Number of states = 2                                    AIC           = 3.0543
Unconditional probabilities: transition                 HQIC          = 3.0998
                                                        SBIC          = 3.1673
Log likelihood = -372.26091

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .7761008   .1300882     5.97   0.000     .5211325    1.031069
             |
       _cons |  -1.528276   .3282644    -4.66   0.000    -2.171663     -.88489
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .2185099   .4663232     0.47   0.639    -.6954668    1.132486
             |
       _cons |  -.3134817   .4515272    -0.69   0.488    -1.198459    .5714953
-------------+----------------------------------------------------------------
      sigma1 |    .749723   .1028724                      .5729334    .9810644
-------------+----------------------------------------------------------------
      sigma2 |   2.438993   .6009088                      1.504857    3.952993
-------------+----------------------------------------------------------------
         p11 |   .9346682   .0334215                      .8303314    .9766481
-------------+----------------------------------------------------------------
         p21 |   .3000315   .3234239                      .0205218    .8976368
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =   -381.561  
Iteration 1:  Log pseudolikelihood =  -380.5123  (not concave)
Iteration 2:  Log pseudolikelihood = -380.24493  
Iteration 3:  Log pseudolikelihood = -380.03717  
Iteration 4:  Log pseudolikelihood = -380.03479  
Iteration 5:  Log pseudolikelihood = -380.03479  

Markov-switching autoregression

Sample: 1960q2 thru 2022q2                              Number of obs =    249
Number of states = 2                                    AIC           = 3.1087
Unconditional probabilities: transition                 HQIC          = 3.1485
                                                        SBIC          = 3.2076
Log likelihood = -380.03479

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -1.674625   .5559409    -3.01   0.003     -2.76425   -.5850012
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .0569238   .1959588     0.29   0.771    -.3271485    .4409961
             |
       _cons |  -.1783971   .4154473    -0.43   0.668     -.992659    .6358647
-------------+----------------------------------------------------------------
      sigma1 |   .7712977   .0478482                       .682994    .8710181
-------------+----------------------------------------------------------------
      sigma2 |   2.189759   .5233998                      1.370694    3.498258
-------------+----------------------------------------------------------------
         p11 |   .9384973   .0319496                      .8375767    .9783337
-------------+----------------------------------------------------------------
         p21 |    .271248   .1788148                      .0594524    .6866892
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   23.16
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = 7.448e-07

. 
. *ereturn list
. 
. estat transition

Number of obs = 249         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9384973   .0319496      .8375767    .9783337
-----------------------------+------------------------------------------------
                         p12 |   .0615027   .0319496      .0216663    .1624233
-----------------------------+------------------------------------------------
                         p21 |    .271248   .1788148      .0594524    .6866892
-----------------------------+------------------------------------------------
                         p22 |    .728752   .1788148      .3133108    .9405476
------------------------------------------------------------------------------

. estat duration

Number of obs = 249         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   16.25945   8.446515      6.156751    46.15457
-----------------------------+------------------------------------------------
                      State2 |   3.686663   2.430358      1.456263    16.82017
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_30.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_IND.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==31
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -314.41404  (not concave)
Iteration 1:  Log pseudolikelihood = -310.85886  
Iteration 2:  Log pseudolikelihood = -308.90766  
Iteration 3:  Log pseudolikelihood = -304.16543  
Iteration 4:  Log pseudolikelihood = -297.11348  
Iteration 5:  Log pseudolikelihood = -296.83456  
Iteration 6:  Log pseudolikelihood = -296.80127  
Iteration 7:  Log pseudolikelihood = -296.80125  

Markov-switching autoregression

Sample: 1981q2 thru 2022q3                              Number of obs =    166
Number of states = 2                                    AIC           = 3.6723
Unconditional probabilities: transition                 HQIC          = 3.7332
                                                        SBIC          = 3.8223
Log likelihood = -296.80125

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8362192   .0749944    11.15   0.000     .6892329    .9832055
             |
       _cons |  -1.278139   1.182283    -1.08   0.280    -3.595372    1.039094
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9022508   .0565902    15.94   0.000     .7913359    1.013166
             |
       _cons |  -1.103015   .8205446    -1.34   0.179    -2.711253    .5052233
-------------+----------------------------------------------------------------
      sigma1 |   2.037983   .1904476                      1.696901    2.447623
-------------+----------------------------------------------------------------
      sigma2 |   .6567031   .1210834                      .4575346    .9425714
-------------+----------------------------------------------------------------
         p11 |   .9939345   .0095934                      .8787006    .9997303
-------------+----------------------------------------------------------------
         p21 |   .0089401   .0074331                      .0017393    .0446194
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -315.9212  (not concave)
Iteration 1:  Log pseudolikelihood = -303.65951  (not concave)
Iteration 2:  Log pseudolikelihood = -300.92464  
Iteration 3:  Log pseudolikelihood = -298.76476  
Iteration 4:  Log pseudolikelihood = -298.35026  
Iteration 5:  Log pseudolikelihood = -298.33552  
Iteration 6:  Log pseudolikelihood =  -298.3355  

Markov-switching autoregression

Sample: 1981q2 thru 2022q3                              Number of obs =    166
Number of states = 2                                    AIC           = 3.6787
Unconditional probabilities: transition                 HQIC          = 3.7320
                                                        SBIC          = 3.8100
Log likelihood = -298.3355

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8313634   .0685634    12.13   0.000     .6969816    .9657453
             |
       _cons |  -.6745959   1.114996    -0.61   0.545    -2.859948    1.510757
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -.5023337   1.283208    -0.39   0.695    -3.017374    2.012707
-------------+----------------------------------------------------------------
      sigma1 |   2.029147     .17882                      1.707265    2.411717
-------------+----------------------------------------------------------------
      sigma2 |   .6670819   .0808713                      .5260011    .8460023
-------------+----------------------------------------------------------------
         p11 |   .9940226   .0093433                      .8840885    .9997243
-------------+----------------------------------------------------------------
         p21 |   .0089101   .0075168                      .0016923    .0455087
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    6.05
         Prob > chi2 =    0.0139

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .00695518

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 166         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9940226   .0093433      .8840885    .9997243
-----------------------------+------------------------------------------------
                         p12 |   .0059774   .0093433      .0002757    .1159115
-----------------------------+------------------------------------------------
                         p21 |   .0089101   .0075168      .0016923    .0455087
-----------------------------+------------------------------------------------
                         p22 |   .9910899   .0075168      .9544913    .9983077
------------------------------------------------------------------------------

. estat duration

Number of obs = 166         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   167.2962   261.5005      8.627274    3626.728
-----------------------------+------------------------------------------------
                      State2 |   112.2324   94.68242      21.97382    590.9088
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_31.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_IDN.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==32
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -404.22858  
Iteration 1:  Log pseudolikelihood = -396.37405  
Iteration 2:  Log pseudolikelihood = -396.27026  
Iteration 3:  Log pseudolikelihood = -396.27011  
Iteration 4:  Log pseudolikelihood = -396.27011  

Markov-switching autoregression

Sample: 1990q2 thru 2022q2                              Number of obs =    129
Number of states = 2                                    AIC           = 6.2522
Unconditional probabilities: transition                 HQIC          = 6.3153
                                                        SBIC          = 6.4074
Log likelihood = -396.27011

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |  -.8377874   .0965487    -8.68   0.000    -1.027019   -.6485553
             |
       _cons |  -18.34542   2.095907    -8.75   0.000    -22.45333   -14.23752
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9949534   .0154887    64.24   0.000     .9645961    1.025311
             |
       _cons |  -26.30737   4.014381    -6.55   0.000    -34.17541   -18.43933
-------------+----------------------------------------------------------------
       sigma |   4.531925   .4882857                      3.669199    5.597501
-------------+----------------------------------------------------------------
         p11 |    .496189   .2019824                      .1681425    .8275498
-------------+----------------------------------------------------------------
         p21 |   .0243388   .0139606                      .0078193    .0731844
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -404.3015  
Iteration 1:  Log pseudolikelihood = -396.43118  
Iteration 2:  Log pseudolikelihood = -396.32705  
Iteration 3:  Log pseudolikelihood = -396.32691  
Iteration 4:  Log pseudolikelihood = -396.32691  

Markov-switching autoregression

Sample: 1990q2 thru 2022q2                              Number of obs =    129
Number of states = 2                                    AIC           = 6.2376
Unconditional probabilities: transition                 HQIC          = 6.2917
                                                        SBIC          = 6.3706
Log likelihood = -396.32691

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |  -.8372529   .0965017    -8.68   0.000    -1.026393    -.648113
             |
       _cons |   -18.3313   2.084102    -8.80   0.000    -22.41607   -14.24654
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -26.37053   3.936608    -6.70   0.000    -34.08614   -18.65492
-------------+----------------------------------------------------------------
       sigma |    4.53389   .4830044                      3.679517    5.586647
-------------+----------------------------------------------------------------
         p11 |   .4961869   .2019798                      .1681442    .8275457
-------------+----------------------------------------------------------------
         p21 |   .0243529   .0139688                      .0078237     .073226
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =  362.47
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 4.088e-81

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 129         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .4961869   .2019798      .1681442    .8275457
-----------------------------+------------------------------------------------
                         p12 |   .5038131   .2019798      .1724543    .8318558
-----------------------------+------------------------------------------------
                         p21 |   .0243529   .0139688      .0078237     .073226
-----------------------------+------------------------------------------------
                         p22 |   .9756471   .0139688       .926774    .9921763
------------------------------------------------------------------------------

. estat duration

Number of obs = 129         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   1.984863    .795736      1.202131    5.798637
-----------------------------+------------------------------------------------
                      State2 |   41.06292    23.5536      13.65635    127.8168
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_32.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_IRL.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==33
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -464.89823  
Iteration 1:  Log pseudolikelihood = -464.47887  
Iteration 2:  Log pseudolikelihood = -464.44927  
Iteration 3:  Log pseudolikelihood = -464.44918  
Iteration 4:  Log pseudolikelihood = -464.44918  

Markov-switching autoregression

Sample: 1972q2 thru 2022q2                              Number of obs =    201
Number of states = 2                                    AIC           = 4.7010
Unconditional probabilities: transition                 HQIC          = 4.7542
                                                        SBIC          = 4.8325
Log likelihood = -464.44918

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .0550865   .3085966     0.18   0.858    -.5497518    .6599248
             |
       _cons |  -.8073184   4.268262    -0.19   0.850    -9.172958    7.558321
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9563626   .0530162    18.04   0.000     .8524528    1.060272
             |
       _cons |  -4.713034   4.293596    -1.10   0.272    -13.12833     3.70226
-------------+----------------------------------------------------------------
      sigma1 |   7.934191   1.375149                      5.649017    11.14378
-------------+----------------------------------------------------------------
      sigma2 |   1.712391   .1654559                       1.41696    2.069419
-------------+----------------------------------------------------------------
         p11 |   .6356819   .1038404                       .420155    .8077535
-------------+----------------------------------------------------------------
         p21 |   .0468724   .0205371                      .0195831    .1080005
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -466.34358  
Iteration 1:  Log pseudolikelihood = -466.10036  
Iteration 2:  Log pseudolikelihood = -466.08561  
Iteration 3:  Log pseudolikelihood = -466.08559  

Markov-switching autoregression

Sample: 1972q2 thru 2022q2                              Number of obs =    201
Number of states = 2                                    AIC           = 4.7073
Unconditional probabilities: transition                 HQIC          = 4.7539
                                                        SBIC          = 4.8224
Log likelihood = -466.08559

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .0864377   .2525361     0.34   0.732    -.4085239    .5813992
             |
       _cons |  -2.514617   1.892014    -1.33   0.184    -6.222896    1.193662
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   -6.52511   1.915272    -3.41   0.001    -10.27898   -2.771245
-------------+----------------------------------------------------------------
      sigma1 |   7.741398   1.167966                      5.759653    10.40501
-------------+----------------------------------------------------------------
      sigma2 |   1.690994   .1518812                      1.418042    2.016485
-------------+----------------------------------------------------------------
         p11 |    .642071   .0970649                      .4394374    .8041086
-------------+----------------------------------------------------------------
         p21 |   .0503059   .0203783                       .022444    .1089024
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   13.09
         Prob > chi2 =    0.0003

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .0001487

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 201         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |    .642071   .0970649      .4394374    .8041086
-----------------------------+------------------------------------------------
                         p12 |    .357929   .0970649      .1958914    .5605626
-----------------------------+------------------------------------------------
                         p21 |   .0503059   .0203783       .022444    .1089024
-----------------------------+------------------------------------------------
                         p22 |   .9496941   .0203783      .8910976     .977556
------------------------------------------------------------------------------

. estat duration

Number of obs = 201         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |    2.79385   .7576501      1.783922     5.10487
-----------------------------+------------------------------------------------
                      State2 |   19.87837   8.052493      9.182534    44.55531
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_33.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_ISR.dta saved

. 
. ****************************************************************
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. 
. // MS AR for the current account
. 
. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==34
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -267.83007  
Iteration 1:  Log pseudolikelihood = -267.30828  
Iteration 2:  Log pseudolikelihood = -266.59591  
Iteration 3:  Log pseudolikelihood = -266.57874  
Iteration 4:  Log pseudolikelihood = -266.57874  

Markov-switching autoregression

Sample: 1970q2 thru 2022q2                              Number of obs =    209
Number of states = 2                                    AIC           = 2.6180
Unconditional probabilities: transition                 HQIC          = 2.6632
                                                        SBIC          = 2.7299
Log likelihood = -266.57874

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |    .868765   .1168065     7.44   0.000     .6398285    1.097702
             |
       _cons |  -1.843243   .6833493    -2.70   0.007    -3.182583   -.5039027
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9319505   .0293103    31.80   0.000     .8745034    .9893977
             |
       _cons |   .1972268   .7530723     0.26   0.793    -1.278768    1.673221
-------------+----------------------------------------------------------------
       sigma |   .7276219   .0543277                      .6285662    .8422878
-------------+----------------------------------------------------------------
         p11 |   .5033194   .1559509                      .2298057    .7748607
-------------+----------------------------------------------------------------
         p21 |   .0439305   .0202218                      .0175693    .1055928
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -270.06661  
Iteration 1:  Log pseudolikelihood = -269.45541  
Iteration 2:  Log pseudolikelihood = -269.13222  
Iteration 3:  Log pseudolikelihood = -269.06311  
Iteration 4:  Log pseudolikelihood = -269.04291  
Iteration 5:  Log pseudolikelihood = -269.04036  
Iteration 6:  Log pseudolikelihood = -269.04027  
Iteration 7:  Log pseudolikelihood = -269.04027  

Markov-switching autoregression

Sample: 1970q2 thru 2022q2                              Number of obs =    209
Number of states = 2                                    AIC           = 2.6320
Unconditional probabilities: transition                 HQIC          = 2.6708
                                                        SBIC          = 2.7279
Log likelihood = -269.04027

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |     .91635   .1904894     4.81   0.000     .5429976    1.289702
             |
       _cons |    2.12251   14.52444     0.15   0.884    -26.34487    30.58989
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   4.291915   14.63701     0.29   0.769    -24.39609    32.97992
-------------+----------------------------------------------------------------
       sigma |   .7241502   .0563621                      .6216958     .843489
-------------+----------------------------------------------------------------
         p11 |   .4824399   .1300154                       .251462    .7211738
-------------+----------------------------------------------------------------
         p21 |   .0489065   .0213867                       .020455    .1123916
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    0.19
         Prob > chi2 =    0.6606

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .33028293

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 209         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .4824399   .1300154       .251462    .7211738
-----------------------------+------------------------------------------------
                         p12 |   .5175601   .1300154      .2788262     .748538
-----------------------------+------------------------------------------------
                         p21 |   .0489065   .0213867       .020455    .1123916
-----------------------------+------------------------------------------------
                         p22 |   .9510935   .0213867      .8876084     .979545
------------------------------------------------------------------------------

. estat duration

Number of obs = 209         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   1.932143   .4853703      1.335937    3.586463
-----------------------------+------------------------------------------------
                      State2 |   20.44718   8.941507      8.897461    48.88789
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_34.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_ITA.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==35
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -124.7139  
Iteration 1:  Log pseudolikelihood = -124.39435  
Iteration 2:  Log pseudolikelihood = -123.95802  
Iteration 3:  Log pseudolikelihood = -123.94659  
Iteration 4:  Log pseudolikelihood = -123.94651  
Iteration 5:  Log pseudolikelihood = -123.94651  

Markov-switching autoregression

Sample: 1977q2 thru 2022q3                              Number of obs =    182
Number of states = 2                                    AIC           = 1.4500
Unconditional probabilities: transition                 HQIC          = 1.5071
                                                        SBIC          = 1.5908
Log likelihood = -123.94651

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9406931   .0848218    11.09   0.000     .7744453    1.106941
             |
       _cons |   2.110022   .5288928     3.99   0.000     1.073411    3.146632
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9142885    .024049    38.02   0.000     .8671534    .9614237
             |
       _cons |   3.142028   .4433699     7.09   0.000     2.273039    4.011017
-------------+----------------------------------------------------------------
      sigma1 |   .8028329   .0758246                      .6671635    .9660909
-------------+----------------------------------------------------------------
      sigma2 |   .3514084   .0207113                      .3130719    .3944394
-------------+----------------------------------------------------------------
         p11 |   .9307343   .0438897                      .7796594    .9807794
-------------+----------------------------------------------------------------
         p21 |   .0257119   .0125122                      .0098177    .0656323
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -128.34027  
Iteration 1:  Log pseudolikelihood = -127.81861  
Iteration 2:  Log pseudolikelihood = -127.72627  
Iteration 3:  Log pseudolikelihood = -127.72604  
Iteration 4:  Log pseudolikelihood = -127.72604  

Markov-switching autoregression

Sample: 1977q2 thru 2022q3                              Number of obs =    182
Number of states = 2                                    AIC           = 1.4805
Unconditional probabilities: transition                 HQIC          = 1.5305
                                                        SBIC          = 1.6037
Log likelihood = -127.72604

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8928458   .0759497    11.76   0.000     .7439871    1.041705
             |
       _cons |   .5769438   2.385881     0.24   0.809    -4.099296    5.253184
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   1.724261   2.545044     0.68   0.498    -3.263933    6.712454
-------------+----------------------------------------------------------------
      sigma1 |   .7871789    .091289                      .6271332    .9880687
-------------+----------------------------------------------------------------
      sigma2 |   .3736836   .0380697                      .3060457      .45627
-------------+----------------------------------------------------------------
         p11 |   .9309447   .0662562                      .6413622    .9902559
-------------+----------------------------------------------------------------
         p21 |   .0234915   .0208265                      .0040428    .1247797
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    1.99
         Prob > chi2 =    0.1583

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .07914341

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 182         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9309447   .0662562      .6413622    .9902559
-----------------------------+------------------------------------------------
                         p12 |   .0690553   .0662562      .0097441    .3586378
-----------------------------+------------------------------------------------
                         p21 |   .0234915   .0208265      .0040428    .1247797
-----------------------------+------------------------------------------------
                         p22 |   .9765085   .0208265      .8752203    .9959572
------------------------------------------------------------------------------

. estat duration

Number of obs = 182         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   14.48115   13.89417      2.788328    102.6264
-----------------------------+------------------------------------------------
                      State2 |   42.56862   37.73948      8.014124    247.3529
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_35.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_JPN.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==36
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -293.25612  
Iteration 1:  Log pseudolikelihood = -293.02924  (backed up)
Iteration 2:  Log pseudolikelihood = -292.73199  
Iteration 3:  Log pseudolikelihood = -292.34905  
Iteration 4:  Log pseudolikelihood = -292.15764  
Iteration 5:  Log pseudolikelihood =  -292.1537  
Iteration 6:  Log pseudolikelihood = -292.15369  

Markov-switching autoregression

Sample: 1995q2 thru 2020q1                              Number of obs =    100
Number of states = 2                                    AIC           = 6.0031
Unconditional probabilities: transition                 HQIC          = 6.0874
                                                        SBIC          = 6.2115
Log likelihood = -292.15369

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .6761492   .0798248     8.47   0.000     .5196955    .8326028
             |
       _cons |    -4.4803   .8066264    -5.55   0.000    -6.061259   -2.899341
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .3268189   .1160043     2.82   0.005     .0994546    .5541832
             |
       _cons |   .9034017   1.039319     0.87   0.385    -1.133626     2.94043
-------------+----------------------------------------------------------------
      sigma1 |   2.342396   .5202582                      1.515668    3.620067
-------------+----------------------------------------------------------------
      sigma2 |   4.616751   .5316675                      3.683932    5.785772
-------------+----------------------------------------------------------------
         p11 |    .561273   .1423447                      .2918024    .7988796
-------------+----------------------------------------------------------------
         p21 |   .3642982   .2067178                      .0906056    .7672324
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch 

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -293.25612  
Iteration 1:  Log pseudolikelihood = -293.02924  (backed up)
Iteration 2:  Log pseudolikelihood = -292.73199  
Iteration 3:  Log pseudolikelihood = -292.34905  
Iteration 4:  Log pseudolikelihood = -292.15764  
Iteration 5:  Log pseudolikelihood =  -292.1537  
Iteration 6:  Log pseudolikelihood = -292.15369  

Markov-switching autoregression

Sample: 1995q2 thru 2020q1                              Number of obs =    100
Number of states = 2                                    AIC           = 6.0031
Unconditional probabilities: transition                 HQIC          = 6.0874
                                                        SBIC          = 6.2115
Log likelihood = -292.15369

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .6761492   .0798248     8.47   0.000     .5196955    .8326028
             |
       _cons |    -4.4803   .8066264    -5.55   0.000    -6.061259   -2.899341
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .3268189   .1160043     2.82   0.005     .0994546    .5541832
             |
       _cons |   .9034017   1.039319     0.87   0.385    -1.133626     2.94043
-------------+----------------------------------------------------------------
      sigma1 |   2.342396   .5202582                      1.515668    3.620067
-------------+----------------------------------------------------------------
      sigma2 |   4.616751   .5316675                      3.683932    5.785772
-------------+----------------------------------------------------------------
         p11 |    .561273   .1423447                      .2918024    .7988796
-------------+----------------------------------------------------------------
         p21 |   .3642982   .2067178                      .0906056    .7672324
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   16.46
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .00002485

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   33.68
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = 3.256e-09

. 
. *ereturn list
. 
. estat transition

Number of obs = 100         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |    .561273   .1423447      .2918024    .7988796
-----------------------------+------------------------------------------------
                         p12 |    .438727   .1423447      .2011204    .7081976
-----------------------------+------------------------------------------------
                         p21 |   .3642982   .2067178      .0906056    .7672324
-----------------------------+------------------------------------------------
                         p22 |   .6357018   .2067178      .2327676    .9093944
------------------------------------------------------------------------------

. estat duration

Number of obs = 100         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   2.279322   .7395244      1.412035    4.972145
-----------------------------+------------------------------------------------
                      State2 |   2.745004   1.557628      1.303386    11.03685
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_36.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_KAZ.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==37
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -412.1531  (not concave)
Iteration 1:  Log pseudolikelihood = -410.05307  (not concave)
Iteration 2:  Log pseudolikelihood = -406.79341  
Iteration 3:  Log pseudolikelihood =  -405.7059  
Iteration 4:  Log pseudolikelihood = -405.52102  
Iteration 5:  Log pseudolikelihood = -405.52011  
Iteration 6:  Log pseudolikelihood = -405.52011  

Markov-switching autoregression

Sample: 1993q2 thru 2021q4                              Number of obs =    115
Number of states = 2                                    AIC           = 7.1917
Unconditional probabilities: transition                 HQIC          = 7.2692
                                                        SBIC          = 7.3826
Log likelihood = -405.52011

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3403125   .0866822     3.93   0.000     .1704185    .5102065
             |
       _cons |  -11.34369   1.568804    -7.23   0.000    -14.41849   -8.268894
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |  -.1344857    .203974    -0.66   0.510    -.5342673    .2652959
             |
       _cons |  -1.514143   .7915965    -1.91   0.056    -3.065644    .0373574
-------------+----------------------------------------------------------------
      sigma1 |   9.362608   .7623529                      7.981555    10.98262
-------------+----------------------------------------------------------------
      sigma2 |   3.531226   .6415005                      2.473386    5.041492
-------------+----------------------------------------------------------------
         p11 |   .9859365   .0157468                      .8833097    .9984622
-------------+----------------------------------------------------------------
         p21 |   .0583684   .0581231                      .0077403    .3300118
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch 

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -412.1531  (not concave)
Iteration 1:  Log pseudolikelihood = -410.05307  (not concave)
Iteration 2:  Log pseudolikelihood = -406.79341  
Iteration 3:  Log pseudolikelihood =  -405.7059  
Iteration 4:  Log pseudolikelihood = -405.52102  
Iteration 5:  Log pseudolikelihood = -405.52011  
Iteration 6:  Log pseudolikelihood = -405.52011  

Markov-switching autoregression

Sample: 1993q2 thru 2021q4                              Number of obs =    115
Number of states = 2                                    AIC           = 7.1917
Unconditional probabilities: transition                 HQIC          = 7.2692
                                                        SBIC          = 7.3826
Log likelihood = -405.52011

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3403125   .0866822     3.93   0.000     .1704185    .5102065
             |
       _cons |  -11.34369   1.568804    -7.23   0.000    -14.41849   -8.268894
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |  -.1344857    .203974    -0.66   0.510    -.5342673    .2652959
             |
       _cons |  -1.514143   .7915965    -1.91   0.056    -3.065644    .0373574
-------------+----------------------------------------------------------------
      sigma1 |   9.362608   .7623529                      7.981555    10.98262
-------------+----------------------------------------------------------------
      sigma2 |   3.531226   .6415005                      2.473386    5.041492
-------------+----------------------------------------------------------------
         p11 |   .9859365   .0157468                      .8833097    .9984622
-------------+----------------------------------------------------------------
         p21 |   .0583684   .0581231                      .0077403    .3300118
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   57.92
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 1.366e-14

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   30.93
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = 1.334e-08

. 
. *ereturn list
. 
. estat transition

Number of obs = 115         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9859365   .0157468      .8833097    .9984622
-----------------------------+------------------------------------------------
                         p12 |   .0140635   .0157468      .0015378    .1166903
-----------------------------+------------------------------------------------
                         p21 |   .0583684   .0581231      .0077403    .3300118
-----------------------------+------------------------------------------------
                         p22 |   .9416316   .0581231      .6699882    .9922597
------------------------------------------------------------------------------

. estat duration

Number of obs = 115         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   71.10586   79.61646      8.569694    650.2775
-----------------------------+------------------------------------------------
                      State2 |   17.13256   17.06057      3.030195    129.1944
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_37.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_KGZ.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==38
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. replace cab = l.cab in 253 
(1 real change made)

. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -297.14241  (not concave)
Iteration 1:  Log pseudolikelihood = -297.08952  (not concave)
Iteration 2:  Log pseudolikelihood = -297.01303  (not concave)
Iteration 3:  Log pseudolikelihood = -296.85887  (not concave)
Iteration 4:  Log pseudolikelihood = -296.84415  (not concave)
Iteration 5:  Log pseudolikelihood = -296.84035  (not concave)
Iteration 6:  Log pseudolikelihood = -296.83841  (not concave)
Iteration 7:  Log pseudolikelihood = -296.83743  (not concave)
Iteration 8:  Log pseudolikelihood = -296.83684  (not concave)
Iteration 9:  Log pseudolikelihood = -296.83634  (not concave)
Iteration 10: Log pseudolikelihood = -296.83543  (not concave)
Iteration 11: Log pseudolikelihood = -296.83475  (not concave)
Iteration 12: Log pseudolikelihood = -296.83408  (not concave)
Iteration 13: Log pseudolikelihood = -296.83338  (not concave)
Iteration 14: Log pseudolikelihood = -296.82935  (not concave)
Iteration 15: Log pseudolikelihood = -296.81722  (not concave)
Iteration 16: Log pseudolikelihood = -296.80694  (not concave)
Iteration 17: Log pseudolikelihood = -296.79488  (not concave)
Iteration 18: Log pseudolikelihood = -296.78441  
Iteration 19: Log pseudolikelihood =  -296.7545  
Iteration 20: Log pseudolikelihood = -296.74508  
Iteration 21: Log pseudolikelihood = -296.74503  
Iteration 22: Log pseudolikelihood = -296.74503  

Markov-switching autoregression

Sample: 1993q2 thru 2022q2                              Number of obs =    117
Number of states = 2                                    AIC           = 5.2093
Unconditional probabilities: transition                 HQIC          = 5.2860
                                                        SBIC          = 5.3982
Log likelihood = -296.74503

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .7691422   .0858308     8.96   0.000     .6009169    .9373675
             |
       _cons |  -4.976775   2.938759    -1.69   0.090    -10.73664     .783086
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   1.059302   .2125619     4.98   0.000     .6426889    1.475916
             |
       _cons |  -3.907289   3.196388    -1.22   0.222     -10.1721    2.357517
-------------+----------------------------------------------------------------
      sigma1 |   2.177703   .6397961                      1.224392    3.873259
-------------+----------------------------------------------------------------
      sigma2 |   3.897813   .9968634                      2.361167    6.434508
-------------+----------------------------------------------------------------
         p11 |   .6920572   .2929816                       .131846    .9708083
-------------+----------------------------------------------------------------
         p21 |   .5761821   .5410701                       .017368    .9905275
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -297.56764  (not concave)
Iteration 1:  Log pseudolikelihood =  -296.9238  
Iteration 2:  Log pseudolikelihood = -296.85856  
Iteration 3:  Log pseudolikelihood = -296.79596  
Iteration 4:  Log pseudolikelihood = -296.79488  
Iteration 5:  Log pseudolikelihood = -296.79488  

Markov-switching autoregression

Sample: 1993q2 thru 2022q2                              Number of obs =    117
Number of states = 2                                    AIC           = 5.1931
Unconditional probabilities: transition                 HQIC          = 5.2602
                                                        SBIC          = 5.3583
Log likelihood = -296.79488

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .7652838   .1201204     6.37   0.000     .5298521    1.000716
             |
       _cons |  -4.698505   2.393674    -1.96   0.050     -9.39002   -.0069903
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   -3.59561   2.530384    -1.42   0.155    -8.555071     1.36385
-------------+----------------------------------------------------------------
      sigma1 |   2.082605   .7059653                       1.07168    4.047145
-------------+----------------------------------------------------------------
      sigma2 |   3.941289   1.292686                      2.072319    7.495836
-------------+----------------------------------------------------------------
         p11 |    .701337   .5397633                      .0148188    .9972797
-------------+----------------------------------------------------------------
         p21 |   .4557171   .3264796                      .0596709    .9169943
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    3.82
         Prob > chi2 =    0.0507

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .02535019

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 117         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |    .701337   .5397633      .0148188    .9972797
-----------------------------+------------------------------------------------
                         p12 |    .298663   .5397633      .0027203    .9851812
-----------------------------+------------------------------------------------
                         p21 |   .4557171   .3264796      .0596709    .9169943
-----------------------------+------------------------------------------------
                         p22 |   .5442829   .3264796      .0830057    .9403291
------------------------------------------------------------------------------

. estat duration

Number of obs = 117         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   3.348256   6.051187      1.015042    367.6019
-----------------------------+------------------------------------------------
                      State2 |   2.194344   1.572046      1.090519    16.75859
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_38.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_LVA.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==39
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. *replace cab = l.cab in 253 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -297.24257  (not concave)
Iteration 1:  Log pseudolikelihood = -285.59738  (not concave)
Iteration 2:  Log pseudolikelihood = -285.05189  (not concave)
Iteration 3:  Log pseudolikelihood = -284.15883  
Iteration 4:  Log pseudolikelihood = -283.56218  
Iteration 5:  Log pseudolikelihood = -283.53926  
Iteration 6:  Log pseudolikelihood = -283.53923  

Markov-switching autoregression

Sample: 1993q2 thru 2022q2                              Number of obs =    117
Number of states = 2                                    AIC           = 4.9665
Unconditional probabilities: transition                 HQIC          = 5.0336
                                                        SBIC          = 5.1317
Log likelihood = -283.53923

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9409321   .0873367    10.77   0.000     .7697553    1.112109
             |
       _cons |  -3.453718   3.625805    -0.95   0.341    -10.56017    3.652729
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |  -.2401944   .5568246    -0.43   0.666    -1.331551    .8511618
             |
       _cons |   .3496955   2.163976     0.16   0.872    -3.891619     4.59101
-------------+----------------------------------------------------------------
       sigma |   2.321309   .1875188                      1.981398    2.719533
-------------+----------------------------------------------------------------
         p11 |   .9516386    .044459                      .7476481    .9924066
-------------+----------------------------------------------------------------
         p21 |    .614264   .2490375                      .1687195    .9258947
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -297.47763  (not concave)
Iteration 1:  Log pseudolikelihood = -286.16702  
Iteration 2:  Log pseudolikelihood = -285.26947  
Iteration 3:  Log pseudolikelihood =  -284.3611  
Iteration 4:  Log pseudolikelihood = -284.28539  
Iteration 5:  Log pseudolikelihood = -284.28509  
Iteration 6:  Log pseudolikelihood = -284.28509  

Markov-switching autoregression

Sample: 1993q2 thru 2022q2                              Number of obs =    117
Number of states = 2                                    AIC           = 4.9621
Unconditional probabilities: transition                 HQIC          = 5.0196
                                                        SBIC          = 5.1038
Log likelihood = -284.28509

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -2.624139   2.667625    -0.98   0.325    -7.852588    2.604311
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |  -.1562888   .3306561    -0.47   0.636    -.8043628    .4917852
             |
       _cons |   .6613119   2.208065     0.30   0.765    -3.666416     4.98904
-------------+----------------------------------------------------------------
       sigma |   2.296388   .2132205                      1.914304    2.754734
-------------+----------------------------------------------------------------
         p11 |   .9389208    .032919                      .8330653    .9793184
-------------+----------------------------------------------------------------
         p21 |   .5511348   .3894026                      .0531576    .9640975
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   12.23
         Prob > chi2 =    0.0005

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .0002353

. 
. *ereturn list
. 
. estat transition

Number of obs = 117         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9389208    .032919      .8330653    .9793184
-----------------------------+------------------------------------------------
                         p12 |   .0610792    .032919      .0206816    .1669347
-----------------------------+------------------------------------------------
                         p21 |   .5511348   .3894026      .0531576    .9640975
-----------------------------+------------------------------------------------
                         p22 |   .4488652   .3894026      .0359025    .9468424
------------------------------------------------------------------------------

. estat duration

Number of obs = 117         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   16.37219   8.823887      5.990365     48.3521
-----------------------------+------------------------------------------------
                      State2 |   1.814438   1.281986       1.03724    18.81198
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_39.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_LTU.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==40
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. *replace cab = l.cab in 253 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -389.02189  (not concave)
Iteration 1:  Log pseudolikelihood =  -386.4071  
Iteration 2:  Log pseudolikelihood = -385.98732  
Iteration 3:  Log pseudolikelihood = -385.83755  
Iteration 4:  Log pseudolikelihood = -385.80229  
Iteration 5:  Log pseudolikelihood = -385.79383  
Iteration 6:  Log pseudolikelihood =  -385.7919  
Iteration 7:  Log pseudolikelihood =  -385.7915  
Iteration 8:  Log pseudolikelihood = -385.79143  
Iteration 9:  Log pseudolikelihood = -385.79142  

Markov-switching autoregression

Sample: 1995q2 thru 2022q2                              Number of obs =    109
Number of states = 2                                    AIC           = 7.2072
Unconditional probabilities: transition                 HQIC          = 7.2773
                                                        SBIC          = 7.3800
Log likelihood = -385.79142

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |  -.3713109   .1296151    -2.86   0.004    -.6253519   -.1172699
             |
       _cons |   5.660591   .9503999     5.96   0.000     3.797841     7.52334
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |     .53364   .1009005     5.29   0.000     .3358787    .7314013
             |
       _cons |    7.32998    1.12666     6.51   0.000     5.121767    9.538192
-------------+----------------------------------------------------------------
       sigma |   7.976501   1.113517                      6.067152    10.48673
-------------+----------------------------------------------------------------
         p11 |   4.94e-07   1.09e-06                      6.54e-09    .0000373
-------------+----------------------------------------------------------------
         p21 |   .8925226   .2391539                      .0589876    .9990918
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -394.95111  (not concave)
Iteration 1:  Log pseudolikelihood = -392.49202  
Iteration 2:  Log pseudolikelihood = -391.40234  
Iteration 3:  Log pseudolikelihood = -391.27163  
Iteration 4:  Log pseudolikelihood = -391.21435  
Iteration 5:  Log pseudolikelihood = -391.20149  
Iteration 6:  Log pseudolikelihood =   -391.198  
Iteration 7:  Log pseudolikelihood = -391.19724  
Iteration 8:  Log pseudolikelihood = -391.19706  
Iteration 9:  Log pseudolikelihood = -391.19703  

Markov-switching autoregression

Sample: 1995q2 thru 2022q2                              Number of obs =    109
Number of states = 2                                    AIC           = 7.2880
Unconditional probabilities: transition                 HQIC          = 7.3481
                                                        SBIC          = 7.4362
Log likelihood = -391.19703

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   -.255272   .2661584    -0.96   0.338    -.7769329     .266389
             |
       _cons |    5.61474   .7887491     7.12   0.000      4.06882     7.16066
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   8.284666    2.49477     3.32   0.001     3.395006    13.17433
-------------+----------------------------------------------------------------
       sigma |   8.087676   1.024028                      6.310272    10.36572
-------------+----------------------------------------------------------------
         p11 |   .4061421   .4431153                      .0183288    .9616135
-------------+----------------------------------------------------------------
         p21 |    .999999   1.81e-06                      .9999622           1
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   22.24
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 1.201e-06

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 109         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .4061421   .4431153      .0183288    .9616135
-----------------------------+------------------------------------------------
                         p12 |   .5938579   .4431153      .0383865    .9816712
-----------------------------+------------------------------------------------
                         p21 |    .999999   1.81e-06      .9999622           1
-----------------------------+------------------------------------------------
                         p22 |   9.66e-07   1.81e-06      2.47e-08    .0000378
------------------------------------------------------------------------------

. estat duration

Number of obs = 109         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   1.683904   1.256469      1.018671    26.05083
-----------------------------+------------------------------------------------
                      State2 |   1.000001   1.81e-06             1    1.000038
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_40.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_LUX.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==41
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. *replace cab = l.cab in 253 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -153.14613  
Iteration 1:  Log pseudolikelihood = -151.35027  (not concave)
Iteration 2:  Log pseudolikelihood = -151.31691  
Iteration 3:  Log pseudolikelihood = -151.12744  
Iteration 4:  Log pseudolikelihood = -150.69141  
Iteration 5:  Log pseudolikelihood = -150.63816  
Iteration 6:  Log pseudolikelihood = -150.63778  
Iteration 7:  Log pseudolikelihood = -150.63778  

Markov-switching autoregression

Sample: 1999q2 thru 2020q1                              Number of obs =     84
Number of states = 2                                    AIC           = 3.7771
Unconditional probabilities: transition                 HQIC          = 3.8702
                                                        SBIC          = 4.0086
Log likelihood = -150.63778

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9985222   .0285196    35.01   0.000     .9426248     1.05442
             |
       _cons |   8.464928   3.061175     2.77   0.006     2.465134    14.46472
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .8838821   .0765007    11.55   0.000     .7339436    1.033821
             |
       _cons |   9.684595   3.201189     3.03   0.002     3.410379    15.95881
-------------+----------------------------------------------------------------
      sigma1 |   .8295771   .1428191                      .5919906    1.162515
-------------+----------------------------------------------------------------
      sigma2 |   1.790048   .1443255                      1.528393    2.096496
-------------+----------------------------------------------------------------
         p11 |   .9827459   .0138534                      .9199013    .9964724
-------------+----------------------------------------------------------------
         p21 |   .0118793     .00979                       .002339    .0580672
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -153.15947  (not concave)
Iteration 1:  Log pseudolikelihood = -151.51261  (not concave)
Iteration 2:  Log pseudolikelihood = -151.32884  
Iteration 3:  Log pseudolikelihood = -150.76973  
Iteration 4:  Log pseudolikelihood = -150.64104  
Iteration 5:  Log pseudolikelihood = -150.63891  
Iteration 6:  Log pseudolikelihood = -150.63891  

Markov-switching autoregression

Sample: 1999q2 thru 2020q1                              Number of obs =     84
Number of states = 2                                    AIC           = 3.7533
Unconditional probabilities: transition                 HQIC          = 3.8347
                                                        SBIC          = 3.9559
Log likelihood = -150.63891

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   8.499582   2.727064     3.12   0.002     3.154635    13.84453
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .8835402   .0746884    11.83   0.000     .7371535    1.029927
             |
       _cons |   9.709498   2.963282     3.28   0.001     3.901571    15.51742
-------------+----------------------------------------------------------------
      sigma1 |   .8298289   .1414313                      .5941754    1.158944
-------------+----------------------------------------------------------------
      sigma2 |   1.790072   .1444475                      1.528213      2.0968
-------------+----------------------------------------------------------------
         p11 |   .9827546   .0138384                      .9200086    .9964708
-------------+----------------------------------------------------------------
         p21 |   .0118756   .0098331                      .0023204    .0584721
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    2.43
         Prob > chi2 =    0.1189

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .05946564

. 
. *ereturn list
. 
. estat transition

Number of obs = 84          
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9827546   .0138384      .9200086    .9964708
-----------------------------+------------------------------------------------
                         p12 |   .0172454   .0138384      .0035292    .0799914
-----------------------------+------------------------------------------------
                         p21 |   .0118756   .0098331      .0023204    .0584721
-----------------------------+------------------------------------------------
                         p22 |   .9881244   .0098331      .9415279    .9976796
------------------------------------------------------------------------------

. estat duration

Number of obs = 84          
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   57.98639    46.5305      12.50134    283.3539
-----------------------------+------------------------------------------------
                      State2 |   84.20646   69.72364      17.10218    430.9613
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_41.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_MYS.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==42
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. *replace cab = l.cab in 253 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -188.5293  
Iteration 1:  Log pseudolikelihood = -188.14492  (not concave)
Iteration 2:  Log pseudolikelihood =  -188.0157  (not concave)
Iteration 3:  Log pseudolikelihood = -187.26653  
Iteration 4:  Log pseudolikelihood =   -186.673  
Iteration 5:  Log pseudolikelihood = -186.42728  
Iteration 6:  Log pseudolikelihood =  -186.4215  
Iteration 7:  Log pseudolikelihood = -186.42149  

Markov-switching autoregression

Sample: 2000q2 thru 2020q1                              Number of obs =     80
Number of states = 2                                    AIC           = 4.8355
Unconditional probabilities: transition                 HQIC          = 4.9191
                                                        SBIC          = 5.0440
Log likelihood = -186.42149

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .4359712   .0845451     5.16   0.000     .2702659    .6016765
             |
       _cons |  -4.529346    1.50829    -3.00   0.003    -7.485539   -1.573153
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |    1.04829   .0455364    23.02   0.000     .9590405     1.13754
             |
       _cons |  -7.708515   3.119735    -2.47   0.013    -13.82308   -1.593947
-------------+----------------------------------------------------------------
       sigma |   1.822118   .4281263                      1.149681    2.887856
-------------+----------------------------------------------------------------
         p11 |   .5989672    .647596                       .007518    .9966158
-------------+----------------------------------------------------------------
         p21 |   .2582572   .1134391                      .0983488    .5263788
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -188.54662  
Iteration 1:  Log pseudolikelihood = -188.15378  (not concave)
Iteration 2:  Log pseudolikelihood =  -188.1524  
Iteration 3:  Log pseudolikelihood = -187.19198  
Iteration 4:  Log pseudolikelihood = -186.83055  
Iteration 5:  Log pseudolikelihood =  -186.8166  
Iteration 6:  Log pseudolikelihood = -186.81656  
Iteration 7:  Log pseudolikelihood = -186.81656  

Markov-switching autoregression

Sample: 2000q2 thru 2020q1                              Number of obs =     80
Number of states = 2                                    AIC           = 4.8204
Unconditional probabilities: transition                 HQIC          = 4.8920
                                                        SBIC          = 4.9991
Log likelihood = -186.81656

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .4213801   .0974658     4.32   0.000     .2303507    .6124095
             |
       _cons |  -4.336823   1.711278    -2.53   0.011    -7.690867    -.982779
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -7.217799   2.979918    -2.42   0.015    -13.05833   -1.377268
-------------+----------------------------------------------------------------
       sigma |   1.913982   .4074962                      1.260994    2.905112
-------------+----------------------------------------------------------------
         p11 |    .500904   .6450759                      .0063451    .9937003
-------------+----------------------------------------------------------------
         p21 |   .2390046    .106218                       .090895    .4966167
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   35.24
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 1.455e-09

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 80          
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |    .500904   .6450759      .0063451    .9937003
-----------------------------+------------------------------------------------
                         p12 |    .499096   .6450759      .0062997    .9936549
-----------------------------+------------------------------------------------
                         p21 |   .2390046    .106218       .090895    .4966167
-----------------------------+------------------------------------------------
                         p22 |   .7609954    .106218      .5033833     .909105
------------------------------------------------------------------------------

. estat duration

Number of obs = 80          
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   2.003623    2.58966      1.006386    158.7379
-----------------------------+------------------------------------------------
                      State2 |   4.184021   1.859456      2.013625    11.00171
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_42.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_MUS.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==43
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. *replace cab = l.cab in 253 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -277.09065  
Iteration 1:  Log pseudolikelihood = -276.88155  
Iteration 2:  Log pseudolikelihood = -276.82406  
Iteration 3:  Log pseudolikelihood = -276.82382  
Iteration 4:  Log pseudolikelihood = -276.82382  

Markov-switching autoregression

Sample: 1979q2 thru 2022q2                              Number of obs =    173
Number of states = 2                                    AIC           = 3.2812
Unconditional probabilities: transition                 HQIC          = 3.3330
                                                        SBIC          = 3.4088
Log likelihood = -276.82382

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   1.004994    .036044    27.88   0.000     .9343494    1.075639
             |
       _cons |  -.0606648   .9779533    -0.06   0.951    -1.977418    1.856089
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .1482168   .1174164     1.26   0.207    -.0819151    .3783487
             |
       _cons |  -.5669081   .6682495    -0.85   0.396    -1.876653    .7428369
-------------+----------------------------------------------------------------
       sigma |   1.066888   .1488511                       .811634    1.402419
-------------+----------------------------------------------------------------
         p11 |   .9378809   .0415228                      .7887955    .9838803
-------------+----------------------------------------------------------------
         p21 |   .2922355   .2266638                      .0459824    .7795972
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -277.09133  
Iteration 1:  Log pseudolikelihood = -276.87976  
Iteration 2:  Log pseudolikelihood = -276.83432  
Iteration 3:  Log pseudolikelihood = -276.83417  
Iteration 4:  Log pseudolikelihood = -276.83417  

Markov-switching autoregression

Sample: 1979q2 thru 2022q2                              Number of obs =    173
Number of states = 2                                    AIC           = 3.2698
Unconditional probabilities: transition                 HQIC          = 3.3141
                                                        SBIC          = 3.3791
Log likelihood = -276.83417

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -.0861275   .8873008    -0.10   0.923    -1.825205     1.65295
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .1469511   .1165279     1.26   0.207    -.0814394    .3753416
             |
       _cons |  -.5738651   .6655588    -0.86   0.389    -1.878336    .7306063
-------------+----------------------------------------------------------------
       sigma |    1.06762   .1488683                      .8123173    1.403162
-------------+----------------------------------------------------------------
         p11 |   .9378073   .0417016                      .7878397    .9839309
-------------+----------------------------------------------------------------
         p21 |   .2955731   .2229734                      .0489201    .7739013
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   53.59
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = 1.235e-13

. 
. *ereturn list
. 
. estat transition

Number of obs = 173         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9378073   .0417016      .7878397    .9839309
-----------------------------+------------------------------------------------
                         p12 |   .0621927   .0417016      .0160691    .2121603
-----------------------------+------------------------------------------------
                         p21 |   .2955731   .2229734      .0489201    .7739013
-----------------------------+------------------------------------------------
                         p22 |   .7044269   .2229734      .2260987    .9510799
------------------------------------------------------------------------------

. estat duration

Number of obs = 173         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   16.07905   10.78137      4.713418    62.23141
-----------------------------+------------------------------------------------
                      State2 |   3.383258    2.55225      1.292154    20.44149
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_43.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_MEX.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==44
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. *replace cab = l.cab in 253 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -287.61983  
Iteration 1:  Log pseudolikelihood = -287.57135  
Iteration 2:  Log pseudolikelihood =  -287.5622  
Iteration 3:  Log pseudolikelihood = -287.56075  
Iteration 4:  Log pseudolikelihood = -287.56074  

Markov-switching autoregression

Sample: 1995q2 thru 2020q1                              Number of obs =    100
Number of states = 2                                    AIC           = 5.8912
Unconditional probabilities: transition                 HQIC          = 5.9650
                                                        SBIC          = 6.0736
Log likelihood = -287.56074

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   1.027396   .2001198     5.13   0.000     .6351683    1.419624
             |
       _cons |  -11.52992   7.033925    -1.64   0.101    -25.31616    2.256316
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .0546918   .1231708     0.44   0.657    -.1867184    .2961021
             |
       _cons |  -6.014773   3.848662    -1.56   0.118    -13.55801    1.528466
-------------+----------------------------------------------------------------
       sigma |   3.193216   .3529923                      2.571181    3.965737
-------------+----------------------------------------------------------------
         p11 |   .7772903   .2004532                      .2651053    .9712373
-------------+----------------------------------------------------------------
         p21 |   .4267271   1.648264                      1.37e-06    .9999975
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -287.67903  
Iteration 1:  Log pseudolikelihood = -287.59847  
Iteration 2:  Log pseudolikelihood = -287.59166  
Iteration 3:  Log pseudolikelihood = -287.59156  
Iteration 4:  Log pseudolikelihood = -287.59156  

Markov-switching autoregression

Sample: 1995q2 thru 2020q1                              Number of obs =    100
Number of states = 2                                    AIC           = 5.8718
Unconditional probabilities: transition                 HQIC          = 5.9351
                                                        SBIC          = 6.0281
Log likelihood = -287.59156

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   -11.0903   4.030798    -2.75   0.006    -18.99052   -3.190084
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .0582796   .2205553     0.26   0.792    -.3740009    .4905601
             |
       _cons |  -5.715088   3.932012    -1.45   0.146    -13.42169    1.991514
-------------+----------------------------------------------------------------
       sigma |   3.211117   .4210383                      2.483405    4.152071
-------------+----------------------------------------------------------------
         p11 |   .7705234   .1753717                      .3246083    .9591136
-------------+----------------------------------------------------------------
         p21 |   .5535195   1.857116                      4.98e-07    .9999997
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   18.23
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = 9.784e-06

. 
. *ereturn list
. 
. estat transition

Number of obs = 100         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .7705234   .1753717      .3246083    .9591136
-----------------------------+------------------------------------------------
                         p12 |   .2294766   .1753717      .0408864    .6753917
-----------------------------+------------------------------------------------
                         p21 |   .5535195   1.857116      4.98e-07    .9999997
-----------------------------+------------------------------------------------
                         p22 |   .4464805   1.857116      3.24e-07    .9999995
------------------------------------------------------------------------------

. estat duration

Number of obs = 100         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   4.357743   3.330296      1.480622      24.458
-----------------------------+------------------------------------------------
                      State2 |   1.806621   6.061402             1     2009436
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_44.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_MDA.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==45
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. *replace cab = l.cab in 253 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -380.23212  
Iteration 1:  Log pseudolikelihood = -380.04144  
Iteration 2:  Log pseudolikelihood = -380.03706  
Iteration 3:  Log pseudolikelihood = -380.03705  

Markov-switching autoregression

Sample: 1977q2 thru 2022q2                              Number of obs =    181
Number of states = 2                                    AIC           = 4.2767
Unconditional probabilities: transition                 HQIC          = 4.3268
                                                        SBIC          = 4.4004
Log likelihood = -380.03705

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |  -.7201271   .2045106    -3.52   0.000     -1.12096   -.3192937
             |
       _cons |   1.964584   .6757196     2.91   0.004     .6401981     3.28897
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .8197929   .0593183    13.82   0.000     .7035312    .9360545
             |
       _cons |   4.501121   .8445786     5.33   0.000     2.845778    6.156465
-------------+----------------------------------------------------------------
       sigma |   1.852518   .1801684                       1.53101    2.241541
-------------+----------------------------------------------------------------
         p11 |   .7876484   .2850031                      .1162009    .9905339
-------------+----------------------------------------------------------------
         p21 |   .0140398   .0086918                      .0041422    .0464832
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -380.23212  
Iteration 1:  Log pseudolikelihood = -380.04144  
Iteration 2:  Log pseudolikelihood = -380.03706  
Iteration 3:  Log pseudolikelihood = -380.03705  

Markov-switching autoregression

Sample: 1977q2 thru 2022q2                              Number of obs =    181
Number of states = 2                                    AIC           = 4.2767
Unconditional probabilities: transition                 HQIC          = 4.3268
                                                        SBIC          = 4.4004
Log likelihood = -380.03705

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |  -.7201271   .2045106    -3.52   0.000     -1.12096   -.3192937
             |
       _cons |   1.964584   .6757196     2.91   0.004     .6401981     3.28897
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .8197929   .0593183    13.82   0.000     .7035312    .9360545
             |
       _cons |   4.501121   .8445786     5.33   0.000     2.845778    6.156465
-------------+----------------------------------------------------------------
       sigma |   1.852518   .1801684                       1.53101    2.241541
-------------+----------------------------------------------------------------
         p11 |   .7876484   .2850031                      .1162009    .9905339
-------------+----------------------------------------------------------------
         p21 |   .0140398   .0086918                      .0041422    .0464832
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   70.74
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 2.034e-17

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    9.23
         Prob > chi2 =    0.0024

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .00119089

. 
. *ereturn list
. 
. estat transition

Number of obs = 181         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .7876484   .2850031      .1162009    .9905339
-----------------------------+------------------------------------------------
                         p12 |   .2123516   .2850031      .0094661    .8837991
-----------------------------+------------------------------------------------
                         p21 |   .0140398   .0086918      .0041422    .0464832
-----------------------------+------------------------------------------------
                         p22 |   .9859602   .0086918      .9535168    .9958578
------------------------------------------------------------------------------

. estat duration

Number of obs = 181         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |    4.70917   6.320309      1.131479    105.6399
-----------------------------+------------------------------------------------
                      State2 |   71.22623   44.09486      21.51314    241.4178
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_45.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_NLD.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==46
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. *replace cab = l.cab in 253 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -329.47278  
Iteration 1:  Log pseudolikelihood = -329.38646  
Iteration 2:  Log pseudolikelihood = -329.38582  
Iteration 3:  Log pseudolikelihood = -329.38582  

Markov-switching autoregression

Sample: 1980q2 thru 2022q2                              Number of obs =    169
Number of states = 2                                    AIC           = 3.9809
Unconditional probabilities: transition                 HQIC          = 4.0335
                                                        SBIC          = 4.1105
Log likelihood = -329.38582

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   1.107254   .1019209    10.86   0.000     .9074924    1.307015
             |
       _cons |  -4.054874   .7758235    -5.23   0.000     -5.57546   -2.534288
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .4925527   .0879592     5.60   0.000     .3201559    .6649495
             |
       _cons |  -3.203295    .423897    -7.56   0.000    -4.034117   -2.372472
-------------+----------------------------------------------------------------
       sigma |   1.465874   .1073499                      1.269875    1.692125
-------------+----------------------------------------------------------------
         p11 |   .6501439    .214874                      .2258546    .9220988
-------------+----------------------------------------------------------------
         p21 |    .244427   .1366644                       .070507    .5797646
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -330.99273  
Iteration 1:  Log pseudolikelihood = -330.76425  
Iteration 2:  Log pseudolikelihood = -330.76027  
Iteration 3:  Log pseudolikelihood = -330.76027  

Markov-switching autoregression

Sample: 1980q2 thru 2022q2                              Number of obs =    169
Number of states = 2                                    AIC           = 3.9853
Unconditional probabilities: transition                 HQIC          = 4.0304
                                                        SBIC          = 4.0964
Log likelihood = -330.76027

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -4.315731   .7010686    -6.16   0.000    -5.689801   -2.941662
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .4902459   .0785031     6.24   0.000     .3363827    .6441092
             |
       _cons |  -3.239736   .4520957    -7.17   0.000    -4.125828   -2.353645
-------------+----------------------------------------------------------------
       sigma |   1.495521    .127931                      1.264673    1.768506
-------------+----------------------------------------------------------------
         p11 |   .7115905   .1839181                      .2987376    .9345977
-------------+----------------------------------------------------------------
         p21 |   .2395402   .1856927                      .0409666    .6990471
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   42.16
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = 4.195e-11

. 
. *ereturn list
. 
. estat transition

Number of obs = 169         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .7115905   .1839181      .2987376    .9345977
-----------------------------+------------------------------------------------
                         p12 |   .2884095   .1839181      .0654023    .7012624
-----------------------------+------------------------------------------------
                         p21 |   .2395402   .1856927      .0409666    .6990471
-----------------------------+------------------------------------------------
                         p22 |   .7604598   .1856927      .3009529    .9590334
------------------------------------------------------------------------------

. estat duration

Number of obs = 169         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   3.467292   2.211085         1.426    15.28999
-----------------------------+------------------------------------------------
                      State2 |   4.174664   3.236219      1.430519    24.41011
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_46.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_NZL.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==47
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. *replace cab = l.cab in 253 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -440.29402  
Iteration 1:  Log pseudolikelihood = -440.13961  
Iteration 2:  Log pseudolikelihood =   -440.135  
Iteration 3:  Log pseudolikelihood =   -440.135  

Markov-switching autoregression

Sample: 1975q2 thru 2022q2                              Number of obs =    189
Number of states = 2                                    AIC           = 4.7422
Unconditional probabilities: transition                 HQIC          = 4.7978
                                                        SBIC          = 4.8794
Log likelihood = -440.135

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9667235   .1008423     9.59   0.000     .7690763    1.164371
             |
       _cons |   3.392465   2.641093     1.28   0.199    -1.783982    8.568912
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9323999   .0267955    34.80   0.000     .8798817    .9849182
             |
       _cons |   8.161019   2.477284     3.29   0.001     3.305631    13.01641
-------------+----------------------------------------------------------------
      sigma1 |   4.889516   .7363092                      3.639854    6.568222
-------------+----------------------------------------------------------------
      sigma2 |   1.990817   .1088362                      1.788533     2.21598
-------------+----------------------------------------------------------------
         p11 |   .8303671   .0751717                      .6323366     .933031
-------------+----------------------------------------------------------------
         p21 |   .0272651   .0112831                      .0120291    .0606153
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -440.3642  
Iteration 1:  Log pseudolikelihood = -440.20166  
Iteration 2:  Log pseudolikelihood = -440.20028  
Iteration 3:  Log pseudolikelihood = -440.20028  

Markov-switching autoregression

Sample: 1975q2 thru 2022q2                              Number of obs =    189
Number of states = 2                                    AIC           = 4.7323
Unconditional probabilities: transition                 HQIC          = 4.7809
                                                        SBIC          = 4.8523
Log likelihood = -440.20028

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |    3.36881   2.654849     1.27   0.204    -1.834598    8.572218
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9312657   .0263575    35.33   0.000     .8796059    .9829255
             |
       _cons |   8.116367   2.459024     3.30   0.001     3.296768    12.93597
-------------+----------------------------------------------------------------
      sigma1 |   4.906321   .7830734                      3.588392    6.708292
-------------+----------------------------------------------------------------
      sigma2 |   1.990772   .1088884                      1.788396    2.216049
-------------+----------------------------------------------------------------
         p11 |   .8315644   .0760732                      .6300064     .934702
-------------+----------------------------------------------------------------
         p21 |   .0272597   .0112782                       .012029    .0605923
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    6.80
         Prob > chi2 =    0.0091

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .00455675

. 
. *ereturn list
. 
. estat transition

Number of obs = 189         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .8315644   .0760732      .6300064     .934702
-----------------------------+------------------------------------------------
                         p12 |   .1684356   .0760732       .065298    .3699936
-----------------------------+------------------------------------------------
                         p21 |   .0272597   .0112782       .012029    .0605923
-----------------------------+------------------------------------------------
                         p22 |   .9727403   .0112782      .9394077     .987971
------------------------------------------------------------------------------

. estat duration

Number of obs = 189         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   5.936987   2.681414       2.70275     15.3144
-----------------------------+------------------------------------------------
                      State2 |   36.68413    15.1774      16.50374    83.13222
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_47.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_NOR.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==48
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. *replace cab = l.cab in 253 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -206.85959  
Iteration 1:  Log pseudolikelihood = -206.84492  
Iteration 2:  Log pseudolikelihood =  -206.8447  
Iteration 3:  Log pseudolikelihood =  -206.8447  

Markov-switching autoregression

Sample: 2000q2 thru 2020q4                              Number of obs =     83
Number of states = 2                                    AIC           = 5.1529
Unconditional probabilities: transition                 HQIC          = 5.2348
                                                        SBIC          = 5.3569
Log likelihood = -206.8447

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .1233378   .5433566     0.23   0.820    -.9416216    1.188297
             |
       _cons |  -.6078949   2.769329    -0.22   0.826     -6.03568    4.819891
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   1.026356   .1711024     6.00   0.000     .6910014     1.36171
             |
       _cons |     2.9242   4.676543     0.63   0.532    -6.241655    12.09005
-------------+----------------------------------------------------------------
       sigma |   2.205173   1.912365                      .4029634    12.06756
-------------+----------------------------------------------------------------
         p11 |   .5525962   .4858302                      .0255735    .9830871
-------------+----------------------------------------------------------------
         p21 |   .5066177   .7543701                      .0027629    .9973792
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -206.88354  
Iteration 1:  Log pseudolikelihood = -206.85778  
Iteration 2:  Log pseudolikelihood = -206.85743  
Iteration 3:  Log pseudolikelihood = -206.85743  

Markov-switching autoregression

Sample: 2000q2 thru 2020q4                              Number of obs =     83
Number of states = 2                                    AIC           = 5.1291
Unconditional probabilities: transition                 HQIC          = 5.1993
                                                        SBIC          = 5.3040
Log likelihood = -206.85743

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .1200978   .6982032     0.17   0.863    -1.248355    1.488551
             |
       _cons |    -.60634   3.130377    -0.19   0.846    -6.741766    5.529086
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   2.878196   6.322317     0.46   0.649    -9.513317    15.26971
-------------+----------------------------------------------------------------
       sigma |   2.224379   2.352418                      .2799053    17.67692
-------------+----------------------------------------------------------------
         p11 |   .5401002    .699426                      .0046875    .9965968
-------------+----------------------------------------------------------------
         p21 |   .5037895   .8649709                      .0011504    .9988839
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    1.59
         Prob > chi2 =    0.2076

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .10379176

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 83          
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .5401002    .699426      .0046875    .9965968
-----------------------------+------------------------------------------------
                         p12 |   .4598998    .699426      .0034032    .9953125
-----------------------------+------------------------------------------------
                         p21 |   .5037895   .8649709      .0011504    .9988839
-----------------------------+------------------------------------------------
                         p22 |   .4962105   .8649709      .0011161    .9988496
------------------------------------------------------------------------------

. estat duration

Number of obs = 83          
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   2.174387   3.306856       1.00471    293.8449
-----------------------------+------------------------------------------------
                      State2 |   1.984956   3.408029      1.001117     869.249
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_48.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_PRY.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==49
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. *replace cab = l.cab in 253 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -305.17561  (not concave)
Iteration 1:  Log pseudolikelihood = -303.74744  
Iteration 2:  Log pseudolikelihood = -303.51498  
Iteration 3:  Log pseudolikelihood =   -303.414  
Iteration 4:  Log pseudolikelihood = -303.41361  
Iteration 5:  Log pseudolikelihood = -303.41361  

Markov-switching autoregression

Sample: 1979q2 thru 2020q1                              Number of obs =    164
Number of states = 2                                    AIC           = 3.7855
Unconditional probabilities: transition                 HQIC          = 3.8392
                                                        SBIC          = 3.9178
Log likelihood = -303.41361

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   1.061292   .0473163    22.43   0.000     .9685536     1.15403
             |
       _cons |  -4.451215   1.165212    -3.82   0.000    -6.734989    -2.16744
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .6238217   .0529416    11.78   0.000     .5200582    .7275853
             |
       _cons |  -3.461935   .9208723    -3.76   0.000    -5.266812   -1.657059
-------------+----------------------------------------------------------------
       sigma |   1.300193   .1294601                      1.069679    1.580381
-------------+----------------------------------------------------------------
         p11 |   .6890192   .1380612                      .3852506    .8867933
-------------+----------------------------------------------------------------
         p21 |    .687597   .1529772                      .3527669    .8988687
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -306.59399  (not concave)
Iteration 1:  Log pseudolikelihood = -304.53936  
Iteration 2:  Log pseudolikelihood = -304.25372  
Iteration 3:  Log pseudolikelihood = -304.03944  
Iteration 4:  Log pseudolikelihood = -304.03871  
Iteration 5:  Log pseudolikelihood = -304.03871  

Markov-switching autoregression

Sample: 1979q2 thru 2020q1                              Number of obs =    164
Number of states = 2                                    AIC           = 3.7810
Unconditional probabilities: transition                 HQIC          = 3.8270
                                                        SBIC          = 3.8944
Log likelihood = -304.03871

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -4.264724   1.174106    -3.63   0.000     -6.56593   -1.963519
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .6101801   .0654709     9.32   0.000     .4818596    .7385007
             |
       _cons |  -3.329163   .9357845    -3.56   0.000    -5.163267   -1.495059
-------------+----------------------------------------------------------------
       sigma |   1.351369   .1228117                      1.130882    1.614845
-------------+----------------------------------------------------------------
         p11 |    .744121    .129627                      .4336838    .9169671
-------------+----------------------------------------------------------------
         p21 |   .7428524   .1859077                      .3001391    .9511227
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   35.45
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = 1.308e-09

. 
. *ereturn list
. 
. estat transition

Number of obs = 164         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |    .744121    .129627      .4336838    .9169671
-----------------------------+------------------------------------------------
                         p12 |    .255879    .129627      .0830329    .5663162
-----------------------------+------------------------------------------------
                         p21 |   .7428524   .1859077      .3001391    .9511227
-----------------------------+------------------------------------------------
                         p22 |   .2571476   .1859077      .0488773    .6998609
------------------------------------------------------------------------------

. estat duration

Number of obs = 164         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   3.908098   1.979822      1.765798    12.04343
-----------------------------+------------------------------------------------
                      State2 |   1.346162   .3368933      1.051389    3.331788
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_49.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_PER.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==50
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. replace cab = l.cab in 91
(1 real change made)

. replace cab = l.cab in 93 
(1 real change made)

. replace cab = l.cab in 95
(1 real change made)

. replace cab = l.cab in 97
(1 real change made)

. replace cab = l.cab in 99
(1 real change made)

. replace cab = l.cab in 101
(1 real change made)

. replace cab = l.cab in 103
(1 real change made)

. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -403.55258  (not concave)
Iteration 1:  Log pseudolikelihood = -403.18066  (not concave)
Iteration 2:  Log pseudolikelihood = -402.57097  (not concave)
Iteration 3:  Log pseudolikelihood = -400.70541  
Iteration 4:  Log pseudolikelihood = -400.37594  
Iteration 5:  Log pseudolikelihood = -399.14162  
Iteration 6:  Log pseudolikelihood = -399.02448  
Iteration 7:  Log pseudolikelihood =  -399.0241  
Iteration 8:  Log pseudolikelihood =  -399.0241  

Markov-switching autoregression

Sample: 1977q3 thru 2020q1                              Number of obs =    171
Number of states = 2                                    AIC           = 4.7488
Unconditional probabilities: transition                 HQIC          = 4.8010
                                                        SBIC          = 4.8774
Log likelihood = -399.0241

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8484469   .0514577    16.49   0.000     .7475917    .9493022
             |
       _cons |   -1.11845   .9154994    -1.22   0.222    -2.912795     .675896
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .5637135   .2105782     2.68   0.007     .1509877    .9764392
             |
       _cons |   3.253597    .982925     3.31   0.001     1.327099    5.180095
-------------+----------------------------------------------------------------
       sigma |   2.007462   .1484978                      1.736527    2.320669
-------------+----------------------------------------------------------------
         p11 |   .9101266    .031411                      .8267153    .9555464
-------------+----------------------------------------------------------------
         p21 |   .7040085   .1585057                      .3487822     .913514
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -403.55258  (not concave)
Iteration 1:  Log pseudolikelihood = -403.18066  (not concave)
Iteration 2:  Log pseudolikelihood = -402.57097  (not concave)
Iteration 3:  Log pseudolikelihood = -400.70541  
Iteration 4:  Log pseudolikelihood = -400.37594  
Iteration 5:  Log pseudolikelihood = -399.14162  
Iteration 6:  Log pseudolikelihood = -399.02448  
Iteration 7:  Log pseudolikelihood =  -399.0241  
Iteration 8:  Log pseudolikelihood =  -399.0241  

Markov-switching autoregression

Sample: 1977q3 thru 2020q1                              Number of obs =    171
Number of states = 2                                    AIC           = 4.7488
Unconditional probabilities: transition                 HQIC          = 4.8010
                                                        SBIC          = 4.8774
Log likelihood = -399.0241

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8484469   .0514577    16.49   0.000     .7475917    .9493022
             |
       _cons |   -1.11845   .9154994    -1.22   0.222    -2.912795     .675896
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .5637135   .2105782     2.68   0.007     .1509877    .9764392
             |
       _cons |   3.253597    .982925     3.31   0.001     1.327099    5.180095
-------------+----------------------------------------------------------------
       sigma |   2.007462   .1484978                      1.736527    2.320669
-------------+----------------------------------------------------------------
         p11 |   .9101266    .031411                      .8267153    .9555464
-------------+----------------------------------------------------------------
         p21 |   .7040085   .1585057                      .3487822     .913514
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    8.67
         Prob > chi2 =    0.0032

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .00161375

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    4.29
         Prob > chi2 =    0.0383

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .01913971

. 
. *ereturn list
. 
. estat transition

Number of obs = 171         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9101266    .031411      .8267153    .9555464
-----------------------------+------------------------------------------------
                         p12 |   .0898734    .031411      .0444536    .1732847
-----------------------------+------------------------------------------------
                         p21 |   .7040085   .1585057      .3487822     .913514
-----------------------------+------------------------------------------------
                         p22 |   .2959915   .1585057       .086486    .6512178
------------------------------------------------------------------------------

. estat duration

Number of obs = 171         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   11.12676   3.888834      5.770849    22.49538
-----------------------------+------------------------------------------------
                      State2 |   1.420437   .3198078      1.094674    2.867119
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_50.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_PHL.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==51
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -336.39023  (not concave)
Iteration 1:  Log pseudolikelihood =  -336.1287  
Iteration 2:  Log pseudolikelihood = -335.80084  
Iteration 3:  Log pseudolikelihood = -335.78825  
Iteration 4:  Log pseudolikelihood = -335.78824  

Markov-switching autoregression

Sample: 1985q2 thru 2022q2                              Number of obs =    149
Number of states = 2                                    AIC           = 4.6012
Unconditional probabilities: transition                 HQIC          = 4.6585
                                                        SBIC          = 4.7423
Log likelihood = -335.78824

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   1.001128   .0730802    13.70   0.000     .8578936    1.144363
             |
       _cons |  -1.159494   6.357048    -0.18   0.855    -13.61908    11.30009
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .1658583   .5292857     0.31   0.754    -.8715226    1.203239
             |
       _cons |  -1.585937    1.97306    -0.80   0.422    -5.453063    2.281189
-------------+----------------------------------------------------------------
       sigma |   2.082434   .3453572                      1.504545    2.882286
-------------+----------------------------------------------------------------
         p11 |   .9188302   .2076154                      .0461114    .9996229
-------------+----------------------------------------------------------------
         p21 |   .2095653   .2657276                      .0112991    .8601545
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -336.42834  
Iteration 1:  Log pseudolikelihood = -335.91828  
Iteration 2:  Log pseudolikelihood = -335.78968  
Iteration 3:  Log pseudolikelihood = -335.78842  
Iteration 4:  Log pseudolikelihood = -335.78842  

Markov-switching autoregression

Sample: 1985q2 thru 2022q2                              Number of obs =    149
Number of states = 2                                    AIC           = 4.5878
Unconditional probabilities: transition                 HQIC          = 4.6369
                                                        SBIC          = 4.7087
Log likelihood = -335.78842

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -1.156816   6.328453    -0.18   0.855    -13.56036    11.24673
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .1656377   .5237511     0.32   0.752    -.8608956    1.192171
             |
       _cons |  -1.584629   1.937136    -0.82   0.413    -5.381346    2.212087
-------------+----------------------------------------------------------------
       sigma |   2.082526   .3453458                       1.50465    2.882341
-------------+----------------------------------------------------------------
         p11 |   .9190222   .2034335                      .0507592     .999585
-------------+----------------------------------------------------------------
         p21 |   .2096511   .2661476                        .01126    .8606999
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    2.54
         Prob > chi2 =    0.1111

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .05557436

. 
. *ereturn list
. 
. estat transition

Number of obs = 149         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9190222   .2034335      .0507592     .999585
-----------------------------+------------------------------------------------
                         p12 |   .0809778   .2034335       .000415    .9492408
-----------------------------+------------------------------------------------
                         p21 |   .2096511   .2661476        .01126    .8606999
-----------------------------+------------------------------------------------
                         p22 |   .7903489   .2661476      .1393001      .98874
------------------------------------------------------------------------------

. estat duration

Number of obs = 149         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   12.34907   31.02352      1.053473    2409.697
-----------------------------+------------------------------------------------
                      State2 |    4.76983     6.0552      1.161845    88.80998
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_51.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_POL.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==52
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -350.04736  
Iteration 1:  Log pseudolikelihood = -349.76514  
Iteration 2:  Log pseudolikelihood = -349.74652  
Iteration 3:  Log pseudolikelihood = -349.74647  
Iteration 4:  Log pseudolikelihood = -349.74647  

Markov-switching autoregression

Sample: 1977q2 thru 2022q2                              Number of obs =    181
Number of states = 2                                    AIC           = 3.9530
Unconditional probabilities: transition                 HQIC          = 4.0103
                                                        SBIC          = 4.0944
Log likelihood = -349.74647

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8490599   .0593582    14.30   0.000     .7327199    .9653999
             |
       _cons |  -3.257485   2.201454    -1.48   0.139    -7.572256    1.057285
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9647139    .019524    49.41   0.000     .9264476     1.00298
             |
       _cons |  -4.285346   2.258861    -1.90   0.058    -8.712632    .1419399
-------------+----------------------------------------------------------------
      sigma1 |   3.570189   1.106754                      1.944553    6.554848
-------------+----------------------------------------------------------------
      sigma2 |   1.149971   .1076976                      .9571275    1.381669
-------------+----------------------------------------------------------------
         p11 |   .9495262   .0379339                      .7995018     .988858
-------------+----------------------------------------------------------------
         p21 |   .0165707   .0111622                      .0043818     .060602
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -351.13402  
Iteration 1:  Log pseudolikelihood = -351.13306  
Iteration 2:  Log pseudolikelihood = -351.10263  
Iteration 3:  Log pseudolikelihood = -351.06946  
Iteration 4:  Log pseudolikelihood = -351.06927  
Iteration 5:  Log pseudolikelihood = -351.06927  

Markov-switching autoregression

Sample: 1977q2 thru 2022q2                              Number of obs =    181
Number of states = 2                                    AIC           = 3.9566
Unconditional probabilities: transition                 HQIC          = 4.0067
                                                        SBIC          = 4.0803
Log likelihood = -351.06927

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8432879   .0523466    16.11   0.000     .7406905    .9458853
             |
       _cons |  -4.238555   4.024077    -1.05   0.292     -12.1256    3.648491
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   -5.55695   4.746438    -1.17   0.242     -14.8598    3.745897
-------------+----------------------------------------------------------------
      sigma1 |   3.568962   1.160219                      1.887245    6.749249
-------------+----------------------------------------------------------------
      sigma2 |   1.163327   .1093969                      .9675124    1.398772
-------------+----------------------------------------------------------------
         p11 |   .9492926   .0443684                      .7545622    .9913043
-------------+----------------------------------------------------------------
         p21 |   .0166271   .0107275                      .0046517    .0576469
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    8.96
         Prob > chi2 =    0.0028

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .0013779

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 181         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9492926   .0443684      .7545622    .9913043
-----------------------------+------------------------------------------------
                         p12 |   .0507074   .0443684      .0086957    .2454378
-----------------------------+------------------------------------------------
                         p21 |   .0166271   .0107275      .0046517    .0576469
-----------------------------+------------------------------------------------
                         p22 |   .9833729   .0107275      .9423531    .9953483
------------------------------------------------------------------------------

. estat duration

Number of obs = 181         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   19.72101   17.25566      4.074352         115
-----------------------------+------------------------------------------------
                      State2 |   60.14263   38.80278      17.34697    214.9754
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_52.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_PRT.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==53
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -244.4876  
Iteration 1:  Log pseudolikelihood = -244.39592  
Iteration 2:  Log pseudolikelihood = -244.39505  
Iteration 3:  Log pseudolikelihood = -244.39505  

Markov-switching autoregression

Sample: 1991q2 thru 2020q1                              Number of obs =    116
Number of states = 2                                    AIC           = 4.3344
Unconditional probabilities: transition                 HQIC          = 4.4019
                                                        SBIC          = 4.5006
Log likelihood = -244.39505

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |  -1.315128    .113821   -11.55   0.000    -1.538214   -1.092043
             |
       _cons |    -8.1186   .7932328   -10.23   0.000    -9.673308   -6.563892
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .8132246     .06169    13.18   0.000     .6923144    .9341349
             |
       _cons |  -5.306092   .7777307    -6.82   0.000    -6.830416   -3.781768
-------------+----------------------------------------------------------------
       sigma |   1.798672   .1280896                      1.564354    2.068088
-------------+----------------------------------------------------------------
         p11 |   .2841029   .2470825                      .0353924    .8110465
-------------+----------------------------------------------------------------
         p21 |   .0235522   .0174688                      .0054132    .0965706
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -330.82401  (not concave)
Iteration 1:  Log pseudolikelihood = -266.98657  
Iteration 2:  Log pseudolikelihood =  -264.0485  
Iteration 3:  Log pseudolikelihood = -259.48273  
Iteration 4:  Log pseudolikelihood = -259.23894  
Iteration 5:  Log pseudolikelihood = -259.23788  
Iteration 6:  Log pseudolikelihood = -259.23788  

Markov-switching autoregression

Sample: 1991q2 thru 2020q1                              Number of obs =    116
Number of states = 2                                    AIC           = 4.5731
Unconditional probabilities: transition                 HQIC          = 4.6309
                                                        SBIC          = 4.7155
Log likelihood = -259.23788

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   -19.7597   3.743276    -5.28   0.000    -27.09638   -12.42301
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .8469336   .0698924    12.12   0.000      .709947    .9839202
             |
       _cons |  -4.870767   1.128192    -4.32   0.000    -7.081983   -2.659551
-------------+----------------------------------------------------------------
       sigma |   2.039177    .202653                      1.678273    2.477691
-------------+----------------------------------------------------------------
         p11 |   .3305429   .2679004                      .0439993    .8411918
-------------+----------------------------------------------------------------
         p21 |   .0174779   .0122964                      .0043526    .0674997
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    4.80
         Prob > chi2 =    0.0285

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .01426106

. 
. *ereturn list
. 
. estat transition

Number of obs = 116         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .3305429   .2679004      .0439993    .8411918
-----------------------------+------------------------------------------------
                         p12 |   .6694571   .2679004      .1588082    .9560007
-----------------------------+------------------------------------------------
                         p21 |   .0174779   .0122964      .0043526    .0674997
-----------------------------+------------------------------------------------
                         p22 |   .9825221   .0122964      .9325003    .9956474
------------------------------------------------------------------------------

. estat duration

Number of obs = 116         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   1.493748   .5977613      1.046024    6.296904
-----------------------------+------------------------------------------------
                      State2 |   57.21514   40.25308      14.81487    229.7492
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_53.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_ROM.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==54
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -223.87936  
Iteration 1:  Log pseudolikelihood = -223.34189  
Iteration 2:  Log pseudolikelihood = -222.87501  
Iteration 3:  Log pseudolikelihood = -222.84754  
Iteration 4:  Log pseudolikelihood = -222.84123  
Iteration 5:  Log pseudolikelihood = -222.84009  
Iteration 6:  Log pseudolikelihood = -222.83982  
Iteration 7:  Log pseudolikelihood = -222.83976  
Iteration 8:  Log pseudolikelihood = -222.83974  

Markov-switching autoregression

Sample: 1994q2 thru 2021q3                              Number of obs =    110
Number of states = 2                                    AIC           = 4.1789
Unconditional probabilities: transition                 HQIC          = 4.2486
                                                        SBIC          = 4.3508
Log likelihood = -222.83974

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9423983   .0372355    25.31   0.000      .869418    1.015378
             |
       _cons |   5.488477   1.991912     2.76   0.006     1.584401    9.392553
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .0048992   .2486008     0.02   0.984    -.4823494    .4921478
             |
       _cons |   8.775903   1.118994     7.84   0.000     6.582716    10.96909
-------------+----------------------------------------------------------------
       sigma |   1.625553   .1010678                      1.439058    1.836218
-------------+----------------------------------------------------------------
         p11 |   .9621538   .0204934                      .8940312    .9871146
-------------+----------------------------------------------------------------
         p21 |   .9999985   1.74e-06                      .9999857    .9999998
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -224.88367  
Iteration 1:  Log pseudolikelihood =  -224.6021  
Iteration 2:  Log pseudolikelihood = -224.11022  
Iteration 3:  Log pseudolikelihood = -224.07885  
Iteration 4:  Log pseudolikelihood = -224.07344  
Iteration 5:  Log pseudolikelihood = -224.07252  
Iteration 6:  Log pseudolikelihood = -224.07231  
Iteration 7:  Log pseudolikelihood = -224.07226  
Iteration 8:  Log pseudolikelihood = -224.07225  (not concave)
Iteration 9:  Log pseudolikelihood = -224.07225  (backed up)
Iteration 10: Log pseudolikelihood = -224.07225  
Iteration 11: Log pseudolikelihood = -224.07225  
Iteration 12: Log pseudolikelihood = -224.07225  (not concave)
Iteration 13: Log pseudolikelihood = -224.07225  (not concave)
Iteration 14: Log pseudolikelihood = -224.07225  

Markov-switching autoregression

Sample: 1994q2 thru 2021q3                              Number of obs =    110
Number of states = 2                                    AIC           = 4.1831
Unconditional probabilities: transition                 HQIC          = 4.2429
                                                        SBIC          = 4.3304
Log likelihood = -224.07225

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   5.790982   2.409951     2.40   0.016     1.067565     10.5144
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .0727474   .2370571     0.31   0.759     -.391876    .5373708
             |
       _cons |   9.014732   1.283506     7.02   0.000     6.499107    11.53036
-------------+----------------------------------------------------------------
       sigma |   1.638379   .0994706                      1.454574    1.845412
-------------+----------------------------------------------------------------
         p11 |    .959001   .0216604                      .8882108     .985686
-------------+----------------------------------------------------------------
         p21 |          1   6.12e-11                      .9989268           1
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   15.30
         Prob > chi2 =    0.0001

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .00004586

. 
. *ereturn list
. 
. estat transition

Number of obs = 110         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |    .959001   .0216604      .8882108     .985686
-----------------------------+------------------------------------------------
                         p12 |    .040999   .0216604       .014314    .1117892
-----------------------------+------------------------------------------------
                         p21 |          1   6.12e-11      .9989268           1
-----------------------------+------------------------------------------------
                         p22 |   6.34e-12   6.12e-11      3.74e-20    .0010732
------------------------------------------------------------------------------

. estat duration

Number of obs = 110         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   24.39087   12.88611      8.945412    69.86146
-----------------------------+------------------------------------------------
                      State2 |          1   6.12e-11             1    1.001074
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_54.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_RUS.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==55
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -293.7978  
Iteration 1:  Log pseudolikelihood = -293.65449  
Iteration 2:  Log pseudolikelihood = -293.64267  
Iteration 3:  Log pseudolikelihood = -293.64264  
Iteration 4:  Log pseudolikelihood = -293.64264  

Markov-switching autoregression

Sample: 1993q2 thru 2022q2                              Number of obs =    117
Number of states = 2                                    AIC           = 5.1392
Unconditional probabilities: transition                 HQIC          = 5.2063
                                                        SBIC          = 5.3044
Log likelihood = -293.64264

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3067265   .2864627     1.07   0.284    -.2547301    .8681831
             |
       _cons |  -7.040917   .6394625   -11.01   0.000    -8.294241   -5.787594
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .6379349   .2130584     2.99   0.003     .2203483    1.055522
             |
       _cons |  -.6982342   1.360518    -0.51   0.608      -3.3648    1.968331
-------------+----------------------------------------------------------------
       sigma |   2.577411   .4898313                      1.775884    3.740698
-------------+----------------------------------------------------------------
         p11 |   .9526186   .0645355                      .5495001    .9969916
-------------+----------------------------------------------------------------
         p21 |   .0543933    .078157                      .0029183    .5306252
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =  -293.7978  
Iteration 1:  Log pseudolikelihood = -293.65449  
Iteration 2:  Log pseudolikelihood = -293.64267  
Iteration 3:  Log pseudolikelihood = -293.64264  
Iteration 4:  Log pseudolikelihood = -293.64264  

Markov-switching autoregression

Sample: 1993q2 thru 2022q2                              Number of obs =    117
Number of states = 2                                    AIC           = 5.1392
Unconditional probabilities: transition                 HQIC          = 5.2063
                                                        SBIC          = 5.3044
Log likelihood = -293.64264

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3067265   .2864627     1.07   0.284    -.2547301    .8681831
             |
       _cons |  -7.040917   .6394625   -11.01   0.000    -8.294241   -5.787594
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .6379349   .2130584     2.99   0.003     .2203483    1.055522
             |
       _cons |  -.6982342   1.360518    -0.51   0.608      -3.3648    1.968331
-------------+----------------------------------------------------------------
       sigma |   2.577411   .4898313                      1.775884    3.740698
-------------+----------------------------------------------------------------
         p11 |   .9526186   .0645355                      .5495001    .9969916
-------------+----------------------------------------------------------------
         p21 |   .0543933    .078157                      .0029183    .5306252
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    5.86
         Prob > chi2 =    0.0155

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .00775774

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    2.89
         Prob > chi2 =    0.0892

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .04462471

. 
. *ereturn list
. 
. estat transition

Number of obs = 117         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9526186   .0645355      .5495001    .9969916
-----------------------------+------------------------------------------------
                         p12 |   .0473814   .0645355      .0030084    .4504999
-----------------------------+------------------------------------------------
                         p21 |   .0543933    .078157      .0029183    .5306252
-----------------------------+------------------------------------------------
                         p22 |   .9456067    .078157      .4693748    .9970817
------------------------------------------------------------------------------

. estat duration

Number of obs = 117         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   21.10534   28.74639      2.219756     332.398
-----------------------------+------------------------------------------------
                      State2 |   18.38461   26.41656       1.88457    342.6628
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_55.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_SVK.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==56
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -230.89285  
Iteration 1:  Log pseudolikelihood = -230.80805  
Iteration 2:  Log pseudolikelihood = -230.80783  
Iteration 3:  Log pseudolikelihood = -230.80783  

Markov-switching autoregression

Sample: 1995q2 thru 2022q2                              Number of obs =    109
Number of states = 2                                    AIC           = 4.3634
Unconditional probabilities: transition                 HQIC          = 4.4335
                                                        SBIC          = 4.5363
Log likelihood = -230.80783

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .2562471   .0885027     2.90   0.004     .0827849    .4297092
             |
       _cons |  -1.136368   .4730142    -2.40   0.016    -2.063459   -.2092774
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   1.029353   .0473515    21.74   0.000      .936546     1.12216
             |
       _cons |   .1815781   1.263827     0.14   0.886    -2.295477    2.658633
-------------+----------------------------------------------------------------
       sigma |   1.737173   .2688001                      1.282724    2.352628
-------------+----------------------------------------------------------------
         p11 |   .8869257   .1051447                      .5012117    .9839298
-------------+----------------------------------------------------------------
         p21 |   .0923423   .0430663                      .0358313    .2178419
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -231.00902  
Iteration 1:  Log pseudolikelihood =  -230.9489  
Iteration 2:  Log pseudolikelihood = -230.94875  
Iteration 3:  Log pseudolikelihood = -230.94875  

Markov-switching autoregression

Sample: 1995q2 thru 2022q2                              Number of obs =    109
Number of states = 2                                    AIC           = 4.3477
Unconditional probabilities: transition                 HQIC          = 4.4078
                                                        SBIC          = 4.4958
Log likelihood = -230.94875

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .2574668   .0851492     3.02   0.002     .0905774    .4243562
             |
       _cons |  -1.155291   .4384479    -2.63   0.008    -2.014633   -.2959485
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   .2262955   1.328581     0.17   0.865    -2.377676    2.830267
-------------+----------------------------------------------------------------
       sigma |   1.744326   .2745211                      1.281345    2.374594
-------------+----------------------------------------------------------------
         p11 |   .8865774   .1037602                      .5084662    .9833512
-------------+----------------------------------------------------------------
         p21 |    .089757   .0423124                      .0345008    .2139044
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   76.04
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 1.386e-18

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 109         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .8865774   .1037602      .5084662    .9833512
-----------------------------+------------------------------------------------
                         p12 |   .1134226   .1037602      .0166488    .4915338
-----------------------------+------------------------------------------------
                         p21 |    .089757   .0423124      .0345008    .2139044
-----------------------------+------------------------------------------------
                         p22 |    .910243   .0423124      .7860956    .9654992
------------------------------------------------------------------------------

. estat duration

Number of obs = 109         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   8.816588   8.065512      2.034448     60.0644
-----------------------------+------------------------------------------------
                      State2 |   11.14119   5.252074      4.674986     28.9848
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_56.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_SVN.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==57
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -501.10432  (not concave)
Iteration 1:  Log pseudolikelihood = -500.25311  (not concave)
Iteration 2:  Log pseudolikelihood = -493.18239  
Iteration 3:  Log pseudolikelihood = -492.39887  
Iteration 4:  Log pseudolikelihood = -491.38243  
Iteration 5:  Log pseudolikelihood = -491.27431  
Iteration 6:  Log pseudolikelihood = -491.24622  
Iteration 7:  Log pseudolikelihood = -491.23943  
Iteration 8:  Log pseudolikelihood = -491.23783  
Iteration 9:  Log pseudolikelihood = -491.23745  
Iteration 10: Log pseudolikelihood = -491.23737  
Iteration 11: Log pseudolikelihood = -491.23735  

Markov-switching autoregression

Sample: 1960q2 thru 2022q2                              Number of obs =    249
Number of states = 2                                    AIC           = 4.0019
Unconditional probabilities: transition                 HQIC          = 4.0417
                                                        SBIC          = 4.1008
Log likelihood = -491.23735

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   1.295535   .1203922    10.76   0.000     1.059571    1.531499
             |
       _cons |   .0304054   1.068468     0.03   0.977    -2.063753    2.124563
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |    .694447    .051475    13.49   0.000     .5935579    .7953361
             |
       _cons |  -.8421756   .7480321    -1.13   0.260    -2.308292    .6239404
-------------+----------------------------------------------------------------
       sigma |    1.54581   .1058489                      1.351669    1.767835
-------------+----------------------------------------------------------------
         p11 |   2.93e-07   7.23e-07                      2.30e-09    .0000372
-------------+----------------------------------------------------------------
         p21 |   .5043037   .1639214                      .2195998    .7862437
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -517.71702  (not concave)
Iteration 1:  Log pseudolikelihood = -507.77946  (not concave)
Iteration 2:  Log pseudolikelihood = -500.75742  (not concave)
Iteration 3:  Log pseudolikelihood = -493.62665  (not concave)
Iteration 4:  Log pseudolikelihood = -492.64242  (not concave)
Iteration 5:  Log pseudolikelihood = -487.91161  
Iteration 6:  Log pseudolikelihood = -487.02653  
Iteration 7:  Log pseudolikelihood = -486.39014  
Iteration 8:  Log pseudolikelihood = -486.38328  
Iteration 9:  Log pseudolikelihood = -486.38328  

Markov-switching autoregression

Sample: 1960q2 thru 2022q2                              Number of obs =    249
Number of states = 2                                    AIC           = 3.9629
Unconditional probabilities: transition                 HQIC          = 4.0027
                                                        SBIC          = 4.0618
Log likelihood = -486.38328

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -1.852718   .7806086    -2.37   0.018    -3.382682   -.3227528
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .7900324   .0685204    11.53   0.000     .6557349    .9243298
             |
       _cons |   -.627157   .7745022    -0.81   0.418    -2.145153    .8908395
-------------+----------------------------------------------------------------
      sigma1 |   .4079026   .0777343                      .2807645    .5926123
-------------+----------------------------------------------------------------
      sigma2 |   2.069799   .1562715                      1.785096    2.399908
-------------+----------------------------------------------------------------
         p11 |   .4310485   .0985723                      .2562887    .6248532
-------------+----------------------------------------------------------------
         p21 |    .278746   .0954596                      .1322388    .4949817
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    9.39
         Prob > chi2 =    0.0022

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .00109086

. 
. *ereturn list
. 
. estat transition

Number of obs = 249         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .4310485   .0985723      .2562887    .6248532
-----------------------------+------------------------------------------------
                         p12 |   .5689515   .0985723      .3751468    .7437113
-----------------------------+------------------------------------------------
                         p21 |    .278746   .0954596      .1322388    .4949817
-----------------------------+------------------------------------------------
                         p22 |    .721254   .0954596      .5050183    .8677612
------------------------------------------------------------------------------

. estat duration

Number of obs = 249         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   1.757619    .304512      1.344608    2.665623
-----------------------------+------------------------------------------------
                      State2 |   3.587495   1.228577      2.020277    7.562075
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_57.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_ZAF.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==58
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -362.45296  
Iteration 1:  Log pseudolikelihood = -360.59987  (not concave)
Iteration 2:  Log pseudolikelihood = -360.57893  
Iteration 3:  Log pseudolikelihood = -360.34172  
Iteration 4:  Log pseudolikelihood = -360.33697  
Iteration 5:  Log pseudolikelihood = -360.33697  

Markov-switching autoregression

Sample: 1976q2 thru 2022q2                              Number of obs =    185
Number of states = 2                                    AIC           = 3.9820
Unconditional probabilities: transition                 HQIC          = 4.0385
                                                        SBIC          = 4.1213
Log likelihood = -360.33697

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9092367   .0252758    35.97   0.000     .8596971    .9587764
             |
       _cons |   1.518724   1.118438     1.36   0.174    -.6733735    3.710821
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9831018   .0759169    12.95   0.000     .8343074    1.131896
             |
       _cons |   7.778659   2.316558     3.36   0.001     3.238288    12.31903
-------------+----------------------------------------------------------------
      sigma1 |     1.4069   .1208337                      1.188931     1.66483
-------------+----------------------------------------------------------------
      sigma2 |   2.813395   .9572544                      1.444143    5.480889
-------------+----------------------------------------------------------------
         p11 |   .9826715   .0118997                      .9351271    .9955376
-------------+----------------------------------------------------------------
         p21 |   .1162504   .0940143                      .0214154    .4415539
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -362.46046  
Iteration 1:  Log pseudolikelihood = -360.60593  (not concave)
Iteration 2:  Log pseudolikelihood = -360.47067  
Iteration 3:  Log pseudolikelihood = -360.42247  
Iteration 4:  Log pseudolikelihood =  -360.3626  
Iteration 5:  Log pseudolikelihood = -360.36239  
Iteration 6:  Log pseudolikelihood = -360.36239  

Markov-switching autoregression

Sample: 1976q2 thru 2022q2                              Number of obs =    185
Number of states = 2                                    AIC           = 3.9715
Unconditional probabilities: transition                 HQIC          = 4.0209
                                                        SBIC          = 4.0933
Log likelihood = -360.36239

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9089858   .0257436    35.31   0.000     .8585293    .9594423
             |
       _cons |   1.513339   1.119821     1.35   0.177    -.6814696    3.708148
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   7.809788   2.262527     3.45   0.001     3.375317    12.24426
-------------+----------------------------------------------------------------
      sigma1 |   1.408644    .126764                      1.180868    1.680354
-------------+----------------------------------------------------------------
      sigma2 |     2.8024   .9508815                       1.44115     5.44943
-------------+----------------------------------------------------------------
         p11 |   .9827524   .0120451                      .9340046    .9956597
-------------+----------------------------------------------------------------
         p21 |   .1190014   .0947611                      .0224566     .442658
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   12.50
         Prob > chi2 =    0.0004

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .00020357

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 185         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9827524   .0120451      .9340046    .9956597
-----------------------------+------------------------------------------------
                         p12 |   .0172476   .0120451      .0043403    .0659954
-----------------------------+------------------------------------------------
                         p21 |   .1190014   .0947611      .0224566     .442658
-----------------------------+------------------------------------------------
                         p22 |   .8809986   .0947611       .557342    .9775434
------------------------------------------------------------------------------

. estat duration

Number of obs = 185         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   57.97913   40.49046      15.15258    230.4014
-----------------------------+------------------------------------------------
                      State2 |   8.403264   6.691538      2.259081    44.53043
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_58.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_KOR.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==59
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -220.46878  (not concave)
Iteration 1:  Log pseudolikelihood = -219.04684  (not concave)
Iteration 2:  Log pseudolikelihood = -216.17451  
Iteration 3:  Log pseudolikelihood = -214.88284  
Iteration 4:  Log pseudolikelihood = -214.22044  
Iteration 5:  Log pseudolikelihood = -214.19969  
Iteration 6:  Log pseudolikelihood =  -214.1996  
Iteration 7:  Log pseudolikelihood =  -214.1996  

Markov-switching autoregression

Sample: 1975q2 thru 2022q2                              Number of obs =    189
Number of states = 2                                    AIC           = 2.3407
Unconditional probabilities: transition                 HQIC          = 2.3894
                                                        SBIC          = 2.4608
Log likelihood = -214.1996

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8257316   .1414228     5.84   0.000     .5485481    1.102915
             |
       _cons |   2.851329   4.038598     0.71   0.480    -5.064177    10.76684
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   1.006158   .0173805    57.89   0.000     .9720929    1.040223
             |
       _cons |   1.902131   4.103565     0.46   0.643    -6.140708     9.94497
-------------+----------------------------------------------------------------
       sigma |   .6208382   .0505125                       .529326    .7281715
-------------+----------------------------------------------------------------
         p11 |    .699893   .1552986                      .3538076    .9085386
-------------+----------------------------------------------------------------
         p21 |   .0578227    .037191                      .0158469    .1895686
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -220.69687  (not concave)
Iteration 1:  Log pseudolikelihood = -219.22824  
Iteration 2:  Log pseudolikelihood = -217.78746  (not concave)
Iteration 3:  Log pseudolikelihood = -217.26626  (not concave)
Iteration 4:  Log pseudolikelihood = -214.93737  
Iteration 5:  Log pseudolikelihood = -214.43714  
Iteration 6:  Log pseudolikelihood =  -214.3257  
Iteration 7:  Log pseudolikelihood = -214.31907  
Iteration 8:  Log pseudolikelihood = -214.31906  

Markov-switching autoregression

Sample: 1975q2 thru 2022q2                              Number of obs =    189
Number of states = 2                                    AIC           = 2.3314
Unconditional probabilities: transition                 HQIC          = 2.3731
                                                        SBIC          = 2.4343
Log likelihood = -214.31906

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8090895   .0590877    13.69   0.000     .6932797    .9248993
             |
       _cons |   2.418224   1.397285     1.73   0.084    -.3204047    5.156852
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   1.425297   1.364702     1.04   0.296     -1.24947    4.100063
-------------+----------------------------------------------------------------
       sigma |   .6268633   .0417442                      .5501606    .7142599
-------------+----------------------------------------------------------------
         p11 |   .7112353   .1268945                      .4232173    .8920989
-------------+----------------------------------------------------------------
         p21 |   .0549008   .0332025                      .0163033    .1691627
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   10.44
         Prob > chi2 =    0.0012

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .00061686

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 189         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .7112353   .1268945      .4232173    .8920989
-----------------------------+------------------------------------------------
                         p12 |   .2887647   .1268945      .1079011    .5767827
-----------------------------+------------------------------------------------
                         p21 |   .0549008   .0332025      .0163033    .1691627
-----------------------------+------------------------------------------------
                         p22 |   .9450992   .0332025      .8308373    .9836967
------------------------------------------------------------------------------

. estat duration

Number of obs = 189         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   3.463027    1.52179      1.733755    9.267745
-----------------------------+------------------------------------------------
                      State2 |   18.21468   11.01575      5.911468    61.33742
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_59.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_ESP.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==60
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -448.65775  (not concave)
Iteration 1:  Log pseudolikelihood = -447.52503  
Iteration 2:  Log pseudolikelihood = -445.72097  
Iteration 3:  Log pseudolikelihood = -445.01034  
Iteration 4:  Log pseudolikelihood = -444.90805  
Iteration 5:  Log pseudolikelihood = -444.90651  
Iteration 6:  Log pseudolikelihood = -444.90651  

Markov-switching autoregression

Sample: 1977q2 thru 2021q1                              Number of obs =    176
Number of states = 2                                    AIC           = 5.1353
Unconditional probabilities: transition                 HQIC          = 5.1864
                                                        SBIC          = 5.2614
Log likelihood = -444.90651

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9468243   .1579588     5.99   0.000     .6372307    1.256418
             |
       _cons |  -8.869409   1.036025    -8.56   0.000    -10.89998   -6.838838
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .6669077   .1070813     6.23   0.000     .4570322    .8767831
             |
       _cons |  -3.658117   .6613025    -5.53   0.000    -4.954246   -2.361988
-------------+----------------------------------------------------------------
       sigma |   2.330673   .1899424                      1.986603    2.734334
-------------+----------------------------------------------------------------
         p11 |   .2480252   .3151437                      .0118803    .9004807
-------------+----------------------------------------------------------------
         p21 |   .1321437   .0443415                       .066611    .2452109
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -449.13807  (not concave)
Iteration 1:  Log pseudolikelihood = -445.80393  
Iteration 2:  Log pseudolikelihood = -445.40713  
Iteration 3:  Log pseudolikelihood = -444.96095  
Iteration 4:  Log pseudolikelihood = -444.95904  
Iteration 5:  Log pseudolikelihood = -444.95904  

Markov-switching autoregression

Sample: 1977q2 thru 2021q1                              Number of obs =    176
Number of states = 2                                    AIC           = 5.1245
Unconditional probabilities: transition                 HQIC          = 5.1684
                                                        SBIC          = 5.2326
Log likelihood = -444.95904

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -8.765296   .9784918    -8.96   0.000     -10.6831   -6.847488
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .6645988   .1038254     6.40   0.000     .4611049    .8680928
             |
       _cons |  -3.652247   .6480449    -5.64   0.000    -4.922391   -2.382102
-------------+----------------------------------------------------------------
       sigma |   2.337375   .1967382                      1.981902    2.756605
-------------+----------------------------------------------------------------
         p11 |   .2303583   .2704453                      .0148318    .8561239
-------------+----------------------------------------------------------------
         p21 |   .1353086   .0432381                      .0704936    .2440693
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =   10.44
         Prob > chi2 =    0.0012

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .00061801

. 
. *ereturn list
. 
. estat transition

Number of obs = 176         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .2303583   .2704453      .0148318    .8561239
-----------------------------+------------------------------------------------
                         p12 |   .7696417   .2704453      .1438761    .9851682
-----------------------------+------------------------------------------------
                         p21 |   .1353086   .0432381      .0704936    .2440693
-----------------------------+------------------------------------------------
                         p22 |   .8646914   .0432381      .7559307    .9295064
------------------------------------------------------------------------------

. estat duration

Number of obs = 176         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   1.299306   .4565647      1.015055    6.950424
-----------------------------+------------------------------------------------
                      State2 |   7.390512   2.361653      4.097198    14.18567
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_60.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_LKA.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==61
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -288.87697  
Iteration 1:  Log pseudolikelihood = -288.72935  (not concave)
Iteration 2:  Log pseudolikelihood = -288.49941  
Iteration 3:  Log pseudolikelihood = -287.39438  (not concave)
Iteration 4:  Log pseudolikelihood = -287.11158  
Iteration 5:  Log pseudolikelihood = -287.03959  (backed up)
Iteration 6:  Log pseudolikelihood = -287.01007  
Iteration 7:  Log pseudolikelihood = -287.00913  
Iteration 8:  Log pseudolikelihood =  -287.0089  
Iteration 9:  Log pseudolikelihood = -287.00885  
Iteration 10: Log pseudolikelihood = -287.00885  

Markov-switching autoregression

Sample: 1975q2 thru 2022q2                              Number of obs =    189
Number of states = 2                                    AIC           = 3.1218
Unconditional probabilities: transition                 HQIC          = 3.1774
                                                        SBIC          = 3.2590
Log likelihood = -287.00885

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8811258   .0641845    13.73   0.000     .7553266    1.006925
             |
       _cons |  -.9634351   1.554612    -0.62   0.535    -4.010418    2.083548
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9557011   .0244923    39.02   0.000     .9076971    1.003705
             |
       _cons |   2.502314   1.600888     1.56   0.118      -.63537    5.639997
-------------+----------------------------------------------------------------
      sigma1 |   .9243909   .2835704                       .506684    1.686453
-------------+----------------------------------------------------------------
      sigma2 |   1.020372   .0535107                      .9207024     1.13083
-------------+----------------------------------------------------------------
         p11 |   1.34e-06   1.23e-06                      2.22e-07    8.07e-06
-------------+----------------------------------------------------------------
         p21 |   .0166691    .009359                      .0055055    .0493457
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -289.93273  
Iteration 1:  Log pseudolikelihood = -289.90598  
Iteration 2:  Log pseudolikelihood = -289.90501  
Iteration 3:  Log pseudolikelihood = -289.90501  

Markov-switching autoregression

Sample: 1975q2 thru 2022q2                              Number of obs =    189
Number of states = 2                                    AIC           = 3.1419
Unconditional probabilities: transition                 HQIC          = 3.1905
                                                        SBIC          = 3.2619
Log likelihood = -289.90501

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .6137258   .2837518     2.16   0.031     .0575825    1.169869
             |
       _cons |  -1.218929   1.353886    -0.90   0.368    -3.872498    1.434639
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   1.213252    2.13507     0.57   0.570    -2.971408    5.397912
-------------+----------------------------------------------------------------
      sigma1 |   1.613928   .4232713                       .965265    2.698495
-------------+----------------------------------------------------------------
      sigma2 |    .966251   .0959221                      .7954065    1.173791
-------------+----------------------------------------------------------------
         p11 |   .7798348   .5045308                      .0110437    .9991107
-------------+----------------------------------------------------------------
         p21 |    .024033   .0180886                      .0054023    .1004266
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    1.85
         Prob > chi2 =    0.1734

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .08670784

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 189         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .7798348   .5045308      .0110437    .9991107
-----------------------------+------------------------------------------------
                         p12 |   .2201652   .5045308      .0008893    .9889563
-----------------------------+------------------------------------------------
                         p21 |    .024033   .0180886      .0054023    .1004266
-----------------------------+------------------------------------------------
                         p22 |    .975967   .0180886      .8995734    .9945977
------------------------------------------------------------------------------

. estat duration

Number of obs = 189         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   4.542044   10.40855      1.011167    1124.496
-----------------------------+------------------------------------------------
                      State2 |   41.60939   31.31757      9.957526    185.1047
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_61.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_SWE.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==62
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -454.52147  
Iteration 1:  Log pseudolikelihood = -453.88517  
Iteration 2:  Log pseudolikelihood = -453.80878  
Iteration 3:  Log pseudolikelihood = -453.80566  
Iteration 4:  Log pseudolikelihood = -453.80566  

Markov-switching autoregression

Sample: 1972q2 thru 2022q2                              Number of obs =    201
Number of states = 2                                    AIC           = 4.5851
Unconditional probabilities: transition                 HQIC          = 4.6317
                                                        SBIC          = 4.7002
Log likelihood = -453.80566

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   -.080448   .2358554    -0.34   0.733    -.5427161    .3818201
             |
       _cons |    5.03625   2.478916     2.03   0.042     .1776636    9.894836
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9185021   .0773172    11.88   0.000     .7669631    1.070041
             |
       _cons |   5.246732   .9849159     5.33   0.000     3.316333    7.177132
-------------+----------------------------------------------------------------
       sigma |   2.077636   .2631136                      1.620961     2.66297
-------------+----------------------------------------------------------------
         p11 |    .377522   .2272965                      .0834935    .8014915
-------------+----------------------------------------------------------------
         p21 |   .0990818   .0733795                      .0214857    .3551927
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -455.81477  
Iteration 1:  Log pseudolikelihood = -455.10785  
Iteration 2:  Log pseudolikelihood = -454.85516  (not concave)
Iteration 3:  Log pseudolikelihood = -454.48261  
Iteration 4:  Log pseudolikelihood = -453.25871  
Iteration 5:  Log pseudolikelihood = -453.04893  
Iteration 6:  Log pseudolikelihood = -453.04809  
Iteration 7:  Log pseudolikelihood = -453.04809  

Markov-switching autoregression

Sample: 1972q2 thru 2022q2                              Number of obs =    201
Number of states = 2                                    AIC           = 4.5676
Unconditional probabilities: transition                 HQIC          = 4.6075
                                                        SBIC          = 4.6662
Log likelihood = -453.04809

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |  -.0967583   .1675933    -0.58   0.564    -.4252351    .2317186
             |
       _cons |   6.239162   1.346286     4.63   0.000     3.600491    8.877834
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   2.545041   4.056505     0.63   0.530    -5.405562    10.49564
-------------+----------------------------------------------------------------
       sigma |   1.930919   .1599675                      1.641519     2.27134
-------------+----------------------------------------------------------------
         p11 |   .7200639   .3858774                       .056933    .9909582
-------------+----------------------------------------------------------------
         p21 |   .0542823   .0644333                      .0048798    .4018583
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   42.83
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 2.991e-11

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 201         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .7200639   .3858774       .056933    .9909582
-----------------------------+------------------------------------------------
                         p12 |   .2799361   .3858774      .0090418     .943067
-----------------------------+------------------------------------------------
                         p21 |   .0542823   .0644333      .0048798    .4018583
-----------------------------+------------------------------------------------
                         p22 |   .9457177   .0644333      .5981417    .9951202
------------------------------------------------------------------------------

. estat duration

Number of obs = 201         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   3.572244   4.924154       1.06037     110.598
-----------------------------+------------------------------------------------
                      State2 |    18.4222    21.8672      2.488439    204.9272
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_62.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_CHE.dta saved

. 
. // MS AR for the current account
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==63
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -324.85414  
Iteration 1:  Log pseudolikelihood = -324.76298  
Iteration 2:  Log pseudolikelihood = -324.76199  
Iteration 3:  Log pseudolikelihood = -324.76199  

Markov-switching autoregression

Sample: 1981q2 thru 2019q4                              Number of obs =    155
Number of states = 2                                    AIC           = 4.2808
Unconditional probabilities: transition                 HQIC          = 4.3366
                                                        SBIC          = 4.4182
Log likelihood = -324.76199

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |    .485918   .1080418     4.50   0.000     .2741599     .697676
             |
       _cons |   4.831545   2.417189     2.00   0.046      .093942    9.569148
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .9509563   .0410702    23.15   0.000     .8704602    1.031452
             |
       _cons |   9.722544   1.606805     6.05   0.000     6.573264    12.87182
-------------+----------------------------------------------------------------
       sigma |    1.65285   .1361552                       1.40642     1.94246
-------------+----------------------------------------------------------------
         p11 |   .4404438   .8195046                      .0011618    .9981262
-------------+----------------------------------------------------------------
         p21 |   .0444784   .0484985                      .0049479    .3035045
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -326.26505  
Iteration 1:  Log pseudolikelihood = -326.08158  
Iteration 2:  Log pseudolikelihood = -326.07708  
Iteration 3:  Log pseudolikelihood = -326.07708  

Markov-switching autoregression

Sample: 1981q2 thru 2019q4                              Number of obs =    155
Number of states = 2                                    AIC           = 4.2849
Unconditional probabilities: transition                 HQIC          = 4.3327
                                                        SBIC          = 4.4027
Log likelihood = -326.07708

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .4788556    .085358     5.61   0.000      .311557    .6461542
             |
       _cons |   5.337528   1.914155     2.79   0.005     1.585854    9.089203
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   10.09976   1.921441     5.26   0.000     6.333803    13.86571
-------------+----------------------------------------------------------------
       sigma |   1.643138   .1151133                      1.432325     1.88498
-------------+----------------------------------------------------------------
         p11 |   .3259538   .3989198                      .0135836    .9443875
-------------+----------------------------------------------------------------
         p21 |   .0529956   .0315699                      .0160479    .1610833
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   37.28
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 5.127e-10

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 155         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .3259538   .3989198      .0135836    .9443875
-----------------------------+------------------------------------------------
                         p12 |   .6740462   .3989198      .0556125    .9864164
-----------------------------+------------------------------------------------
                         p21 |   .0529956   .0315699      .0160479    .1610833
-----------------------------+------------------------------------------------
                         p22 |   .9470044   .0315699      .8389167    .9839521
------------------------------------------------------------------------------

. estat duration

Number of obs = 155         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   1.483578   .8780238      1.013771    17.98158
-----------------------------+------------------------------------------------
                      State2 |    18.8695   11.24072      6.207968    62.31355
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_63.png saved as PNG format

. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_TWN.dta saved

. 
. **# MS AR for the current account - Thailand
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==64
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -420.25725  (not concave)
Iteration 1:  Log pseudolikelihood = -420.21668  (not concave)
Iteration 2:  Log pseudolikelihood = -419.84842  (not concave)
Iteration 3:  Log pseudolikelihood = -415.15295  (not concave)
Iteration 4:  Log pseudolikelihood = -413.10764  (not concave)
Iteration 5:  Log pseudolikelihood = -407.90554  (not concave)
Iteration 6:  Log pseudolikelihood = -397.47877  
Iteration 7:  Log pseudolikelihood = -396.94564  
Iteration 8:  Log pseudolikelihood = -388.84962  
Iteration 9:  Log pseudolikelihood = -388.20979  
Iteration 10: Log pseudolikelihood = -388.19577  
Iteration 11: Log pseudolikelihood = -388.19575  

Markov-switching autoregression

Sample: 1976q2 thru 2019q4                              Number of obs =    175
Number of states = 2                                    AIC           = 4.5165
Unconditional probabilities: transition                 HQIC          = 4.5679
                                                        SBIC          = 4.6431
Log likelihood = -388.19575

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8192671   .0915327     8.95   0.000     .6398664    .9986678
             |
       _cons |   6.507797    1.31596     4.95   0.000     3.928563    9.087031
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .8699037   .0556152    15.64   0.000     .7608998    .9789075
             |
       _cons |  -4.249414   1.181603    -3.60   0.000    -6.565313   -1.933514
-------------+----------------------------------------------------------------
       sigma |   1.950599   .1199545                      1.729109    2.200461
-------------+----------------------------------------------------------------
         p11 |   .9615184   .0217775                      .8874303    .9875303
-------------+----------------------------------------------------------------
         p21 |    .023062   .0135194                      .0072296    .0710846
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -420.25725  (not concave)
Iteration 1:  Log pseudolikelihood = -420.21668  (not concave)
Iteration 2:  Log pseudolikelihood = -419.84842  (not concave)
Iteration 3:  Log pseudolikelihood = -415.15295  (not concave)
Iteration 4:  Log pseudolikelihood = -413.10764  (not concave)
Iteration 5:  Log pseudolikelihood = -407.90554  (not concave)
Iteration 6:  Log pseudolikelihood = -397.47877  
Iteration 7:  Log pseudolikelihood = -396.94564  
Iteration 8:  Log pseudolikelihood = -388.84962  
Iteration 9:  Log pseudolikelihood = -388.20979  
Iteration 10: Log pseudolikelihood = -388.19577  
Iteration 11: Log pseudolikelihood = -388.19575  

Markov-switching autoregression

Sample: 1976q2 thru 2019q4                              Number of obs =    175
Number of states = 2                                    AIC           = 4.5165
Unconditional probabilities: transition                 HQIC          = 4.5679
                                                        SBIC          = 4.6431
Log likelihood = -388.19575

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8192671   .0915327     8.95   0.000     .6398664    .9986678
             |
       _cons |   6.507797    1.31596     4.95   0.000     3.928563    9.087031
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .8699037   .0556152    15.64   0.000     .7608998    .9789075
             |
       _cons |  -4.249414   1.181603    -3.60   0.000    -6.565313   -1.933514
-------------+----------------------------------------------------------------
       sigma |   1.950599   .1199545                      1.729109    2.200461
-------------+----------------------------------------------------------------
         p11 |   .9615184   .0217775                      .8874303    .9875303
-------------+----------------------------------------------------------------
         p21 |    .023062   .0135194                      .0072296    .0710846
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    3.90
         Prob > chi2 =    0.0483

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .02416143

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    5.47
         Prob > chi2 =    0.0193

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .00966201

. 
. *ereturn list
. 
. estat transition

Number of obs = 175         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9615184   .0217775      .8874303    .9875303
-----------------------------+------------------------------------------------
                         p12 |   .0384816   .0217775      .0124697    .1125697
-----------------------------+------------------------------------------------
                         p21 |    .023062   .0135194      .0072296    .0710846
-----------------------------+------------------------------------------------
                         p22 |    .976938   .0135194      .9289154    .9927704
------------------------------------------------------------------------------

. estat duration

Number of obs = 175         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   25.98644   14.70626      8.883389    80.19461
-----------------------------+------------------------------------------------
                      State2 |   43.36129   25.41913      14.06775    138.3211
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. 
. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_64.png saved as PNG format

. 
. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_THA.dta saved

. 
. **# MS AR for the current account - Turkey
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==65
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -267.43805  
Iteration 1:  Log pseudolikelihood = -266.98128  
Iteration 2:  Log pseudolikelihood = -266.17262  
Iteration 3:  Log pseudolikelihood = -266.00118  
Iteration 4:  Log pseudolikelihood = -265.95438  
Iteration 5:  Log pseudolikelihood = -265.95414  
Iteration 6:  Log pseudolikelihood = -265.95414  

Markov-switching autoregression

Sample: 1987q2 thru 2022q2                              Number of obs =    141
Number of states = 2                                    AIC           = 3.8859
Unconditional probabilities: transition                 HQIC          = 3.9539
                                                        SBIC          = 4.0532
Log likelihood = -265.95414

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8357936   .0734978    11.37   0.000     .6917405    .9798467
             |
       _cons |  -4.175881   .5261817    -7.94   0.000    -5.207179   -3.144584
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .6567424   .1333517     4.92   0.000     .3953779     .918107
             |
       _cons |  -1.210068   .5862198    -2.06   0.039    -2.359038   -.0610987
-------------+----------------------------------------------------------------
      sigma1 |   .8273522   .1346302                      .6014221    1.138155
-------------+----------------------------------------------------------------
      sigma2 |   2.129731   .2780087                      1.648965    2.750667
-------------+----------------------------------------------------------------
         p11 |    .927588   .0303674                      .8407877    .9688209
-------------+----------------------------------------------------------------
         p21 |   .0610562   .0301147                      .0226977    .1540233
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -267.43805  
Iteration 1:  Log pseudolikelihood = -266.98128  
Iteration 2:  Log pseudolikelihood = -266.17262  
Iteration 3:  Log pseudolikelihood = -266.00118  
Iteration 4:  Log pseudolikelihood = -265.95438  
Iteration 5:  Log pseudolikelihood = -265.95414  
Iteration 6:  Log pseudolikelihood = -265.95414  

Markov-switching autoregression

Sample: 1987q2 thru 2022q2                              Number of obs =    141
Number of states = 2                                    AIC           = 3.8859
Unconditional probabilities: transition                 HQIC          = 3.9539
                                                        SBIC          = 4.0532
Log likelihood = -265.95414

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .8357936   .0734978    11.37   0.000     .6917405    .9798467
             |
       _cons |  -4.175881   .5261817    -7.94   0.000    -5.207179   -3.144584
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .6567424   .1333517     4.92   0.000     .3953779     .918107
             |
       _cons |  -1.210068   .5862198    -2.06   0.039    -2.359038   -.0610987
-------------+----------------------------------------------------------------
      sigma1 |   .8273522   .1346302                      .6014221    1.138155
-------------+----------------------------------------------------------------
      sigma2 |   2.129731   .2780087                      1.648965    2.750667
-------------+----------------------------------------------------------------
         p11 |    .927588   .0303674                      .8407877    .9688209
-------------+----------------------------------------------------------------
         p21 |   .0610562   .0301147                      .0226977    .1540233
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    4.99
         Prob > chi2 =    0.0255

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .01273606

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    6.63
         Prob > chi2 =    0.0101

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .0050254

. 
. *ereturn list
. 
. estat transition

Number of obs = 141         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |    .927588   .0303674      .8407877    .9688209
-----------------------------+------------------------------------------------
                         p12 |    .072412   .0303674      .0311791    .1592123
-----------------------------+------------------------------------------------
                         p21 |   .0610562   .0301147      .0226977    .1540233
-----------------------------+------------------------------------------------
                         p22 |   .9389438   .0301147      .8459767    .9773023
------------------------------------------------------------------------------

. estat duration

Number of obs = 141         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   13.80987   5.791448      6.280922    32.07277
-----------------------------+------------------------------------------------
                      State2 |   16.37834   8.078266      6.492524    44.05732
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. 
. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace                                 
file probas\ms_65.png saved as PNG format

.                                         
. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_TUR.dta saved

. 
. **# MS AR for the current account - United Kingdom
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==66
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -411.33519  (not concave)
Iteration 1:  Log pseudolikelihood = -410.81829  (not concave)
Iteration 2:  Log pseudolikelihood = -409.78533  (not concave)
Iteration 3:  Log pseudolikelihood =  -409.3569  (not concave)
Iteration 4:  Log pseudolikelihood = -409.18944  (not concave)
Iteration 5:  Log pseudolikelihood = -405.81582  (not concave)
Iteration 6:  Log pseudolikelihood = -401.54185  (not concave)
Iteration 7:  Log pseudolikelihood =  -397.5522  (not concave)
Iteration 8:  Log pseudolikelihood =  -396.1445  
Iteration 9:  Log pseudolikelihood =  -394.1759  (not concave)
Iteration 10: Log pseudolikelihood =  -388.1681  
Iteration 11: Log pseudolikelihood = -386.41079  
Iteration 12: Log pseudolikelihood = -386.31716  
Iteration 13: Log pseudolikelihood = -386.31659  
Iteration 14: Log pseudolikelihood = -386.31659  

Markov-switching autoregression

Sample: 1955q2 thru 2022q2                              Number of obs =    269
Number of states = 2                                    AIC           = 2.9243
Unconditional probabilities: transition                 HQIC          = 2.9619
                                                        SBIC          = 3.0178
Log likelihood = -386.31659

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9856775   .0100261    98.31   0.000     .9660266    1.005328
             |
       _cons |  -7.188122   .6928876   -10.37   0.000    -8.546157   -5.830088
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |  -.6235327   .2419821    -2.58   0.010    -1.097809   -.1492565
             |
       _cons |  -1.874332   .1718835   -10.90   0.000    -2.211217   -1.537447
-------------+----------------------------------------------------------------
       sigma |   .9559003   .0386445                      .8830816    1.034724
-------------+----------------------------------------------------------------
         p11 |   .9924145    .005357                       .970089    .9981088
-------------+----------------------------------------------------------------
         p21 |   .2028999   .1263615                      .0521735    .5406751
------------------------------------------------------------------------------

. constraint 1 [State1]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -391.47676  (not concave)
Iteration 1:  Log pseudolikelihood = -387.93331  (not concave)
Iteration 2:  Log pseudolikelihood = -387.11901  (not concave)
Iteration 3:  Log pseudolikelihood = -386.35477  
Iteration 4:  Log pseudolikelihood = -383.50264  
Iteration 5:  Log pseudolikelihood = -383.22072  
Iteration 6:  Log pseudolikelihood = -383.21594  
Iteration 7:  Log pseudolikelihood = -383.21594  

Markov-switching autoregression

Sample: 1955q2 thru 2022q2                              Number of obs =    269
Number of states = 2                                    AIC           = 2.9012
Unconditional probabilities: transition                 HQIC          = 2.9388
                                                        SBIC          = 2.9948
Log likelihood = -383.21594

 ( 1)  [State1]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -1.955241   .7637292    -2.56   0.010    -3.452122    -.458359
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .8823811   .0385893    22.87   0.000     .8067474    .9580147
             |
       _cons |  -1.405534   .5426807    -2.59   0.010    -2.469168   -.3418993
-------------+----------------------------------------------------------------
      sigma1 |   2.912897   .9523689                      1.534707    5.528721
-------------+----------------------------------------------------------------
      sigma2 |   .9219852   .0500428                      .8289399    1.025474
-------------+----------------------------------------------------------------
         p11 |   .9825205   .0103608                      .9451464    .9945762
-------------+----------------------------------------------------------------
         p21 |   .0034923   .0031181                      .0006049    .0198866
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1

           chi2(  1) =    9.29
         Prob > chi2 =    0.0023

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .00115197

. 
. *ereturn list
. 
. estat transition

Number of obs = 269         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9825205   .0103608      .9451464    .9945762
-----------------------------+------------------------------------------------
                         p12 |   .0174795   .0103608      .0054238    .0548536
-----------------------------+------------------------------------------------
                         p21 |   .0034923   .0031181      .0006049    .0198866
-----------------------------+------------------------------------------------
                         p22 |   .9965077   .0031181      .9801134    .9993951
------------------------------------------------------------------------------

. estat duration

Number of obs = 269         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   57.20997   33.91077      18.23035    184.3718
-----------------------------+------------------------------------------------
                      State2 |   286.3477   255.6655      50.28514    1653.087
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. 
. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace                                 
file probas\ms_66.png saved as PNG format

.                                         
. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_GBR.dta saved

. 
. **# MS AR for the current account - United States
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==67
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -60.238242  
Iteration 1:  Log pseudolikelihood = -60.199334  
Iteration 2:  Log pseudolikelihood = -60.199289  
Iteration 3:  Log pseudolikelihood = -60.199289  

Markov-switching autoregression

Sample: 1960q2 thru 2022q2                              Number of obs =    249
Number of states = 2                                    AIC           = 0.5398
Unconditional probabilities: transition                 HQIC          = 0.5796
                                                        SBIC          = 0.6386
Log likelihood = -60.199289

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9273197   .0183065    50.66   0.000     .8914397    .9631998
             |
       _cons |  -2.573411   1.259127    -2.04   0.041    -5.041254   -.1055679
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   1.001301   .0290861    34.43   0.000     .9442937    1.058309
             |
       _cons |  -1.386688   1.421588    -0.98   0.329    -4.172949    1.399573
-------------+----------------------------------------------------------------
       sigma |   .2815143   .0144983                      .2544852    .3114142
-------------+----------------------------------------------------------------
         p11 |   .9570557   .0158307                      .9128571    .9793442
-------------+----------------------------------------------------------------
         p21 |   .0138295   .0073667                      .0048413    .0388529
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -60.240475  
Iteration 1:  Log pseudolikelihood = -60.203299  
Iteration 2:  Log pseudolikelihood = -60.203253  
Iteration 3:  Log pseudolikelihood = -60.203253  

Markov-switching autoregression

Sample: 1960q2 thru 2022q2                              Number of obs =    249
Number of states = 2                                    AIC           = 0.5318
Unconditional probabilities: transition                 HQIC          = 0.5659
                                                        SBIC          = 0.6165
Log likelihood = -60.203253

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .9273635   .0181984    50.96   0.000     .8916953    .9630318
             |
       _cons |  -2.610331   .6305965    -4.14   0.000    -3.846278   -1.374385
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   -1.42653   .7325471    -1.95   0.051    -2.862296    .0092361
-------------+----------------------------------------------------------------
       sigma |   .2814774   .0144949                      .2544545    .3113701
-------------+----------------------------------------------------------------
         p11 |   .9571549   .0143817                      .9182668     .977984
-------------+----------------------------------------------------------------
         p21 |   .0138522   .0074582                      .0047946    .0393443
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   15.93
         Prob > chi2 =    0.0001

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .00003285

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 249         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9571549   .0143817      .9182668     .977984
-----------------------------+------------------------------------------------
                         p12 |   .0428451   .0143817       .022016    .0817332
-----------------------------+------------------------------------------------
                         p21 |   .0138522   .0074582      .0047946    .0393443
-----------------------------+------------------------------------------------
                         p22 |   .9861478   .0074582      .9606557    .9952054
------------------------------------------------------------------------------

. estat duration

Number of obs = 249         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   23.33991   7.834469      12.23493    45.42143
-----------------------------+------------------------------------------------
                      State2 |   72.19062   38.86847      25.41665    208.5676
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. 
. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace                                 
file probas\ms_67.png saved as PNG format

.                                         
. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_USA.dta saved

. 
. **# MS AR for the current account - Uruguay
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==68
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -142.60919  
Iteration 1:  Log pseudolikelihood = -142.56603  
Iteration 2:  Log pseudolikelihood = -142.56047  
Iteration 3:  Log pseudolikelihood = -142.56046  

Markov-switching autoregression

Sample: 1999q2 thru 2020q1                              Number of obs =     84
Number of states = 2                                    AIC           = 3.5848
Unconditional probabilities: transition                 HQIC          = 3.6778
                                                        SBIC          = 3.8163
Log likelihood = -142.56046

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .4550703   .2625316     1.73   0.083    -.0594822    .9696228
             |
       _cons |  -2.999246   .8632221    -3.47   0.001     -4.69113   -1.307362
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   .8337334   .0896695     9.30   0.000     .6579844    1.009483
             |
       _cons |  -1.006434   .6333817    -1.59   0.112     -2.24784     .234971
-------------+----------------------------------------------------------------
      sigma1 |   1.652204   .9955907                      .5071584    5.382494
-------------+----------------------------------------------------------------
      sigma2 |   1.093595   .0912337                       .928634    1.287859
-------------+----------------------------------------------------------------
         p11 |   .6797447    .154323                      .3459633    .8949215
-------------+----------------------------------------------------------------
         p21 |    .055053   .0701523                      .0041279    .4502143
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -144.51528  
Iteration 1:  Log pseudolikelihood = -144.30528  (not concave)
Iteration 2:  Log pseudolikelihood = -144.28837  
Iteration 3:  Log pseudolikelihood = -144.10125  
Iteration 4:  Log pseudolikelihood = -143.92408  
Iteration 5:  Log pseudolikelihood = -143.92139  
Iteration 6:  Log pseudolikelihood = -143.92138  

Markov-switching autoregression

Sample: 1999q2 thru 2020q1                              Number of obs =     84
Number of states = 2                                    AIC           = 3.5934
Unconditional probabilities: transition                 HQIC          = 3.6748
                                                        SBIC          = 3.7959
Log likelihood = -143.92138

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .4225898   .2452472     1.72   0.085    -.0580858    .9032655
             |
       _cons |  -2.994014   .9037095    -3.31   0.001    -4.765253   -1.222776
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -1.268723   .9054179    -1.40   0.161    -3.043309    .5058635
-------------+----------------------------------------------------------------
      sigma1 |   1.281306   .5227532                       .575938    2.850559
-------------+----------------------------------------------------------------
      sigma2 |   1.043025    .095094                      .8723476    1.247096
-------------+----------------------------------------------------------------
         p11 |   .8421047   .1980012                      .2236245    .9899751
-------------+----------------------------------------------------------------
         p21 |   .0940632   .0674356                      .0215408     .328721
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    5.54
         Prob > chi2 =    0.0186

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .0092763

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 84          
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .8421047   .1980012      .2236245    .9899751
-----------------------------+------------------------------------------------
                         p12 |   .1578953   .1980012      .0100249    .7763755
-----------------------------+------------------------------------------------
                         p21 |   .0940632   .0674356      .0215408     .328721
-----------------------------+------------------------------------------------
                         p22 |   .9059368   .0674356       .671279    .9784592
------------------------------------------------------------------------------

. estat duration

Number of obs = 84          
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |   6.333311    7.94199      1.288037    99.75207
-----------------------------+------------------------------------------------
                      State2 |   10.63115   7.621659      3.042093    46.42352
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. 
. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace                                 
file probas\ms_68.png saved as PNG format

.                                         
. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_URY.dta saved

. 
. **# MS AR for the current account - Venezuela
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==69
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -238.99409  
Iteration 1:  Log pseudolikelihood = -238.87035  (not concave)
Iteration 2:  Log pseudolikelihood =  -233.8247  (not concave)
Iteration 3:  Log pseudolikelihood = -231.33476  
Iteration 4:  Log pseudolikelihood = -230.59027  
Iteration 5:  Log pseudolikelihood = -230.47791  
Iteration 6:  Log pseudolikelihood = -230.47679  
Iteration 7:  Log pseudolikelihood = -230.47679  

Markov-switching autoregression

Sample: 1994q2 thru 2014q4                              Number of obs =     83
Number of states = 2                                    AIC           = 5.7464
Unconditional probabilities: transition                 HQIC          = 5.8401
                                                        SBIC          = 5.9796
Log likelihood = -230.47679

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .6117263   .1257312     4.87   0.000     .3652976    .8581549
             |
       _cons |   1.839383   1.092351     1.68   0.092    -.3015861    3.980352
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |    .970986   .0242179    40.09   0.000     .9235198    1.018452
             |
       _cons |   32.57518    3.78134     8.61   0.000     25.16389    39.98647
-------------+----------------------------------------------------------------
      sigma1 |   2.032799   .2833172                      1.546892    2.671339
-------------+----------------------------------------------------------------
      sigma2 |   4.631683   .4293324                       3.86222    5.554445
-------------+----------------------------------------------------------------
         p11 |   .9839234   .0118527                      .9337373    .9962521
-------------+----------------------------------------------------------------
         p21 |   .0103715   .0141982                       .000696    .1362209
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1) varswitch

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood =   -242.419  (not concave)
Iteration 1:  Log pseudolikelihood = -235.05882  
Iteration 2:  Log pseudolikelihood = -231.31301  
Iteration 3:  Log pseudolikelihood = -231.20862  
Iteration 4:  Log pseudolikelihood = -231.20833  
Iteration 5:  Log pseudolikelihood = -231.20833  

Markov-switching autoregression

Sample: 1994q2 thru 2014q4                              Number of obs =     83
Number of states = 2                                    AIC           = 5.7400
Unconditional probabilities: transition                 HQIC          = 5.8219
                                                        SBIC          = 5.9440
Log likelihood = -231.20833

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |    .601399   .1279574     4.70   0.000      .350607    .8521909
             |
       _cons |   1.882369   1.061776     1.77   0.076    -.1986751    3.963412
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |   33.21162   3.828239     8.68   0.000     25.70841    40.71483
-------------+----------------------------------------------------------------
      sigma1 |   2.032051   .2851058                      1.543502    2.675235
-------------+----------------------------------------------------------------
      sigma2 |   4.691216   .4377732                      3.907089    5.632712
-------------+----------------------------------------------------------------
         p11 |   .9839233   .0126955                      .9269757    .9966224
-------------+----------------------------------------------------------------
         p21 |   .0103715    .014319                      .0006801    .1389583
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =    9.70
         Prob > chi2 =    0.0018

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = .00091939

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 83          
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .9839233   .0126955      .9269757    .9966224
-----------------------------+------------------------------------------------
                         p12 |   .0160767   .0126955      .0033776    .0730243
-----------------------------+------------------------------------------------
                         p21 |   .0103715    .014319      .0006801    .1389583
-----------------------------+------------------------------------------------
                         p22 |   .9896285    .014319      .8610417    .9993199
------------------------------------------------------------------------------

. estat duration

Number of obs = 83          
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |    62.2019   49.11989      13.69408    296.0725
-----------------------------+------------------------------------------------
                      State2 |   96.41762   133.1146      7.196401    1470.324
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

. 
. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace                                 
file probas\ms_69.png saved as PNG format

.                                         
. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_VEN.dta saved

. 
. **# MS AR for the current account - Vietnam
. 
. use cis_quarterly_data_04_04_2023.dta, clear

. label list cn_2
cn_2:
           1 Argentina
           2 Armenia
           3 Australia
           4 Austria
           5 Belarus
           6 Belgium
           7 Bolivia
           8 Brazil
           9 Bulgaria
          10 Cambodia
          11 Canada
          12 Chile
          13 China
          14 Colombia
          15 Costa Rica
          16 Croatia
          17 Czech Republic
          18 Denmark
          19 El Salvador
          20 Estonia
          21 Finland
          22 France
          23 Georgia
          24 Germany
          25 Greece
          26 Guatemala
          27 Hong Kong
          28 Hungary
          29 Iceland
          30 India
          31 Indonesia
          32 Ireland
          33 Israel
          34 Italy
          35 Japan
          36 Kazakhstan
          37 Kyrgyz Republic
          38 Latvia
          39 Lithuania
          40 Luxembourg
          41 Malaysia
          42 Mauritius
          43 Mexico
          44 Moldova
          45 Netherlands
          46 New Zealand
          47 Norway
          48 Paraguay
          49 Peru
          50 Philippines
          51 Poland
          52 Portugal
          53 Romania
          54 Russia
          55 Slovak Republic
          56 Slovenia
          57 South Africa
          58 South Korea
          59 Spain
          60 Sri Lanka
          61 Sweden
          62 Switzerland
          63 Taiwan
          64 Thailand
          65 Turkey
          66 United Kingdom
          67 United States
          68 Uruguay
          69 Venezuela
          70 Vietnam

. 
. keep if cn_2==70
(18,699 observations deleted)

. *keep if date3<=tq(2019q4)
. 
. tsset date3

Time variable: date3, 1955q1 to 2022q3
        Delta: 1 quarter

. /*
> replace cab = l.cab in 91
> replace cab = l.cab in 93 
> replace cab = l.cab in 95
> replace cab = l.cab in 97
> replace cab = l.cab in 99
> replace cab = l.cab in 101
> replace cab = l.cab in 103
> */
. mswitch ar cab, arswitch ar(1) vce(robust)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -284.69759  (not concave)
Iteration 1:  Log pseudolikelihood =  -282.7468  (not concave)
Iteration 2:  Log pseudolikelihood = -281.74433  
Iteration 3:  Log pseudolikelihood = -281.11595  
Iteration 4:  Log pseudolikelihood = -280.98856  
Iteration 5:  Log pseudolikelihood = -280.98124  
Iteration 6:  Log pseudolikelihood = -280.97979  
Iteration 7:  Log pseudolikelihood = -280.97955  
Iteration 8:  Log pseudolikelihood = -280.97949  
Iteration 9:  Log pseudolikelihood = -280.97948  

Markov-switching autoregression

Sample: 1996q2 thru 2021q4                              Number of obs =    103
Number of states = 2                                    AIC           = 5.5918
Unconditional probabilities: transition                 HQIC          = 5.6644
                                                        SBIC          = 5.7709
Log likelihood = -280.97948

------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .5488602   .0902235     6.08   0.000     .3720255     .725695
             |
       _cons |  -.0047383   .9832183    -0.00   0.996    -1.931811    1.922334
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |   1.963146    .242777     8.09   0.000     1.487312     2.43898
             |
       _cons |  -.5671014   3.249305    -0.17   0.861    -6.935622     5.80142
-------------+----------------------------------------------------------------
       sigma |   3.434446   .3409684                      2.827159    4.172181
-------------+----------------------------------------------------------------
         p11 |    .919101    .066937                      .6605508    .9851477
-------------+----------------------------------------------------------------
         p21 |    .999999   9.92e-07                      .9999932    .9999998
------------------------------------------------------------------------------

. constraint 1 [State2]L1.ar=1

. *constraint 2 [State2]L1.ar=0.5
. 
. mswitch ar cab, arswitch ar(1) vce(robust) constraint(1)

Performing EM optimization:

Performing gradient-based optimization:

Iteration 0:  Log pseudolikelihood = -285.70624  
Iteration 1:  Log pseudolikelihood = -285.54678  
Iteration 2:  Log pseudolikelihood = -285.54521  
Iteration 3:  Log pseudolikelihood = -285.54521  

Markov-switching autoregression

Sample: 1996q2 thru 2021q4                              Number of obs =    103
Number of states = 2                                    AIC           = 5.6611
Unconditional probabilities: transition                 HQIC          = 5.7232
                                                        SBIC          = 5.8146
Log likelihood = -285.54521

 ( 1)  [State2]L.ar = 1
------------------------------------------------------------------------------
             |               Robust
         cab | Coefficient  std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
State1       |
          ar |
         L1. |   .3747219   .0845169     4.43   0.000     .2090718    .5403721
             |
       _cons |   .3669335   1.042631     0.35   0.725    -1.676586    2.410453
-------------+----------------------------------------------------------------
State2       |
          ar |
         L1. |          1  (constrained)
             |
       _cons |  -.5955004   1.294662    -0.46   0.646    -3.132992    1.941991
-------------+----------------------------------------------------------------
       sigma |   3.570564   .4721496                      2.755365    4.626947
-------------+----------------------------------------------------------------
         p11 |   .6085401    .211406                      .2144717    .8984881
-------------+----------------------------------------------------------------
         p21 |   .3893198   .2442993                      .0784115    .8268956
------------------------------------------------------------------------------

. *mswitch ar cab, arswitch ar(1) vce(robust)
. *mswitch ar cab, arswitch ar(1) varswitch vce(robust) constraint(1)
. 
. *ereturn list
. 
. test (_b[State1:L.ar] -1 = 0)

 ( 1)  [State1]L.ar = 1

           chi2(  1) =   54.73
         Prob > chi2 =    0.0000

. local sign_ag = sign(_b[State1:L.ar] -1)

. display "H_0: _b[State1:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State1:L.ar] -1  coef. p-value = 6.899e-14

. 
. test (_b[State2:L.ar] -1 = 0)

 ( 1)  [State2]L.ar = 1
       Constraint 1 dropped

           chi2(  0) =       .
         Prob > chi2 =         .

. local sign_ag = sign(_b[State2:L.ar] -1)

. display "H_0: _b[State2:L.ar] -1  coef. p-value = "          ///
> normal(`sign_ag'*sqrt(r(chi2)))
H_0: _b[State2:L.ar] -1  coef. p-value = .

. 
. *ereturn list
. 
. estat transition

Number of obs = 103         
------------------------------------------------------------------------------
    Transition probabilities |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                         p11 |   .6085401    .211406      .2144717    .8984881
-----------------------------+------------------------------------------------
                         p12 |   .3914599    .211406      .1015119    .7855283
-----------------------------+------------------------------------------------
                         p21 |   .3893198   .2442993      .0784115    .8268956
-----------------------------+------------------------------------------------
                         p22 |   .6106802   .2442993      .1731044    .9215885
------------------------------------------------------------------------------

. estat duration

Number of obs = 103         
------------------------------------------------------------------------------
           Expected duration |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                      State1 |    2.55454   1.379567      1.273029    9.851065
-----------------------------+------------------------------------------------
                      State2 |   2.568583   1.611793      1.209342    12.75324
------------------------------------------------------------------------------

. 
. capture drop pr

. local t = ccode[1]

. predict pr, pr smethod(smooth)

. 
. capture drop cap

. predict cap, yhat smethod(smooth)

. 
. capture graph drop predict

. capture graph drop states_`t'

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'"))                  ///
>  (tsline cap if cab!=.,legend(pos(6))), name(predict)

. 
. local t = ccode[1]

. twoway (tsline cab if cab!=., title("`t'") yline(0))         ///
>                    (tsline pr if cab!=., yaxis(2)            ///
>                     yscale(range(-5 5) axis(1))              ///
>                     yscale(range(0 1) axis(2))               ///
>                     yline(0.5, axis(2)) legend(off)),        ///
>                                         name(states_`t')

.                                         
. local v = cn_2[1]                                       

. graph export probas\ms_`v'.png, replace
file probas\ms_70.png saved as PNG format

. 
. local t = ccode[1]

. keep date3 cn cn_2 ccode cab pr

. 
. local t = ccode[1]                              

. save "probas\prob_`t'.dta", replace
file probas\prob_VNM.dta saved

. 
. **# Creating Word document
. 
. putdocx clear

. 
. putdocx begin

. 
. // Create a paragraph
. putdocx paragraph

. putdocx text (" CAB and MS AR "), bold

. *putdocx text ("can add formatted text to a paragraph.  You can ")
. *putdocx text ("italicize, "), italic
. *putdocx text ("strikeout, "), strikeout
. *putdocx text ("underline"), underline
. *putdocx text (", sub/super script")
. *putdocx text ("2 "), script(sub)
. *putdocx text (", and ")
. *putdocx text ("shade"), shading("blue")
. 
. 
. /*
> forvalues v=1(1)70 {
>         xtline pct_ca pct_ca_sa_2 if cn_2 == `v' ///
>                           , ylabel(, angle(horizontal)) tlabel(, grid) ///
>                           xsize(10) yline(0)
>               capture graph rename ca_`v', replace
>                           capture graph export figures\ca_`v'.png, replace
>               *capture graph export cap_check_`cn'.pdf, replace
>                           *graph close cap_check_`cn'
> }
> */
. 
. /*
> // Embed a graph
> forvalues v=1(1)70 {
>         *graph export ca_`v'.png
>     putdocx paragraph, halign(center)
>     putdocx image figures\ca_`v'.png
> }
> */
. 
. *putdocx text (" New data and seasonally adjusted old data "), bold
. 
. /*
> forvalues v=1(1)70 {
>         xtline ca pct_ca_sa_2 if cn_2 == `v' ///
>                           , ylabel(, angle(horizontal)) tlabel(, grid) ///
>                           xsize(10) yline(0)
>               graph rename cab_`v', replace
>                           capture graph export figures\cab_`v'.png, replace
>               *capture graph export cap_check_`cn'.pdf, replace
>                           *graph close cap_check_`cn'
> }
> */
. 
. // Embed a graph
. forvalues v=1(1)70 {
  2.         *graph export ca_`v'.png
.     putdocx paragraph, halign(center)
  3.     putdocx image probas\ms_`v'.png
  4. }

. 
. /*
> No seasonal adjustment
> Bolivia Brazil China Iceland Indonesia Ireland 
> Norway Switzerland Venezuela
> 
> encode CN, generate(CN2)
> 
> label list CN2
> 
> foreach v in 7 8 13 29 31 32 48 62 69 {
>         xtline ca pct_ca if CN2 == `v' ///
>                           , ylabel(, angle(horizontal)) tlabel(, grid) ///
>                           xsize(10) yline(0)
>               graph rename cac_`v', replace
>                           capture graph export figures\cac_`v'.png, replace
>               *capture graph export cap_check_`cn'.pdf, replace
>                           *graph close cap_check_`cn'
> }
> 
> // Embed a graph
> foreach v in 7 8 13 29 31 32 48 62 69 {
>         *graph export ca_`v'.png
>     putdocx paragraph, halign(center)
>     putdocx image figures\cac_`v'.png
> }
> 
> */
. 
. putdocx save cab-msar.docx, replace
successfully replaced "C:/Users/jamel/Dropbox/Latex/PROJECTS/22-11-cur-persistence/data/season
> al_adjustment/comparison/cab-msar.docx"

. 
. log close
      name:  <unnamed>
       log:  C:\Users\jamel\Dropbox\Latex\PROJECTS\22-11-cur-persistence\data\seasonal_adjustm
> ent\comparison\ms-ar-july-2023.log
  log type:  text
 closed on:  28 Jul 2023, 09:05:05
----------------------------------------------------------------------------------------------
